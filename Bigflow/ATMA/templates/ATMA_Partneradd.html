{% extends 'Shared/mainLayout.html' %}
{% load static from staticfiles %}
{% block title %}Profile Details{% endblock %}
{% block content %}
{% verbatim %}

<div class="maincontent">
    <div class="container container1" ng-app="Appreview" ng-controller="Ctrlreview" ng-cloak>
        <div class="row">
            <div>
                <md-content>
                    <md-tabs md-dynamic-height md-stretch-tabs>
                        <md-tab ng-class="{ active: isSet(1) }"
                                ng-click="setTab(1)" label="Create Supplier">
                        </md-tab>
                        <md-tab label="Profile" ng-disabled="hidetabs" ng-click="setTab(12)"
                                ng-class="{ active: isSet(12) }">
                            <md-tabs md-dynamic-height md-stretch-tabs style="padding-left: 5em;">
                                <md-tab ng-class="{ active: isSet(12) }"
                                        ng-click="setTab(12)" label="Profile Basic">
                                </md-tab>
                                <md-tab ng-class="{ active: isSet(8) }"
                                        ng-click="setTab(8)" label="Profile Product">
                                </md-tab>
                                <md-tab ng-class="{ active: isSet(9) }"
                                        ng-click="setTab(9)" label="Profile Branch">
                                </md-tab>
                                <md-tab ng-class="{ active: isSet(10) }"
                                        ng-click="setTab(10)" label="Profile Client">
                                </md-tab>
                                <md-tab ng-class="{ active: isSet(11) }"
                                        ng-click="setTab(11)" label="Profile Contract">
                                </md-tab>
                            </md-tabs>
                        </md-tab>
                        <md-tab ng-class="{ active: isSet(2) }"
                                ng-click="setTab(2)" label="Tax Details" ng-disabled="hidetabs">
                        </md-tab>
                        <md-tab ng-class="{ active: isSet(6) }"
                                ng-click="setTab(6)" label="Payment Details" ng-disabled="hidetabs">
                        </md-tab>
                        <md-tab ng-class="{ active: isSet(3) }"
                                ng-click="setTab(3)" label="Document Group" ng-disabled="hidetabs">
                        </md-tab>
                        <md-tab ng-class="{ active: isSet(5) }"
                                ng-click="setTab(5)" label="Activity" ng-disabled="hidetabs">
                        </md-tab>

                    </md-tabs>
                </md-content>
            </div>
        </div>

        <div ng-show="isSet(1)">
            <div class="row">
                <div class="row-header col-lg-12 col-sm-12">
                    <h4><strong>Supplier Details <label ng-show="pacode">({{Partner.partnercode}}-{{Partner.partnername}})</label></strong>
                    </h4>
                </div>
            </div>
            <div name="formfill" role="form" class="row">
                <div class="col-md-12">
                    <div class="row">

                        <div class="col-md-4">
                            <md-input-container class="md-block inputcontainer">
                                <label>Supplier Name </label>
                                <input type="text" maxlength="128" ng-disabled="disablesuppl"
                                       ng-model="Partner.partnername"
                                       autocomplete="off"
                                       required>
                            </md-input-container>
                        </div>
                        <div class="col-md-4">
                            <form name="myFor">
                                <md-input-container class="md-block inputcontainer">
                                    <label>Supplier Pan No. </label>
                                    <input type="text" name="pan" ng-model="Partner.partnerpan" ng-pattern="pan1"
                                           autocomplete="off"
                                           maxlength="10" ng-blur="panblur(Partner.partnerpan)" ng-focus="panfocus()"
                                           onkeyup="this.value = this.value.toUpperCase();">
                                    <span class="error" ng-show="myFor.pan.$error.pattern">{{msg}} </span>
                                </md-input-container>
                            </form>
                        </div>
                        <div class="col-md-4">
                            <form name="comreg_form">
                                <md-input-container class="md-block inputcontainer">
                                    <label> Company Reg. No </label>
                                    <input type="text" name="Comreg_name" maxlength="21" ng-model="Partner.companyregno"
                                           autocomplete="off"
                                    >
                                    <span class="error"
                                          ng-show="comreg_form.Comreg_name.$error.pattern">{{msg_reg}}</span>
                                </md-input-container>
                            </form>
                        </div>

                    </div>
                    <div class="row">
                        <div class="col-md-3">
                            <md-autocomplete
                                    md-clear-button="true"
                                    md-floating-label="Composite Vendor"
                                    md-item-text="item.metadata_value"
                                    md-items="item in getemployee_srch(searchcomposite)"
                                    md-menu-class="md-virtual-repeat-container"
                                    md-min-length=0
                                    md-no-cache="true"
                                    md-search-text="searchcomposite"
                                    md-selected-item="Partner.selectecomposite"
                                    md-selected-item-change="onchangecompositevendor(item)"
                                    ng-disabled="Customer_disab"
                                    ng-init="count=0">
                                <md-item-template>
                                    <span md-highlight-text="searchcomposite"> {{item.metadata_value}} </span>
                                </md-item-template>
                                <md-not-found>
                                    No Composite Vendor matching "{{searchcomposite}}" were found.
                                </md-not-found>
                            </md-autocomplete>


                        </div>

                        <div class="col-md-3">
                            <md-autocomplete
                                    md-clear-button="true"
                                    md-floating-label="Customer Category"
                                    md-item-text="item.custcategory_name"
                                    md-items="item in getcustomercategory_srch(searchcustomercat)"
                                    md-menu-class="md-virtual-repeat-container"
                                    md-min-length=0
                                    md-no-cache="true"
                                    md-search-text="searchcustomercat"
                                    md-selected-item="selectedcustomercategory"
                                    md-selected-item-change="onchangecustcategory(item)"
                                    ng-disabled="Customer_disab"
                                    ng-init="count=0">
                                <md-item-template>
                                    <span md-highlight-text="searchcustomercat"> {{item.custcategory_name}} </span>
                                </md-item-template>
                                <md-not-found>
                                    No Customer Category matching "{{searchcustomercat}}" were found.
                                </md-not-found>
                            </md-autocomplete>

                        </div>
                        <div class="col-md-3">
                            <md-autocomplete
                                    md-clear-button="true"
                                    md-floating-label="Supplier Group"
                                    md-item-text="item.metadata_value"
                                    md-items="item in getsuppliergroup_srch(searchsuppliergroup)"
                                    md-menu-class="md-virtual-repeat-container"
                                    md-min-length=0
                                    md-no-cache="true"
                                    md-search-text="searchsuppliergroup"
                                    md-selected-item="selectedsuppliergroup"
                                    md-selected-item-change="onchangesuppliergroup(item)"
                                    ng-disabled="Customer_disab"
                                    ng-init="count=0">
                                <md-item-template>
                                    <span md-highlight-text="searchsuppliergroup"> {{item.metadata_value}} </span>
                                </md-item-template>
                                <md-not-found>
                                    No Supplier Group matching "{{searchsuppliergroup}}" were found.
                                </md-not-found>
                            </md-autocomplete>

                        </div>
                        <div class="col-md-3">
                            <md-autocomplete
                                    md-clear-button="true"
                                    md-floating-label="Supplier Classification"
                                    md-item-text="item.metadata_value"
                                    md-items="item in getsupplierclasification_srch(searchsupplierclasification)"
                                    md-menu-class="md-virtual-repeat-container"
                                    md-min-length=0
                                    md-no-cache="true"
                                    md-search-text="searchsupplierclasification"
                                    md-selected-item="selectedsupplierclasification"
                                    md-selected-item-change="onchangesupplierclassification(item)"
                                    ng-disabled="Customer_disab"
                                    ng-init="count=0">
                                <md-item-template>
                                    <span md-highlight-text="searchsupplierclasification"> {{item.metadata_value}} </span>
                                </md-item-template>
                                <md-not-found>
                                    No Supplier Classification matching "{{searchsupplierclasification}}" were found.
                                </md-not-found>
                            </md-autocomplete>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-3">
                            <md-autocomplete
                                    md-clear-button="true"
                                    md-floating-label="Supplier Type"
                                    md-item-text="item.metadata_value"
                                    md-items="item in getsuppliertype_srch(searchsuppliertype)"
                                    md-menu-class="md-virtual-repeat-container"
                                    md-min-length=0
                                    md-no-cache="true"
                                    md-search-text="searchsuppliertype"
                                    md-selected-item="selectedsuppliertype"
                                    md-selected-item-change="onchangesuppliertype(item)"
                                    ng-disabled="Customer_disab"
                                    ng-init="count=0">
                                <md-item-template>
                                    <span md-highlight-text="searchsuppliertype"> {{item.metadata_value}} </span>
                                </md-item-template>
                                <md-not-found>
                                    No Supplier matching "{{searchsuppliertype}}" were found.
                                </md-not-found>
                            </md-autocomplete>

                        </div>
                        <div class="col-md-3">
                            <md-input-container class="md-block inputcontainer">
                                <label>Website</label>
                                <input type="text" maxlength="128" ng-model="Partner.website" autocomplete="off"
                                >
                            </md-input-container>
                        </div>
                        <div class="col-md-3" layout="row" style="margin-top:30px">
                            Contract
                            <md-radio-group layout="row" ng-model="Partner.activecontractype"
                                            ng-change="radioChanged(Partner.activecontractype)">
                                <md-radio-button value="Yes" class="md-primary">Yes</md-radio-button>
                                <md-radio-button value="No">No</md-radio-button>
                            </md-radio-group>
                        </div>
                        <div class="col-md-3">
                            <md-input-container class="md-block inputcontainer">
                                <label>Reason for no contract </label>
                                <input type="text" maxlength="128" ng-model="Partner.reasonfornocontract"
                                       no-special-char autocomplete="off"
                                       ng-disabled="editreason">
                            </md-input-container>
                        </div>

                    </div>
                    <div class="row">

                        <div class="col-md-3">
                            <md-autocomplete
                                    md-clear-button="true"
                                    md-floating-label="Organization Type"
                                    md-item-text="item.metadata_value"
                                    md-items="item in getorganizationtype_srch(searchorganizationtype)"
                                    md-menu-class="md-virtual-repeat-container"
                                    md-min-length=0
                                    md-no-cache="true"
                                    md-search-text="searchorganizationtype"
                                    md-selected-item="selectedorganizationtype"
                                    md-selected-item-change="onchangeorgtype(item)"
                                    ng-disabled="Customer_disab"
                                    ng-init="count=0">
                                <md-item-template>
                                    <span md-highlight-text="searchTex"> {{item.metadata_value}} </span>
                                </md-item-template>
                                <md-not-found>
                                    No Employee matching "{{searchTex}}" were found.
                                </md-not-found>
                            </md-autocomplete>

                        </div>
                        <div class="col-md-3">
                            <md-input-container class="md-block inputcontainer">
                                <label>Contract From</label>
                                <md-datepicker md-hide-icons="calendar" md-max-date="maxDatee" ng-disabled="contract_no"
                                               md-min-date="from_date"
                                               md-open-on-focus ng-model="Partner.contractfrom"
                                               ng-change="fromdatechange(Partner.contractfrom)"></md-datepicker>
                            </md-input-container>
                        </div>
                        <div class="col-md-3">
                            <md-input-container class="md-block inputcontainer">
                                <label>Contract To</label>
                                <md-datepicker md-hide-icons="calendar" md-max-date="maxDatee" ng-disabled="contract_no"
                                               md-min-date="from_date"
                                               md-open-on-focus ng-model="Partner.contractto"
                                               ng-change="todatechange(Partner.contractto)"></md-datepicker>
                            </md-input-container>
                        </div>

                        <div class="col-md-3">
                            <md-autocomplete
                                    md-clear-button="true"
                                    md-floating-label="RM Name"
                                    md-item-text="item.employee_name"
                                    md-items="item in getpartnerrm_srch(searchrmname)"
                                    md-menu-class="md-virtual-repeat-container"
                                    md-min-length=0
                                    md-no-cache="true"
                                    md-search-text="searchrmname"
                                    md-selected-item="selectedrmname"
                                    md-selected-item-change="onchangermname(item)"
                                    ng-disabled="Customer_disab"
                                    ng-init="count=0">
                                <md-item-template>
                                    <span md-highlight-text="searchTex"> {{item.employee_name}} </span>
                                </md-item-template>
                                <md-not-found>
                                    No Employee matching "{{searchTex}}" were found.
                                </md-not-found>
                            </md-autocomplete>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-3">
                            <md-input-container class="md-block inputcontainer">
                                <label>Renewal Date</label>
                                <md-datepicker md-hide-icons="calendar" md-max-date="ren_maxdate"
                                               md-min-date="ren_mindate"
                                               md-open-on-focus ng-model="Partner.partner_renewaldate" required>
                                </md-datepicker>
                            </md-input-container>
                        </div>
                        <div class="col-md-3">
                            <md-input-container class="md-block inputcontainer">
                                <label>Aprox Spend(Rs)</label>
                                <input numbers-only ng-model="Partner.approxspend" required valid-number
                                       autocomplete="off">
                            </md-input-container>
                        </div>
                        <div class="col-md-3">
                            <md-input-container class="md-block inputcontainer">
                                <label>Actual Spend(Rs)</label>
                                <input numbers-only ng-model="Partner.actualspend" required valid-number
                                       autocomplete="off">
                            </md-input-container>
                        </div>
                        <div class="col-md-3">
                            <md-input-container class="md-block inputcontainer">
                                <label>Remarks</label>
                                <input type="text" maxlength="128" no-special-char ng-model="Partner.remarks"
                                       autocomplete="off"
                                >
                            </md-input-container>
                        </div>
                    </div>
                    <div class="row">

                        <div class="col-md-3">
                            <md-input-container class="md-block inputcontainer">
                                <laberl>Director/Supplier Count</laberl>
                                <input type="text" ng-model="Partner.nodirector"
                                       autocomplete="off"
                                       required numbers-only>
                            </md-input-container>
                        </div>
                        <div class="col-md-3">
                            <md-input-container class="md-block inputcontainer">
                                <laberl>Name of Director</laberl>
                                <input type="text" maxlength="128" ng-model="directorName"
                                       aria-label='Enter Director name' autocomplete="off"
                                       required/>
                            </md-input-container>
                        </div>
                        <div class="col-md-3" ng-show="createpartner">
                            <br>
                            <md-button class="md-raised" ng-click="DirectoraddRow(Partner.nodirector)">
                                Add
                            </md-button>
                        </div>


                    </div>
                    <div class="row">
                        <div class="col-md-12">
                            <!--CREATE A TABLE-->
                            <table class="table table-striped table-bordered table-condensed table-hover md-primary">
                                <thead class="header">
                                <tr>
                                    <th colspan="2">Director</th>
                                </tr>
                                </thead>
                                <tr ng-repeat="directorName1 in directorarray">

                                    <td><label>{{directorName1}}</label></td>
                                    <td align="center"><a href="" ng-click="Director_delete($index)"
                                    ><i
                                            class="material-icons"
                                            style="material-icons.line-height:3px" ng-show="delete_show">delete</i></a>
                                    </td>
                                </tr>
                            </table>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-12">
                            <div class="row">
                                <div ng-include="'Partner_Address'"></div>
                            </div>
                            <div class="row">
                                <div ng-include="'Partner_Contact'"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div ng-show="isSet(2)">
            <div ng-include="'atma_tax_details'">Tax</div>
        </div>

        <div ng-show="isSet(3)">
            <div ng-include="'atma_attachmentdetails'">Add Attachment</div>
        </div>

        <div ng-show="isSet(5)">
            <div ng-include="'atma_activityadd'">Add Activity</div>
        </div>

        <!-- ENDOF <div class="row" ng-show="isSet3)"> -->
        <div ng-show="isSet(6)">
            <div ng-include="'atma_paymentdetails'">Payment Details</div>
        </div>  <!-- ENDOF <div class="row" ng-show="isSet(6)"> -->

        <div ng-show="isSet(7)">
            <div ng-include="'atma_profilepage'">Profile</div>
        </div>

        <!--        Start Profile Details Page-->
        <div ng-show="isSet(8)">
            <div ng-include="'atma_Productdetails'">Profile Product</div>
        </div>
        <div ng-show="isSet(9)">
            <div ng-include="'atma_Branchdetails'">Profile Branch</div>
        </div>
        <div ng-show="isSet(10)">
            <div ng-include="'atma_Clientdetails'">Profile Client</div>
        </div>
        <div ng-show="isSet(11)">
            <div ng-include="'atma_Contractdetails'">Profile Contract</div>
        </div>
        <div ng-show="isSet(12)">
            <div ng-include="'atma_BasicProfilDetails'">Profile Basic</div>
        </div>
        <div ng-show="isSet(13)">
            <div ng-include="'create_activity_details'">Create Activity Details</div>
        </div>
        <div ng-show="isSets(14)">
            <div ng-include="'create_catalog_details'" ng-show="qwe">Create Activity Details</div>
        </div>
        <!--End Profile Details Page-->

        <div class="row">
            <div class="col-md-4">
                <md-input-container class="md-block inputcontainer">
                    <label>Remarks</label>
                    <input type="text" no-special-char ng-model="rmremarks" maxlength="256" ng-change="rmremarks()">
                </md-input-container>
            </div>
            <div class="col-md-4 col-md-offset-4">
                <br>

                <md-button class="md-raised md-warn" value="Close" ng-click="movetoRM(Partner);"
                           ng-show="createpartner">
                    Move To RM
                </md-button>

                <md-button class="btn btn-info custbutton" value="close" ng-href="ATMA_PartnerSummary"
                           ng-show="view_cancel">Cancel
                </md-button>
                <md-button class="btn btn-info custbutton" value="close" ng-href="Query_Page"
                           ng-show="view_querycancel">Close
                </md-button>
            </div>

        </div>
        <div ng-include="'atma_addpayment'">Payment View</div>
    </div> <!-- endof <div class="container container1" ng-app="Appreview" ng-controller="Ctrlreview"> -->
</div> <!--endof <div class="maincontent"> -->
{% endverbatim %}
<script>
    var app_review = angular.module('Appreview', ['ngMaterial', 'ui.bootstrap', 'AppCommon', 'ngMessages'])
        .config(function($httpProvider) {
            $httpProvider.defaults.xsrfCookieName = 'csrftoken';
            $httpProvider.defaults.xsrfHeaderName = 'X-CSRFToken';
        });

app_review.run(function($mdDateLocale, $filter) {
    $mdDateLocale.formatDate = function(date) {
        return $filter('date')(date, "dd-MMM-yyyy");
    };
})

app_review.directive('fileModel', ['$parse', function($parse) {
    return {
        restrict: 'A',
        link: function(scope, element, attrs) {
            element.bind('change', function() {
                $parse(attrs.fileModel).assign(scope, element[0].files)
                scope.$apply();
            });
        }
    };
}]);

app_review.directive("fileinput", [function() {
    return {
        scope: {
            fileinput: "=",
            filepreview: "="
        },
        link: function(scope, element, attributes) {
            element.bind("change", function(changeEvent) {
                scope.fileinput = changeEvent.target.files[0];
                var reader = new FileReader();
                reader.onload = function(loadEvent) {
                    scope.$apply(function() {
                        scope.filepreview = loadEvent.target.result;
                    });
                }
                reader.readAsDataURL(scope.fileinput);
            });
        }
    }
}]);

app_review.controller('Ctrlreview', function($scope, $rootScope, $filter, $mdDialog, Servicedrctsale,$http,
    SerCommon, $element, $window, $location) {
<!--    $element.find('input').on('keydown', function(ev) {-->
<!--        ev.stopPropagation();-->
<!--    });-->
window.mdSelectOnKeyDownOverride = function(event) {
        event.stopPropagation();
    };

    var detail = JSON.parse(sessionStorage.getItem('today'));
    $scope.employgid = detail.employee_gid1;

    $scope.entity_gid = detail.entity_gid;
    $scope.create_by = detail.employee_gid;
    //alert(JSON.stringify($scope.create_by));
    $scope.updtdis = true;

    $scope.currentPage = 1;
    $scope.cate_currentPage = 1;
    cate_itemsPerPage=5;
    $scope.currentPages = 1;
    $scope.currentPages1 = 1;
    $scope.currentPage_payment = 1;
    $scope.maxSize_payment = 3;
    $scope.itemsPerPage_payment = 10;
    $scope.maxSize = 3;
    $scope.cata_maxSize = 3;
    $scope.add = [];
    $scope.Partner = [];
    $scope.Activityadd=[];
    $scope.Attachment=[];
    $scope.itemsPerPage = 10;

    $scope.maxDate = new Date();
    $scope.gotcatagory =gotcatagory;

    $scope.ActivitycurrentPage = 1;
    $scope.ActivitymaxSize = 3;
    $scope.ActivityitemsPerPage = 10;
    $scope.itemsPerPage1 = 5;
    $scope.itemsPerPages = 5;
    $scope.itemsPerPages1 = 5;
    $scope.cata_maxSize = 3;

    $scope.activitytypes = [{
        id: 'P',
        data: 'Product'
    }, {
        id: 'S',
        data: 'Service'
    }];
    $scope.fidelityinsurance = [{
        id: 'Y',
        data: 'YES'
    }, {
        id: 'N',
        data: 'NO'
    }];
    $scope.bidding = [{
        key: 'Y',
        value: 'YES'
    }, {
        key: 'N',
        value: 'NO'
    }];

    $scope.header = [];

    $scope.act_branchdetails=fn_activitybranchdetails;
    $scope.payment_partnerbranchdetails=fn_paymentpartnerbranchdetails;
    $scope.tax_partnerbranchdetails=fn_taxpartnerbranchdetails;
    $scope.gotodocname = gotodocname1;
     $scope.searchpartnerproduct = searchpartnerproduct;

    $scope.showadd = false;

    $scope.paymodename = paymodename;
    $scope.bank_name = bankgid;
    $scope.branch_name = bankbranchnames;
    $scope.paymodebankacctype = gotopartneracctype;

    $scope.one="gg";
    $scope.gottaxdetails=gottaxdetails;
    $scope.gottaxrate=gottaxratedetails;
    $scope.gotisexcempted=gotisexcempted;
    $scope.gottaxmsmedetails=gottaxmsmedetails;
    $scope.getproduct_gid = getproduct_gid;
    $scope.renewal_setdate=new Date($scope.Partner.contractto);
    $scope.gotoraiser = gotoraiser;

    $scope.ert=gotoapprover;
    //alert($scope.renewal_setdate);
    //$scope.gotopartne_activity=gotopartne_activity;
    $scope.showpopup = function() {

        modalshow('mdl_present11');
    }

$scope.panCardRegex = '/[A-Z]{5}\d{4}[A-Z]{1}/i';
$scope.todatechange = function(e) {

    $scope.re_date=new Date(e)

       load_Data(e);
            $scope.Partner.partner_renewaldate=load_Data();

            function load_Data(){
             return new Date(
               $scope.re_date.getFullYear(),
               $scope.re_date.getMonth() - 1,
               $scope.re_date.getDate());
                }
                //alert($scope.re_date)
       }

       $scope.fromdatechange = function(e) {

    $scope.contarct_to_date=new Date(e)

       load_FromData(e);
            $scope.Partner.contractto=load_FromData();

            function load_FromData(){
             return new Date(
               $scope.contarct_to_date.getFullYear() +1,
               $scope.contarct_to_date.getMonth() ,
               $scope.contarct_to_date.getDate());
                }
                 $scope.re_date= $scope.Partner.contractto
                load_Data(e);

            $scope.Partner.partner_renewaldate=load_Data();

            function load_Data(){
             return new Date(
               $scope.re_date.getFullYear(),
               $scope.re_date.getMonth() - 1,
               $scope.re_date.getDate());
                }
                //alert($scope.contarct_to_date)
                ren_mindate_test();
        ren_maxdate_test();
       }
    $scope.loading = function() {
        $mdDialog.show({
            templateUrl: 'loaderSpinner',
            parent: angular.element(document.body),
            clickOutsideToClose: false
        });
    };
    $scope.endloading = function() {
        $mdDialog.hide();
    };

    $scope.Director_delete = function(index){
         //alert(index);
         $scope.directorarray.splice(index, 1);
         $scope.Partner.nodirector=$scope.directorarray.length;
    }
    $scope.hidetabs=true;
$scope.disablesuppl = false;
    $scope.state_clk1 = function(state_gid, type) {

            $scope.client_stategid=state_gid;
            var distddl = Servicedrctsale.getdistddl(state_gid)
            distddl.then(function(result) {
                        $scope.adistrictddl = JSON.parse(result.data);

                }),
                function() {
                    alert('No data!.');
                };
        };

    $scope.district_clk1 = function(district_gid, type) {

        if(type == "address"){
        $scope.client_districtgid=district_gid;
        }else{
         $scope.client_districtgid="";
        }
            var ctyddl = Servicedrctsale.getcityddl(district_gid)
            ctyddl.then(function(result) {
                    if (type == 'address') {
                        $scope.acity1 = [];
                        $scope.acity1 = JSON.parse(result.data);
                    } else {
                        $scope.city1 = [];
                        $scope.city1 = JSON.parse(result.data);
                    }
                }),
                function() {
                    alert('No data!.');
                };
        };

    $scope.pan1=/[a-zA-Z]{5}[0-9]{4}[a-zA-Z]{1}/;
    $scope.gst1=/[0-9]{2}[a-zA-Z]{5}[0-9]{4}[a-zA-Z]{1}[1-9A-Za-z]{1}[Z]{1}[0-9a-zA-Z]{1}/;
    $scope.comreg=/[a-zA-Z]{1}[0-9]{5}[a-zA-Z]{2}[0-9]{4}[a-zA-Z]{3}[0-9]{6}/;

    if (sessionStorage.getItem('partner_summary_session') != null)
     {
        //alert(JSON.parse(sessionStorage.getItem('partner_summary_session')));
        var partner_detail = JSON.parse(sessionStorage.getItem('partner_summary_session'));
        $scope.a=[partner_detail];
        //alert(JSON.stringify($scope.a));
        $scope.partner_gid = partner_detail.partnerdata.partner_gid;
        $scope.partner_rmgids = partner_detail.partnerdata.partner_rmname;
        //$scope.partnercode =  partner_detail.partnerdata.partner_code;
        //alert($scope.Partner.partner_gid);
        $scope.update = partner_detail.view;
        $scope.createpartner=true;
        $scope.delete_show=true;
        if($scope.update=="Query_page"){
        $scope.view_querycancel=true;
        $scope.view_cancel=false;
        }else{
        $scope.view_querycancel=false;
        $scope.view_cancel=true;
        }
<!-- $scope.gstandpanrequired = 'true'-->
        if($scope.partner_gid > 0)
        {
<!--N-->

<!--            $scope.loading();-->
            $scope.hidetabs=false;
            $scope.Partner = [];
            $scope.editdisabled = true;
            $scope.pacode=true;

            if(partner_detail.partnerdata.partner_activecontract=="Yes"){
                 $scope.Partner.reasonfornocontract="";
            }else{
               $scope.Partner.reasonfornocontract=partner_detail.partnerdata.partner_reason_no_contract;
            }

            $scope.Partner.partnercode =  partner_detail.partnerdata.partner_code;
            $scope.disablesuppl = true;
            $scope.partner_rm_gid = partner_detail.partnerdata.partner_rmname;
            $scope.Partner.partnername =  partner_detail.partnerdata.partner_name;
            $scope.tax_partnername=partner_detail.partnerdata.partner_name;
            $scope.Partner.partnerpan= partner_detail.partnerdata.partner_panno;
            $scope.Partner.companyregno= partner_detail.partnerdata.partner_compregno;
            $scope.Partner.custcategorygid= partner_detail.partnerdata.partner_custcategorygid;
            $scope.selectedcustomercategory= partner_detail.partnerdata.custcategory_name;
            $scope.Partner.partnertype=partner_detail.partnerdata.partner_type;
            $scope.selectedsuppliertype=partner_detail.partnerdata.partner_type;
            $scope.Partner.partnergroup=partner_detail.partnerdata.partner_group;
            $scope.selectedsuppliergroup=partner_detail.partnerdata.partner_group;
            $scope.Partner.classification=partner_detail.partnerdata.partner_Classification;
            $scope.selectedsupplierclasification=partner_detail.partnerdata.partner_Classification;
            $scope.Partner.website=partner_detail.partnerdata.partner_web;
            $scope.Partner.activecontractype=partner_detail.partnerdata.partner_activecontract;
            $scope.Partner.organizationtype=partner_detail.partnerdata.partner_orgtype;
            $scope.selectedorganizationtype=partner_detail.partnerdata.partner_orgtype;
            $scope.Partner.contractfrom=new Date(partner_detail.partnerdata.partner_contractdatefrom);
            $scope.Partner.contractto=new Date(partner_detail.partnerdata.partner_contractdateto);
            $scope.Partner.partner_renewaldate=new Date(partner_detail.partnerdata.partner_renewdate);
            $scope.Partner.approxspend=partner_detail.partnerdata.partner_aproxspend;
            $scope.Partner.actualspend=partner_detail.partnerdata.partner_actualspend;
            $scope.Partner.remarks=partner_detail.partnerdata.partner_remarks;
            $scope.Partner.nodirector=partner_detail.partnerdata.partner_noofdir;
            $scope.selectedemp=partner_detail.partnerdata.employee_name;
            $scope.Partnercreateby=partner_detail.partnerdata.create_by;
            $scope.Partnestus=partner_detail.partnerdata.partner_status;
            $scope.Part_request=partner_detail.partnerdata.partner_requestfor;
            $scope.Partner.compositevendor=partner_detail.partnerdata.partner_compositevendor;
            $scope.Partner.selectecomposite=partner_detail.partnerdata.partner_compositevendor;
            $scope.selectedrmname=partner_detail.partnerdata.employee_name;


            $scope.add.addline11=partner_detail.partnerdata.address_1;
            $scope.add.addline211=partner_detail.partnerdata.address_2;
            $scope.add.pincode111=partner_detail.partnerdata.address_pincode;
            $scope.add.addline311=partner_detail.partnerdata.address_3;
            $scope.add.addselectedstate11=partner_detail.partnerdata.address_state_gid;


            $scope.state_clk1($scope.add.addselectedstate11,'address');
            $scope.add.addselecteddistrict11 = partner_detail.partnerdata.address_district_gid;
            $scope.district_clk1(partner_detail.partnerdata.address_district_gid,'address');
            $scope.add.addselectedcity11=partner_detail.partnerdata.address_city_gid;
            $scope.add.cntcttype11=partner_detail.partnerdata.Contact_contacttype_gid;
            $scope.add.prsnname11=partner_detail.partnerdata.Contact_personname;
            $scope.add.dsgntn11=partner_detail.partnerdata.Contact_designation_gid;
            $scope.add.lndlne11=partner_detail.partnerdata.Contact_landline;
            $scope.add.lndlne211=partner_detail.partnerdata.Contact_landline2;
            $scope.add.mobno11=partner_detail.partnerdata.Contact_mobileno;
            $scope.add.mobno211=partner_detail.partnerdata.Contact_mobileno2;
            $scope.add.mailid11=partner_detail.partnerdata.Contact_email;
            if($scope.Partner.compositevendor =="UnRegistered"){
            $scope.gstandpanrequired = 'true';
            }

            if (partner_detail.partnerdata.Contact_DOB==null)  {
                $scope.add.dobb11=null;
            }else
            {
                $scope.add.dobb11=new Date(partner_detail.partnerdata.Contact_DOB);
            }
            if (partner_detail.partnerdata.Contact_WD==null)
            {
                $scope.add.weddy11=null;
            }
            else
            {
                $scope.add.weddy11=new Date(partner_detail.partnerdata.Contact_WD);
            }


            getdirector_data($scope.partner_gid);
            //alert($scope.Partner.activecontractype);
            if (partner_detail.partnerdata.partner_contractdatefrom){
                 $scope.Partner.contractfrom =  formatStringDate(new Date(partner_detail.partnerdata.partner_contractdatefrom), 'yyyy-mm-dd');
                 }
            else
                 {
                    $scope.Partner.contractfrom= null;
                 }
            if (partner_detail.partnerdata.partner_contractdateto){
                $scope.Partner.contractto =  formatStringDate(new Date(partner_detail.partnerdata.partner_contractdateto), 'yyyy-mm-dd');
                }
             else
                {
                $scope.Partner.contractto= null;
                }
            if($scope.Partner.activecontractype=='No'){
                $scope.contract_no=true;
                $scope.editreason=false;
            }else{
                $scope.contract_no=false;
                $scope.editreason=true;
            }
            if( $scope.Partnestus ==  "DRAFT" || $scope.Partnestus ==  "REJECTED"){
                $scope.createpartner=true;
                $scope.delete_show=true;
            }else{
                $scope.createpartner=false;
                $scope.delete_show=false;
            }
        }
    }
    ren_mindate_test();

function ren_mindate_test() {

var min_ren = new Date($scope.Partner.contractfrom);
if( $scope.Partner.contractfrom == min_ren ){
<!--          $scope.ren_mindate = $scope.Partner.contractfrom-->
              $scope.Partner.contractfrom = $scope.ren_mindate ;
}
else {
 $scope.ren_mindate = min_ren;
}
};
ren_maxdate_test();
function ren_maxdate_test() {

var max_ren = new Date($scope.Partner.contractto);
if( $scope.Partner.contractto == max_ren ){
<!--          $scope.ren_maxdate= $scope.Partner.contactto-->
          $scope.Partner.contractto = $scope.ren_maxdate ;
}
else {
   $scope.ren_maxdate = max_ren ;
}}
    if($scope.Partnestus == "APPROVED"){

        $scope.msttable="Mst";
        $scope.catalog_get="APPROVED";
     }else{
        $scope.msttable="";
        $scope.catalog_get="Draft";
     }

if( ($scope.Part_request == "MODIFICATION") || ($scope.Part_request == "RENEWAL PROCESS") ){
    if($scope.Partnestus=="APPROVED"){
        $scope.showcatalog=false;
        $scope.hideaddbutton=false;
        $scope.showsubmit=false;
    }else{
        $scope.showcatalog=true;
    $scope.hideaddbutton=true;
    $scope.showsubmit=true;
    }}

//$scope.editreason=true;
     $scope.radioChanged=function(x){
     if(x=="Yes"){
     $scope.editreason=true;
     $scope.Partner.reasonfornocontract="";
     $scope.contract_no=false;
     $scope.Partner.partner_renewaldate='';
     }else{
     $scope.editreason=false;
     $scope.contract_no=true;
    $scope.currentMinute = new Date();
    $scope.Partner.contractfrom='';
    $scope.Partner.contractto='';

    load_Datas();
    function load_Datas(){
             return new Date(
               $scope.currentMinute.getFullYear() +1,
               $scope.currentMinute.getMonth(),
               $scope.currentMinute.getDate());
                }
     }
    $scope.Partner.partner_renewaldate=load_Datas();

     }

    function getdirector_data(partnerGid){
    if($scope.Partnestus == "APPROVED"){

        $scope.msttable="Mst";
        $scope.catalog_get="APPROVED";
     }else{
        $scope.msttable="";
        $scope.catalog_get="Draft";
     }

        var data = {
            "Params": {
                "Filter":{
                    "Director_Partnergid":partnerGid,
                    "Mst_Table":$scope.msttable,
                },
                "Classification": {
                    "Entity_Gid": $scope.entity_gid
                },
                "Group": "ATMASUMMARY",
                "Action": "Directors_Get",
                "Type": "dirname",
            }
        }
        var get_dir_data = Servicedrctsale.get_director(data)
        get_dir_data.then(function(result) {

        $scope.directorarraynew = [];
        $scope.directorarray = [];

            $scope.directorarraynew=result.data.DATA;
            //alert($scope.directorarraynew);

            for (var i = 0; i < $scope.directorarraynew.length; i++)
            {
                $scope.directorarray.push($scope.directorarraynew[i].directorName1);
            }

        })
    }

    $scope.tab = 1
    $scope.setTab = function(newTab) {


        $scope.tab = newTab;
        $scope.qwe=false;

    };

    $scope.isSet = function(tabNum) {
        return $scope.tab === tabNum;
    };


    $scope.Previous_clk=function(e,btn_type){

    $scope.loading();
    $scope.qwe=false;
    $scope.qw1=e.activity_gid;
    $scope.a=$scope.getActivitySummary.length-1;
    $scope.ase=JSON.stringify($scope.getActivitySummary[$scope.a].activity_gid);
    //alert( $scope.ase);
    $scope.ase1=JSON.stringify($scope.getActivitySummary[0].activity_gid);
    if(btn_type=="Previous"){
    if(parseInt($scope.ase1) == $scope.qw1){
    alert("Reach The Minium Count");
    $scope.endloading();
    return false;

    }}
     if(btn_type=="next"){
    if($scope.ase == $scope.qw1){
    alert("Reach The Maximum Count");
     $scope.endloading();
    return false;
    }}
            for (var i = 0; i < $scope.getActivitySummary.length; i++) {
                if ($scope.getActivitySummary[i].activity_gid == $scope.qw1) {
                $scope.arrayindex=i;
                }
            }
    if(btn_type=="Previous"){
        $scope.bind_actdetdata=$scope.getActivitySummary[$scope.arrayindex - 1];
        $scope.act_details=$scope.getActivitySummary[$scope.arrayindex - 1].activity_gid;

    }
    if(btn_type=="next"){
        $scope.bind_actdetdata=$scope.getActivitySummary[$scope.arrayindex + 1];
        $scope.act_details=$scope.getActivitySummary[$scope.arrayindex + 1].activity_gid;
    }
    setTab_Changes();

    }


        $scope.tab = 1;

     $scope.act_details=0;

    $scope.setTab_Change = function(newTab,e) {

    $scope.bind_actdetdata=e;

    $scope.act_details=e.activity_gid;
    $scope.act_name_bind=e.activity_name;
    $scope.activity_partnerbranchgid_formap=e.partnerbranch_gid;
        $scope.tab = newTab;
<!--        activity_branchname();-->
        setTab_Changes();

    };
//start activity details


    $scope.panblur = function(e) {

$scope.msg = "Please Enter Valid pan number" ;
if(e==undefined){
return false;
}
var data={
    "Params":{
        "Pan_number":e,
        "Group":"Checkpan_details",
    }}
    var checkpan=Servicedrctsale.check_pandetails(data)
    checkpan.then(function(result){
    $scope.panvalidresult=result.data;
    //alert(JSON.stringify(result.data));
    })

}
$scope.panfocus = function(){
$scope.msg =""
}
$scope.regno_blur = function(){
$scope.msg_reg ="Please Enter Valid Company Reg. No"
}
$scope.regno_focus = function(){
$scope.msg_reg = ""}
 function setTab_Changes(){

     //alert($scope.act_det.act_details);
            var filter = {};
            if ($scope.add.activityname1) {
                filter['Activitydetails_Activitygid'] = $scope.add.activityname1
            } else {
                filter['Activitydetails_Activitygid'] = '';
            }
            if ($scope.add.activitydetailname1) {
                filter['Activitydetails_Name'] = $scope.add.activitydetailname1
            } else {
                filter['Activitydetails_Name'] = '';
            }
            var data = {
                "Params": {
                    "Filter": {
                    "Activitydetails_Activitygid":$scope.act_details,
                    "Mst_Table": $scope.msttable,
                    },
                    "Classification": {
                        "Entity_Gid": $scope.entity_gid
                    }
                }
            }
            var dtamactivity = {
                Group: 'Activity_Details',
                Type: 'Activitydetails_Get',
                data: data
            }
            $scope.getactivity = [];
            var getactivity = Servicedrctsale.getdattamactivity(dtamactivity)
            getactivity.then(function (result) {
                $scope.getactivity = result.data.DATA;
                //alert(JSON.stringify($scope.getactivity));
                $scope.searchactivity_details=$scope.getactivity;
                $scope.pageLength11 = $scope.getactivity.length;
            }, function (err) {
                alert('No data!.');
            }).finally();
        }

        $rootScope.showpopup_actdet = function () {
        $scope.activitydetails_disabled=false;
        $scope.addactivitydetails=true;
        $scope.updateactivitydetails=false;
            $scope.add.activityname= "";
            $scope.add.activitydetailcode= "";
            $scope.add.activitydetailname= "";
            $scope.add.activityremark= "";
            $scope.add.raiser="";
            $scope.add.approvername= "";
            modalshow('addactivitydetailspopup');
        }

        $scope.save_act_details = function (add) {
$scope.activitydetails_disabled=true;
 if($scope.raiser_employee_gid == $scope.aproval_employee_gid){
 alert("Please Select Raiser and Aproval are Different")
 $scope.activitydetails_disabled=false;
 }else{

            var data = {
                "Params": {
                    "Activitydetails_Activitygid": $scope.act_details,
                    "Activitydetails_Code": add.activitydetailcode,
                    "Activitydetails_Name": add.activitydetailname,
                    "Activitydetails_Remarks": add.activityremark,
                    "Activitydetails_Raisor":$scope.raiser_employee_gid,
                    "Activitydetails_Approver":$scope.aproval_employee_gid,
                },
                "Classification": {
                    "Entity_Gid": $scope.entity_gid,
                    "Create_By": $scope.create_by
                },
            }
            var details = {
                Group: 'Activity_Details',
                Action: 'Insert',
                Type: 'Activity_Details',
                data: data,
            }
            $scope.actdetails = [];
<!--            $scope.loading();-->

            var set_actdetails = Servicedrctsale.setactdetails(details)
            set_actdetails.then(function (result) {
                    //alert(JSON.stringify(result.data));
                    $scope.actdetails = result.data.MESSAGE;
                    if($scope.actdetails=="SUCCESSFULLY INSERTED"){
                    alert("SUCCESSFULLY INSERTED");
                    $scope.activitydetails_disabled=false;
                    modalhide('addactivitydetailspopup');
                    setTab_Changes();
                    }else{
                    alert(JSON.stringify($scope.actdetails));
                    $scope.activitydetails_disabled=false;
                     modalshow('addactivitydetailspopup');
                    }
                }),
                function (err) {
                    alert('no data');
                }.finally($scope.endloading());
        }
        }


        function gotoraiser(query){
        debugger;
         var dat = {
             "Table_name": "gal_mst_temployee",
             "Column_1": "employee_gid,employee_name,employee_code",
             "Column_2": "",
             "Where_Common": "employee",
             "Where_Primary": "employee_gid",
             "Primary_Value": "",
             "Order_by": "name",
              "Limits": "0,30",
             "Search_Column": query,
         }
          var trans = {Action: "",Entity_Gid: $scope.entity,data: dat}
             return $http.post(Appname + '/prodget/' , trans).then(function(result) {
             console.log(result.data.DATA);
                 return result.data.DATA;
               });
     }

    function gotoapprover(query){
    var dat = {
         "Table_name": "gal_mst_temployee",
         "Column_1": "employee_gid,employee_name,employee_code",
         "Column_2": "",
         "Where_Common": "employee",
         "Where_Primary": "employee_gid",
         "Primary_Value": "",
         "Order_by": "name",
          "Limits": "0,30",
         "Search_Column": query,
     }
      var trans = {Action: "",Entity_Gid: $scope.entity,data: dat}
         return $http.post(Appname + '/prodget/' , trans).then(function(result) {
         console.log(result.data.DATA);
             return result.data.DATA;
           });
 }



   $scope.raiser_empname=function(e){

$scope.raiser_employee_gid=e.employee_gid;
    }
$scope.Approver_empname=function(e){
$scope.aproval_employee_gid=e.employee_gid;
}

$scope.edit_data = function (prod) {

<!--            fn_raiserload();-->
            $scope.activitydetailsgid=prod.activitydetails_gid;
            $scope.addactivitydetails=false;
            $scope.updateactivitydetails=true;
            $scope.add.activityname= prod.activity_name;
            $scope.add.activitydetailcode= prod.activitydetails_code;
            $scope.add.activitydetailname= prod.activitydetails_name;
            $scope.add.activityremark= prod.activitydetails_remarks;
            $scope.add.raiser=prod.Raisor;
            $scope.add.approvername= prod.Approver;
            modalshow('addactivitydetailspopup');
             }
$scope.update_activitydetails=function(add){

 var data = {
                "Params": {
                    "Activitydetails_Gid":$scope.activitydetailsgid,
                    "Activitydetails_Activitygid": $scope.act_details,
                    "Activitydetails_Code": (add.activitydetailcode).toString(),
                    "Activitydetails_Name": add.activitydetailname,
                    "Activitydetails_Remarks": add.activityremark,
                    "Activitydetails_Raisor":$scope.raiser_employee_gid,
                    "Activitydetails_Approver":$scope.aproval_employee_gid,
                },
                "Classification": {

                    "Update_By": $scope.create_by
                },
            }
            var details = {
                Group: 'Activity_Details_Update',
                Action: 'UPDATE',
                Type: '',
                data: data,
            }
            $scope.actdetails = [];
<!--            $scope.loading();-->
            var update_actdetails = Servicedrctsale.updateactdetails(details)
            update_actdetails.then(function (result) {
                    //alert(JSON.stringify(result.data));
                    $scope.actdetails = result.data;
                    if($scope.actdetails=="SUCCESS"){
                    alert("SUCCESSFULLY UPDATED");
                    modalhide('addactivitydetailspopup');
                    setTab_Changes();
                    }else{
                    alert(JSON.stringify($scope.actdetails));
                     modalshow('addactivitydetailspopup');
                    }
                }),
                function (err) {
                    alert('no data');
                }.finally($scope.endloading());
        }
 $scope.show_activitydetails = function (prod) {

<!--            fn_raiserload();-->
            $scope.activitydetailsgid=prod.activitydetails_gid;
            $scope.addactivitydetails=false;
            $scope.updateactivitydetails=false;
            $scope.add.activityname= prod.activity_name;
            $scope.add.activitydetailcode= prod.activitydetails_code;
            $scope.add.activitydetailname= prod.activitydetails_name;
            $scope.add.activityremark= prod.activitydetails_remarks;
            $scope.add.raiser=prod.Raisor;
            $scope.add.approvername= prod.Approver;
            modalshow('addactivitydetailspopup');
             }
             $scope.search_activity_details=function(e){

            $scope.getactivity = $filter('filter')($scope.searchactivity_details , {

               "activitydetails_name": e.activitydetailname1,
               "activitydetails_code": e.activitydetailcode1,
               "activitydetails_remarks":e.activityremark1

        });
}


//end activity details

//start Catalog


    $scope.setTab_ChangeCatalog = function(newTab,e) {

        $scope.tabs = newTab;
        $scope.qwe=true;
        $scope.activity_detgid=e.activitydetails_gid;
        $scope.activity_detname=e.activitydetails_name;
        //alert($scope.activity_detgid);
        getcatalogdetails();

    };

    $scope.isSets = function(tabNum) {
        $scope.tabNums=tabNum;
         if ($scope.tabs === $scope.tabNums){
         return true;
         }
         else{
         return false;
         }
    };


        function getcatalogdetails(){
        var data = {
            "Params": {
                "Filter": {
                "activitydtlpproduct_activitydetailsgid":  $scope.activity_detgid,
                "mpartnerproduct_partner_gid":  $scope.partner_gid,
                "mPartnerProduct_Status":$scope.catalog_get,
                 "Mst_Table":$scope.msttable,
                },
                "Classification": {
                    "Entity_Gid": $scope.entity_gid
                }
            }
        }
        var dtam = {
            Group: 'Catalog_Details',
            Type: 'activitydtlpp_GET',
            data: data
        }
        $scope.getcompaignm = [];
        var getcompaignm = Servicedrctsale.getdattams(dtam)
        getcompaignm.then(function (result) {
            $scope.getcompaignm = result.data.DATA;
            $scope.getcompaignms = result.data.DATA.partner_requestfor;
           //alert(JSON.stringify($scope.getcompaignm));
            //alert(JSON.stringify($scope.getcompaignms));
            $scope.searchcatalog=$scope.getcompaignm;
            $scope.load = $scope.getcompaignm
            $scope.pageLength = $scope.getcompaignm.length;
            $scope.pageLengths = $scope.checkerdetails.length;
        }, function (err) {
            alert('No data!.');
        }).finally();

        }

        $rootScope.showpopup_actdetails = function () {
        $scope.catalog_disabled=false;
            $scope.CallingProductChange=true;
            $scope.updatecatalog=false;
            $scope.addcatalog=true;
            $scope.add.catalogactivitydetail=$scope.activity_details_name,
            $scope.add.catalogcategory="",
            $scope.add.subcategory="",
            $scope.add.catalogname="",
            $scope.add.catalogspec="",
            $scope.add.catalogsize="",
            $scope.add.catalogremarks="",
            $scope.add.uomgid="",
            $scope.add.catalograte="",
            $scope.add.contractfrom="",
            $scope.add.contractto="",
            $scope.add.unitprice="",
            $scope.add.packingprice="",
            $scope.add.deliverydays="",
            $scope.add.capacitypw="",
            $scope.add.dts="",
            $scope.add.catalog_partner_product_gid="",
            modalshow('addcatalogdetailspopup');
        }

$scope.catalog_save = function (add) {
$scope.catalog_disabled=true;
            //alert(JSON.stringify(add))
            var data = {
                "Params": {
                    "activitydtlpproduct_ActivityDetailsGid":$scope.activity_detgid,
                    "activitydtlpproduct_partnerbranchgid":$scope.activity_partnerbranchgid_formap,
                    "activitydtlpproduct_Category":  $scope.add.catalogcategorygid,
                    "activitydtlpproduct_SubCategory": $scope.add.subcategorygid,
                    "activitydtlpproduct_Name": add.catalogname,
                    "activitydtlpproduct_Spec": add.catalogspec,
                    "activitydtlpproduct_Size": add.catalogsize,
                    "activitydtlpproduct_Remarks": add.catalogremarks,
                    "activitydtlpproduct_UomGid": $scope.uom_gid,
                    "activitydtlpproduct_Rate": add.catalograte,
                    "activitydtlpproduct_ValidFrom": add.contractfrom,
                    "activitydtlpproduct_ValidTo": add.contractto,
                    "mPartnerProduct_UnitPrice": add.catalograte,
                    "mPartnerProduct_PackingPrice": add.packingprice,
                    "mPartnerProduct_DeliveryDays": add.deliverydays,
                    "mPartnerProduct_CapacityPW": add.capacitypw,
                    "mPartnerProduct_DTS": add.dts,
                    "mPartnerProduct_Status":"Draft",
                    "mPartnerProduct_Partner_Gid": $scope.partner_gid,
                    "mPartnerProduct_Product_Gid": $scope.mpartnerproduct_gid
                },
                "Classification": {
                    "Create_By": $scope.create_by,
                    "Entity_Gid": $scope.entity_gid,
                },
            }
            var total = {
                Group: 'Catalog Details',
                Action: 'activitydtlpp_INSERT',
                Type: 'Catalog Details',
                data: data
            }
            var set_catalog = Servicedrctsale.pcatalog(total)
            set_catalog.then(function (result) {
                    $scope.catalog = [];
                    $scope.catalog = result.data.MESSAGE;
                    if($scope.catalog=="SUCCESSFULLY INSERTED"){
                    alert("SUCCESSFULLY ADDED");
                     $scope.catalog_disabled=false;
                    modalhide('addcatalogdetailspopup');
                    getcatalogdetails();
                    }else{
                    alert(JSON.stringify($scope.catalog));
                     $scope.catalog_disabled=false;
                    //$window.location.href = 'ATMA_PartnerSummary';
                    }
                }),
                function (err) {
                    alert('no data');
                };
        }

    $scope.getuom = get_uom;
        function get_uom(query) {
            var
                datan = {
                    "Table_name": "gal_mst_tuom",
                    "Column_1": "uom_gid,uom_name,uom_code",
                    "Column_2": "",
                    "Where_Common": "uom",
                    "Where_Primary": "",
                    "Primary_Value": "",
                    "Order_by": "name",
                    "Limits": "0,30",
                    "Search_Column": query
                }
            var
                transuom = {
                    Action: "",
                    Entity_Gid: $scope.entity,
                    data: datan
                }
            return $http.post(Appname + '/prodget/' , transuom).then(function(result) {
                    console.log(result.data.DATA);
                    return result.data.DATA;
                });

     }
     $scope.change_uom_gid=function(uom){
        debugger;
        if(uom!=undefined){
            $scope.uom_gid=uom.uom_gid;
        }
     }



        //product

        function getproduct_gid(query) {
         var datan ={
                "Table_name": "gal_mst_tproduct",
                "Column_1": "product_gid,product_name",
                "Column_2": "",
                "Where_Common": "product",
                "Where_Primary": "",
                "Primary_Value": "",
                "Order_by": "name",
                "Limits": "0,30",
                "Search_Column": query
         }
        var total ={
                Action: "Productname",
                Entity_Gid: $scope.entity,
                data: datan
        }
        return $http.post(Appname + '/prodget/' , total).then(function(result) {
                console.log(result.data.DATA);
                return result.data.DATA;
            });

     }


    function gotcatagory(query) {
            var datan = {
                "Table_name": "ap_mst_tcategory",
                "Column_1": "category_gid,category_name",
                "Column_2": "",
                "Where_Common": "category",
                "Where_Primary": "",
                "Primary_Value": "",
                "Order_by": "name",
                "Limits": "0,30",
                "Search_Column": query
            }
            var trans = {
                Action: "",
                Entity_Gid: $scope.entity,
                data: datan
            }

            return $http.post(Appname + '/prodget/' , trans).then(function(result) {
                console.log(result.data.DATA);
                return result.data.DATA;
            });

        }




    $scope.partnerprod_gid=function(e){
        if ($scope.CallingProductChange==false)
        {
            //alert($scope.CallingProductChange + ' if $scope.CallingProductChange) =false');
            $scope.CallingProductChange=true;
            return;
        }
        $scope.mpartnerproduct_gid=e.product_gid;

        //alert('Calling partnerprod_gid fn');
        //alert($scope.CallingProductChange);
         var data = {
            "Params": {
                "Filter":{
                    "Product_Gid":$scope.mpartnerproduct_gid

                },
                "Classification": {
                    "Entity_Gid": $scope.entity_gid
                }
                }
                }
         var dtam = {
                "Group": "Activity_Group",
                "Type": "APCatSubCat_Get",
                data: data
                }

        var get_ProductCatSubCat_data = Servicedrctsale.get_ProductCatSubCat_service(dtam)
        get_ProductCatSubCat_data.then(function(result) {
        //alert(JSON.stringify(result.data.DATA));
        $scope.productcatsubcatname=[];
        $scope.productcatsubcatname=result.data.DATA;
        $scope.add.catalogcategory=$scope.productcatsubcatname[0].category_name;
        $scope.add.subcategory=$scope.productcatsubcatname[0].subcategory_name;
        $scope.add.catalogcategorygid=$scope.productcatsubcatname[0].category_gid;
        $scope.add.subcategorygid=$scope.productcatsubcatname[0].subcategory_gid;
        //alert('$scope.add.catalogcategorygid'+$scope.add.catalogcategorygid);
        //alert('$scope.add.subcategorygid'+$scope.add.subcategorygid);

        }),
                function (err) {
                    alert('no data');
                };
        }

        $scope.catalog_update=function(add){

        var data = {
                "Params": {
                    "activitydtlpproduct_Gid":$scope.catalogdetails_gid,
                    "activitydtlpproduct_partnerbranchgid":$scope.activity_partnerbranchgid_formap,
                    "activitydtlpproduct_Category": $scope.add.catalogcategorygid,
                    "activitydtlpproduct_SubCategory": $scope.add.subcategorygid,
                    "activitydtlpproduct_Name": add.catalogname,
                    "activitydtlpproduct_Spec": add.catalogspec,
                    "activitydtlpproduct_Size": add.catalogsize,
                    "activitydtlpproduct_Remarks": add.catalogremarks,
                    "activitydtlpproduct_UomGid": (add.uomgid).toString(),
                    "activitydtlpproduct_Rate": add.catalograte,
                    "activitydtlpproduct_ValidFrom": add.contractfrom,
                    "activitydtlpproduct_ValidTo": add.contractto,
                    "mPartnerProduct_Product_Gid":$scope.mpartnerproduct_gid,
                    "mPartnerProduct_UnitPrice":add.catalograte,
                    "mPartnerProduct_PackingPrice":add.packingprice,
                    "mPartnerProduct_DeliveryDays":add.deliverydays,
                    "mPartnerProduct_CapacityPW":add.capacitypw,
                    "mPartnerProduct_DTS":add.dts
                },
                "Classification": {
                    "Update_By": $scope.create_by,
                    "Entity_Gid": $scope.entity_gid,
                },
            }
            var total = {
                Group: 'Catalog_Details_Update',
                Action: 'activitydtlpp_UPDATE',
                Type: 'Catalog Details',
                data: data
            }
            var update_catalog = Servicedrctsale.updatecatalogservice(total)
            update_catalog.then(function (result) {
                    $scope.update_catalog = [];
                    $scope.update_catalog = result.data;
                    if($scope.update_catalog=="SUCCESS"){
                    alert("SUCCESSFULLY UPDATED");
                    modalhide('addcatalogdetailspopup');
                    getcatalogdetails();
                    }else{
                    alert(JSON.stringify($scope.update_catalog));
                    modalshow('addcatalogdetailspopup');
                    //$window.location.href = 'ATMA_PartnerSummary';
                    }
                }),
                function (err) {
                    alert('no data');
                };

        }

         $scope.edit_data_actdet=function(e){

        $scope.updatecatalog=true;
        $scope.CallingProductChange=false;
        $scope.addcatalog=false;
                $scope.catalogdetails_gid=e.activitydtlpproduct_gid,
                $scope.add.catalog_partner_product_gid=e.product_name,
                //alert('e.product_gid '+ e.product_gid);

                $scope.add.catalogactivitydetail=$scope.activity_details_name,
                $scope.add.catalogcategory=e.category_name,
                $scope.add.subcategory=e.subcategory_name,
                $scope.add.catalogcategorygid=e.category_gid,
                $scope.add.subcategorygid=e.subcategory_gid,
                //alert('$scope.add.catalogcategorygid'+$scope.add.catalogcategorygid);
                //alert('$scope.add.subcategorygid'+$scope.add.subcategorygid);
                $scope.add.catalogname=e.activitydtlpproduct_name,
                $scope.add.catalogspec=e.activitydtlpproduct_spec,
                $scope.add.catalogsize=e.activitydtlpproduct_size,
                $scope.add.catalogremarks=e.activitydtlpproduct_remarks,
                $scope.add.uomgid=e.activitydtlpproduct_uomgid,
                $scope.add.catalograte=e.mpartnerproduct_unitprice,
                $scope.add.contractfrom=new Date(e.activitydtlpproduct_validfrom),
                $scope.add.contractto=new Date(e.activitydtlpproduct_validto),
                $scope.add.unitprice=e.mpartnerproduct_unitprice,
                $scope.add.packingprice=e.mpartnerproduct_packingprice,
                $scope.add.deliverydays=e.mpartnerproduct_deliverydays,
                $scope.add.capacitypw=e.mpartnerproduct_capacitypw,
                $scope.add.dts=e.mpartnerproduct_dts,
                $scope.add.mpartnerproduct_gid=e.activitydtlpproduct_gid,

                modalshow('addcatalogdetailspopup')
        }

         $scope.show_catalog=function(e){
        $scope.CallingProductChange=false;
        $scope.updatecatalog=false;
        $scope.addcatalog=false;
                $scope.catalogdetails_gid=e.activitydtlpproduct_gid,
                $scope.add.catalog_partner_product_gid=e.product_name,
                $scope.add.catalogactivitydetail=$scope.activity_details_name,
                $scope.add.catalogcategory=e.category_name,
                $scope.add.subcategory=e.subcategory_name,
                $scope.add.catalogname=e.activitydtlpproduct_name,
                $scope.add.catalogspec=e.activitydtlpproduct_spec,
                $scope.add.catalogsize=e.activitydtlpproduct_size,
                $scope.add.catalogremarks=e.activitydtlpproduct_remarks,
                $scope.add.uomgid=e.activitydtlpproduct_uomgid,
                $scope.add.catalograte=e.mpartnerproduct_unitprice,
                $scope.add.contractfrom=new Date(e.activitydtlpproduct_validfrom),
                $scope.add.contractto=new Date(e.activitydtlpproduct_validto),
                $scope.add.unitprice=e.mpartnerproduct_unitprice,
                $scope.add.packingprice=e.mpartnerproduct_packingprice,
                $scope.add.deliverydays=e.mpartnerproduct_deliverydays,
                $scope.add.capacitypw=e.mpartnerproduct_capacitypw,
                $scope.add.dts=e.mpartnerproduct_dts,
                $scope.add.mpartnerproduct_gid=e.activitydtlpproduct_gid,
                modalshow('addcatalogdetailspopup')
        }

        $scope.search_catalog=function(e){

            if(e.catalogcategory1 != undefined && e.catalogcategory1 != null && e.catalogcategory1 !='' )
        {
        var tempvar= e.catalogcategory1.category_name;
        }
        else
        {
        var tempvar='';
        }
            $scope.getcompaignm = $filter('filter')($scope.searchcatalog , {

               "activitydtlpproduct_name":e.catalogname1 == null ||  e.catalogname1 == undefined  || e.catalogname1 == '' ? '' : e.catalogname1,
               "activitydtlpproduct_spec":e.catalogspec1 == null ||  e.catalogspec1 == undefined  || e.catalogspec1 == '' ? '' : e.catalogspec1,
               "activitydtlpproduct_remarks":e.catalogremarks1 == null ||  e.catalogremarks1 == undefined  || e.catalogremarks1 == '' ? '' : e.catalogremarks1,
               "activitydtlpproduct_category":tempvar == null ||  tempvar == undefined  || tempvar == '' ? '' : tempvar


        });


}
//end Catalog
//start maping partner
getPartnerProductCheckerDetails();
function getPartnerProductCheckerDetails(){

    var data = {
        "Params": {
        "Partner_Gid":$scope.partner_gid,

         },
         "Classification": {
            "Entity_Gid":$scope.entity_gid,
         },
    }
    var details = {
        Group: 'Checker_Get',
        Action: 'Checker_Get',
        Type:"",
        data: data,
    }
    var get_checkerdetails = Servicedrctsale.checkergetService(details)
    get_checkerdetails.then(function(result) {

     $scope.checkerdetails =[];
        $scope.checkerdetails = result.data.DATA;
        $scope.searchcheckerdetails=$scope.checkerdetails;
        //alert(JSON.stringify($scope.checkerdetails))
    }),
    function(err) {
        alert('no data');
    };
}
$scope.assign_catalog=function(e){

var data = {
        "Params": {
        "mPartnerProduct_Gid":e.mpartnerproduct_gid,
        "ActivitydtlpProduct_ActivityDetailsGid":$scope.activity_detgid,
        "mPartnerProduct_Status":"Draft",
         },
         "Classification": {
            "Create_By": $scope.create_by,
            "Entity_Gid":$scope.entity_gid,
         },
    }
    var details = {
        Group: 'CATALOG_ASSIGN',
        Action: 'Assign_Catalog_Insert',
        Type:"",
        data: data,
    }
    var set_assingcatalogdetails = Servicedrctsale.assigncatalogService(details)
    set_assingcatalogdetails.then(function(result) {
        $scope.assign_catalogdetails = result.data.MESSAGE;
        if($scope.assign_catalogdetails == "SUCCESS"){
        alert("Catalog Assgin Successfully");
        getcatalogdetails();
        getPartnerProductCheckerDetails();
        }
        $scope.searchassigncatalog=$scope.assign_catalogdetails;
        //alert(JSON.stringify($scope.assign_catalogdetails))
    }),
    function(err) {
        alert('no data');
    };
}

//end maping partner

    $scope.directorarray = [];
    $scope.count = 0;


    $scope.DirectoraddRow = function(value) {

        //$scope.loading();

        if (($scope.directorName == "") || ($scope.directorName == undefined)) {
            alert( 'Director name can not be empty');
            return false;
        }

        if ($scope.directorarray.indexOf($scope.directorName) > -1) {
            alert($scope.directorName + ' already exists');
             $scope.directorName='';
            return true; //current string is in list

        }

        if ($scope.directorarray.length == $scope.Partner.nodirector) {
            alert( 'Director count reached the maximum value');
            $scope.directorName='';
            return true;
        }


        if ( $scope.Partner.nodirector < $scope.directorarray.length ) {
            alert( 'Invalid Director/Partner count');
            $scope.Partner.nodirector= $scope.directorarray.length;
            $scope.directorName='';
            return true;

        }

        $scope.directorarray.push($scope.directorName);
        //alert($scope.directorarray.length)

        $scope.directorName='';
        //$scope.endloading();


    };

     // datepart: 'y', 'm', 'w', 'd', 'h', 'n', 's'
    Date.dateDiff = function(datepart, fromdate, todate)
     {

            datepart = datepart.toLowerCase();
            var diff = todate - fromdate;
            var divideBy = { w:604800000,
                   d:86400000,
                   h:3600000,
                   n:60000,
                   s:1000
            };


        return Math.floor( diff/divideBy[datepart]);
    }
    Partner=[];
    $scope.onchangecompositevendor=function(item){
    $scope.Partner.compositevendor=item.metadata_value
    }
    $scope.onchangecustcategory=function(item){
    debugger;
    $scope.Partner.custcategorygid=item.custcategory_gid
    }
    $scope.onchangesuppliergroup=function(item){
    $scope.Partner.partnergroup=item.metadata_value
    }
    $scope.onchangesupplierclassification=function(item){
    $scope.Partner.classification=item.metadata_value
    }
    $scope.onchangesuppliertype=function(item){
    $scope.Partner.partnertype=item.metadata_value
    }
    $scope.onchangeorgtype=function(item){
    $scope.Partner.organizationtype=item.metadata_value
    }
    $scope.onchangermname=function(item){
    debugger;
    $scope.partner_rm_gid =item.employee_gid
    }


    $scope.save_Partner = function(Partner,add) {
$scope.disble_savebtn = true;
    debugger;
if(((Partner.partnerpan == "") && (Partner.compositevendor!='UnRegistered')) ||((Partner.partnerpan == undefined)&&(Partner.compositevendor!='UnRegistered'))){
var regularexp=/^[A-Z]{5}[0-9]{4}[A-Z]{1}$/;
if(regularexp.test(Partner.partnerpan)== true){
}else {
alert("Please Enter Valid Pan Number");
<!--$scope.disble_savebtn = false;-->
   return false;
}
}

if (Partner.compositevendor=='Registered-Regular')
{
$scope.composite_type='R';
if($scope.panvalidresult=="FAILD"){
alert("Please Enter Valid Pan Number");
$scope.disble_savebtn = false;
   return false;
}
}
if (Partner.compositevendor=='Registered-Composite')
{
$scope.composite_type='C';
if($scope.panvalidresult=="FAILD"){
alert("Please Enter Valid Pan Number");
$scope.disble_savebtn = false;
   return false;
}
}
if (Partner.compositevendor=='UnRegistered')
{
$scope.composite_type='U';
$scope.gstandpanrequired = 'true';
if((Partner.partnerpan != "") || (Partner.partnerpan != undefined))
{
var regularexp=/^[A-Z]{5}[0-9]{4}[A-Z]{1}$/;
if(regularexp.test(Partner.partnerpan)== true){
if($scope.panvalidresult=="FAILD"){
alert("Please Enter Valid Pan Number");
$scope.disble_savebtn = false;
   return false;
}
}
}
}
    if(Partner.activecontractype=="Yes"){
    $scope.Partner.reasonfornocontract="";
      if(Partner.contractfrom =="" || Partner.contractfrom ==undefined || Partner.contractto =="" || Partner.contractto ==undefined){
         alert("Please Enter Contractfrom  and Contractto Date")
         $scope.disble_savebtn = false;
         return false;
      }
    }else{
    $scope.Partner.reasonfornocontract=Partner.reasonfornocontract;
    }
        if ($scope.directorarray.length != $scope.Partner.nodirector) {
            alert( 'Check The Direct Count and Name ');
            $scope.disble_savebtn = false;
            return false;
        }
        if(Partner.activecontractype=="No"){
        $scope.contract_no=true;
        if(Partner.reasonfornocontract=="" || Partner.reasonfornocontract==undefined){
        alert("Please Enter No Contract Reason")
        $scope.disble_savebtn = false;
         return false;
        }
    }

        if (Partner.partnername == undefined) {
            alert('Plesae Enter Partner Name')
            $scope.disble_savebtn = false;
            return false;
        }
        if (Partner.partnergroup == undefined){
         alert('Please Select Partner Group')
         $scope.disble_savebtn = false;
            return false;
        }
        if (Partner.classification == undefined){
         alert('Please Select Partner Classification')
         $scope.disble_savebtn = false;
            return false;
        }
        if (Partner.partnertype == undefined){
         alert('Please Select Partner Type')
         $scope.disble_savebtn = false;
            return false;
        }
        if (Partner.activecontractype == undefined){
         alert('Please Select Partner Contract')
         $scope.disble_savebtn = false;
            return false;
        }
        if (Partner.organizationtype == undefined){
         alert('Please Select Organization Type')
         $scope.disble_savebtn = false;
            return false;
        }
        if (Partner.partner_renewaldate == undefined){
         alert('Please Select Renewal Date')
         $scope.disble_savebtn = false;
            return false;
        }
        if (Partner.approxspend == undefined){
         alert('Please Enter Approximate Spend')
         $scope.disble_savebtn = false;
            return false;
        }
        if (Partner.actualspend == undefined){
         alert('Please Enter Actual Spend')
         $scope.disble_savebtn = false;
            return false;
        }
        if (Partner.nodirector == undefined){
         alert('Please Enter Number Of Directer')
         $scope.disble_savebtn = false;
            return false;
        }

if (Partner.nodirector == 0 ){
         alert('Please Enter Number Of Directer')
         $scope.disble_savebtn = false;
            return false;
        }
        if(add.addselectedstate11==undefined){
alert("Please Select State");
$scope.disble_savebtn = false;
return false;
}if(add.addselecteddistrict11==undefined){
alert("Please Select District");
$scope.disble_savebtn = false;
return false;
}if(add.addselectedcity11==undefined){
alert("Please Select City");
$scope.disble_savebtn = false;
return false;
}if(add.pincode111==undefined){
alert("Please Enter Pincode");
$scope.disble_savebtn = false;
return false;
}


        var data = {
            "Params": {
                "Partner_Code": Partner.partnercode,
                "Partner_Name": Partner.partnername,
                "Partner_Compregno": Partner.companyregno,
                "Partner_Custcategorygid": Partner.custcategorygid,
                "Partner_Classification": Partner.classification,
                "Partner_Type": Partner.partnertype,
                "Partner_Group": Partner.partnergroup,
                "Partner_Web": Partner.website,
                "Partner_Reason_No_Contract":  $scope.Partner.reasonfornocontract,
                "Partner_Activecontract": Partner.activecontractype,
                "Partner_Contractdatefrom": Partner.contractfrom,
                "Partner_Contractdateto": Partner.contractto,
                "Partner_Aproxspend": Partner.approxspend,
                "Partner_Actualspend": Partner.actualspend,
                "Partner_Orgtype": Partner.organizationtype,
                "Partner_Remarks": Partner.remarks,
                "Partner_Panno": Partner.partnerpan,
                "Partner_Noofdir": Partner.nodirector,
                "Partner_Status": "DRAFT",
                "Partner_Renewdate": Partner.partner_renewaldate,
                "Partner_Rmname": $scope.partner_rm_gid,
                "Partner_Gid": $scope.partner_gid,
                "Create_By": $scope.create_by,
                "Address_1":$scope.add.addline11,
                "Address_2":$scope.add.addline211,
                "Address_Pincode":$scope.add.pincode111,
                "Address_3":$scope.add.addline311,
                "Address_State_Gid":add.addselectedstate11,
                "Address_District_Gid":add.addselecteddistrict11,
                "Address_City_Gid": add.addselectedcity11,
                "Contact_ContactType_Gid": $scope.add.cntcttype11,
                "Contact_PersonName":$scope.add.prsnname11,
                "Contact_Designation_Gid":$scope.add.dsgntn11,
                "Contact_LandLine": $scope.add.lndlne11,
                "Contact_LandLine2":$scope.add.lndlne211,
                "Contact_MobileNo": $scope.add.mobno11,
                "Contact_MobileNo2":$scope.add.mobno211,
                "Contact_Email": $scope.add.mailid11,
                "Contact_DOB":$scope.add.dobb11,
                "Contact_WD":$scope.add.weddy11,
                "Partner_Compositevendor":$scope.composite_type
            },
            "Classification": {
                "DirectorName": $scope.directorarray,
                "Entity_Gid": $scope.entity_gid,
                "Update_By":detail.employee_gid,
            },
        }
        var total = {
            Group: 'Header Details',
            Action:$scope.update ,
            Type: 'Header Details',
            data: data
        }
        $scope.loading();
        var set_header = Servicedrctsale.partnerheader_set(total)
        set_header.then(function(result) {
                $scope.header = [];
                $scope.header = result.data.MESSAGE;
                //alert(JSON.stringify($scope.header));
                if (result.data.MESSAGE == 'SUCCESS') {
                $scope.partner_gid =result.data.DATA;
                $scope.partner_rm_gid =result.data.RM_GID;
                $scope.Partner.partnercode =result.data.p_code;
                alert("Partner Code :" + $scope.Partner.partnercode);
                alert("SUCCESSFULLY INSERTED");
                $scope.disablesuppl = true;
                $scope.pacode=true;
                getpaymode();
                gettaxdetails();
                fn_getattachmentsummary();
                loadActivityData();
                $scope.hidetabs=false;
                //alert(JSON.stringify( $scope.hidetabs));
                //$window.location.href = 'ATMA_PartnerSummary';
                }else{
                alert($scope.header);
                }
            }),
            function(err) {
                alert('no data');
                $scope.disble_savebtn = false;
            }.finally($scope.endloading());
    }

    $scope.movetoRM=function(){


        var data={
            "Params":{
                "Filter":{
                    "Partner_Gid":$scope.partner_gid,
                    "Partner_Status":"PENDING-RM",
                    "Remarks":$scope.rmremarks,
                },
                "Classification":{
                    "Create_By": $scope.create_by,
                    "Entity_Gid": $scope.entity_gid,
                },
                "Group":"MoveToRM",
                "Action":"Draft_To_Pending_Insert",
            }
        }
        var moverm_approval=Servicedrctsale.partnerheader_set(data)
        moverm_approval.then(function(result){
            $scope.movermdata=result.data;
            $scope.movermdatas=result.data.MESSAGE;
            if($scope.movermdatas=="SUCCESS"){
            alert("Data Moved To RM");
            $window.location.href = 'ATMA_PartnerSummary'

            }else{
            alert(JSON.stringify($scope.movermdata))
            }


        })

    }




    function gotoorgpartner(query) {
        var result = $filter('filter')($scope.organizationtype, {
            'partner_gid': query
        });
        return result;
    }

    $scope.changepartnertype=function()
    {

         if ( $scope.Partner.classification=='One Time' )
         {

         $scope.Partner.partnertype='NA';
         $scope.editdisabledPartnertype=true;}
         else
         {
         $scope.editdisabledPartnertype=false;}
    }

    function fn_activitybranchdetails(query) {
            var datan = {
          "Table_name": "atma_tmp_mst_tpartnerbranch",
          "Column_1": "partnerbranch_gid,partnerbranch_name,partnerbranch_code",
          "Column_2": "",
          "Where_Common": "partnerbranch",
          "Where_Primary": "partnergid",
          "Primary_Value": $scope.partner_gid,
          "Order_by": "name",
          "Limits": "0,30",
          "Search_Column": query,
                 }
      var trans = {Action: "",Entity_Gid: $scope.entity,data: datan}
          return $http.post(Appname + '/prodget/' , trans).then(function(result) {
          console.log(result.data.DATA);
              return result.data.DATA;
            });
          }

<!--    function gotopartne_activity(query) {-->
<!--        var result = $filter('filter')($scope.executivename_activity, {-->
<!--            'metadata_gid': query-->
<!--        });-->
<!--        return result;-->
<!--    }-->




<!--    var datan = {-->
<!--        "Table_name": "gal_mst_temployee",-->
<!--        "Column_1": "employee_gid,employee_name,employee_code",-->
<!--        "Column_2": "",-->
<!--        "Where_Common": "employee",-->
<!--        "Where_Primary": "employee_gid",-->
<!--        "Primary_Value": "",-->
<!--        "Order_by": "name"-->
<!--    }-->

<!--    var trans = {-->
<!--        Action: "",-->
<!--        Entity_Gid: $scope.entity,-->
<!--        data: datan-->
<!--    }-->

<!--    $scope.executivename = [];-->
<!--    var getemployee = Servicedrctsale.getprodt(trans)-->
<!--    getemployee.then(function(result) {-->

<!--        $scope.executivename = result.data.DATA;-->
<!--        $scope.executivename.forEach(function(v)-->
<!--        {-->
<!--            v.employee_name=v.employee_name+"-"+v.employee_code;-->
<!--        });-->
<!--        //alert(JSON.stringify( $scope.executivename[0]))-->
<!--    }, function(err) {-->
<!--        alert('No data!.');-->
<!--    }).finally();-->




     //PAYMENTSTART

    $scope.partnerpaymode = [];
     function paymodename(query) {
        var paymode = {
            "Table_name": "gal_mst_tpaymode",
            "Column_1": "paymode_gid,Paymode_name,paymode_code",
            "Column_2": "",
            "Where_Common": "paymode",
            "Where_Primary": "paymode_gid",
            "Primary_Value": "",
            "Order_by": "gid",
            "Limits": "0,30",
            "Search_Column": query,
        }
        var paymodeval = {
            Action: "",
            Entity_Gid: $scope.entity_gid,
            data: paymode
        }

        return $http.post(Appname + '/prodget/' , paymodeval).then(function(result) {
        console.log(result.data.DATA);
            return result.data.DATA;
          });

    }




    function bankgid(query) {
         var bank = {
            "Table_name": "gal_mst_tbank",
            "Column_1": "bank_gid,bank_name,bank_code",
            "Column_2": "",
            "Where_Common": "bank",
            "Where_Primary": "bank_gid",
            "Primary_Value": "",
            "Order_by": "name",
            "Limits": "0,30",
            "Search_Column": query,
        }
        var bankval = {
            Action: "",
            Entity_Gid: $scope.entity_gid,
            data: bank
        }
        return $http.post(Appname + '/prodget/' , bankval).then(function(result) {
        console.log(result.data.DATA);
            return result.data.DATA;
          });
    }

<!--    payment_partnerbranchname();-->
<!--    function payment_partnerbranchname(){-->

<!--        var datan = {-->
<!--            "Table_name": "atma_tmp_mst_tpartnerbranch",-->
<!--            "Column_1": "partnerbranch_gid,partnerbranch_name,partnerbranch_code",-->
<!--            "Column_2": "",-->
<!--            "Where_Common": "partnerbranch",-->
<!--            "Where_Primary": "partnergid",-->
<!--            "Primary_Value": $scope.partner_gid,-->
<!--            "Order_by": "name"-->
<!--                   }-->

<!--        var trans = {-->
<!--            Action: "",-->
<!--            Entity_Gid: $scope.entity,-->
<!--            data: datan-->
<!--                    }-->

<!--        var getpaymentpartnerbranch = Servicedrctsale.getbranch_paymentpartner(trans)-->
<!--        getpaymentpartnerbranch.then(function(result) {-->
<!--        $scope.payment_partnerbranch_name = result.data.DATA;-->

<!--    }, function(err) {-->
<!--        alert('No data!.');-->
<!--    }).finally();-->

<!--    }-->

<!--    function fn_paymentpartnerbranchdetails(query) {-->
<!--        var result = $filter('filter')($scope.payment_partnerbranch_name, {-->
<!--            'partnerbranch_name': query-->
<!--        });-->
<!--        return result;-->
<!--    }-->

     function fn_paymentpartnerbranchdetails(query) {
        var datan = {
            "Table_name": "atma_tmp_mst_tpartnerbranch",
            "Column_1": "partnerbranch_gid,partnerbranch_name,partnerbranch_code",
            "Column_2": "",
            "Where_Common": "partnerbranch",
            "Where_Primary": "partnergid",
            "Primary_Value": $scope.partner_gid,
            "Order_by": "name",
            "Limits": "0,30",
            "Search_Column": query,
            }

            var trans = {
                Action: "",
                Entity_Gid: $scope.entity,
                data: datan
            }
             return $http.post(Appname + '/prodget/' , trans).then(function(result) {
        console.log(result.data.DATA);
            return result.data.DATA;
          });

    }

    $scope.partnerbank = [];
    $scope.searchDetails = function() {

     getpaymode();
<!--    $scope.search_accno=s.accno;-->
<!--    $scope.search_bname=s.beneficiaryname;-->
<!--    $scope.search_ifsc=s.ngmifsc;-->
<!--    $scope.search_acctype=s.payacctype.metadata_value;-->

    }
    $scope.addpaymentpagepopup = function() {
    $scope.payment_disabled=false;
        $scope.paymode_cheque=true;
        $scope.tpay_true=false;
        $scope.tpay_true1=false;
        $scope.tpay_true2=false;
        $scope.tpay_true3=false;
        $scope.hidebank=false;
		$scope.addpay = true;
		$scope.editpay = false;
		$scope.inactivepay = false;
		$scope.pay.paymode_paymodedata="";
		$scope.pay.bank_paymodedata="";
		$scope.pay.bankbranch_paymodedata="";
		$scope.pay.acctype_paymodedata="";
		$scope.pay.accnumber_paymodedata="";
		$scope.pay.bname_paymodedata="";
		$scope.pay.paymentremarks="";
		$scope.pay.branch="";

<!--		    payment_partnerbranchname();-->
			modalshow('mdl_present');
		}

		$scope.ngpamodetype=function(e){

		if(e==undefined){
            getpaymode();
		}
		$scope.payment_paymode=e.paymode_gid;
		$scope.payment_paymode_name=e.Paymode_name;
        $scope.alldetails = $filter('filter')($scope.payment_search , {
               "Paymode_name": $scope.payment_paymode_name

        });
		}
		$scope.searchngbank=function(e){

		 if(e.ngbankw != undefined && e.ngbankw != null && e.ngbankw !='' )
        {
        var paytemp2=e.ngbankw.bank_name;
       $scope.paytemp21=e.ngbankw.bank_name;
        }
    else
        {
        var paytemp2='';
        $scope.paytemp21='';
        }

 $scope.payment_alldetails = $filter('filter')($scope.payment_search , {
               "bank_name": paytemp2 == null || paytemp2 == undefined || paytemp2 == '' ? '' : paytemp2

        });
        $scope.paysearch.ngbranchw='';
        $scope.paybank = e.ngbankw.bank_gid;

       $scope.bid = e.bank_gid;
       var paymode = {
           "Table_name": "gal_mst_tbankbranch",
           "Column_1": "bankbranch_gid,bankbranch_name",
           "Column_2": "",
           "Where_Common": "bankbranch",
           "Where_Primary": "bank_gid",
           "Primary_Value": $scope.paybank,
           "Order_by": "name"
       }
       var paymodeval = {
           Action: "",
           Entity_Gid: $scope.entity_gid,
           data: paymode
       }
       $scope.partnerpaymodebranch = [];
       var getpymodebranchval = Servicedrctsale.getpaymodebranchdata(paymodeval)
       getpymodebranchval.then(function(result) {
           $scope.partnerpaymodebranch = result.data.DATA;
           //alert(JSON.stringify($scope.partnerpaymodebranch))
       }, function(err) {
           alert('No data!.');
       }).finally();
   }

$scope.paysearch = [];
		getpaymode();

    function getpaymode() {

        if ($scope.payment_paymode){
            $scope.payname = $scope.payment_paymode;
        } else {
            $scope.payname = '';
        }
        if ($scope.paybank) {
            $scope.paybank = $scope.paybank;
        } else {
            $scope.paybank = '';
        }
        if ($scope.paysearch.ngbranchw) {
            $scope.pay_branch = $scope.paysearch.ngbranchw.bankbranch_gid;
        } else {
            $scope.pay_branch = '';
        }
        if ($scope.paysearch.ngmifsc) {
            $scope.pay_ifsc = $scope.paysearch.ngmifsc;
        }
        else{
        $scope.pay_ifsc = "";
        }
        if ($scope.paysearch.payacctype) {
            $scope.pay_type = $scope.paysearch.payacctype.metadata_value;
        } else {
            $scope.pay_type = '';
        }
        if ($scope.paysearch.accno) {
            $scope.pay_accno = $scope.paysearch.accno;
        } else {
            $scope.pay_accno = '';
        }
        if ($scope.paysearch.beneficiaryname) {
            $scope.pay_beneficiaryname = $scope.paysearch.beneficiaryname;
        } else {
            $scope.pay_beneficiaryname = '';
        }

        var data = {
            "Params": {
                "Filter": {
                    "Paymode_Gid": $scope.payname,
                    "Payment_Partnergid": $scope.partner_gid,
                    "Bank_Gid": $scope.paybank,
                    "Bankbranch_Gid": $scope.pay_branch,
                    "Bankbranch_Ifsccode": $scope.pay_ifsc,
                    "Payment_Acctype": $scope.pay_type,
                    "Payment_Accnumber": $scope.pay_accno,
                    "Payment_Benificiaryname": $scope.pay_beneficiaryname,
                    "Mst_Table": $scope.msttable,
                },
                "Classification": {
                    Entity_Gid: $scope.entity_gid,
                },
                "Group": "ATMAPAYMENTSUMMARY",
                "Action": "Payment_Get",

            }
        }
        var get_data = Servicedrctsale.get_atmapayment(data)
        get_data.then(function(result) {
            $scope.payment_alldetails = result.data.DATA;
            $scope.payment_search=$scope.payment_alldetails
            //console.log($scope.alldetails)
            //alert(JSON.stringify($scope.payment_alldetails))
        })

    }

    $scope.change_payment=function(a){

        if(a.payacctype != undefined && a.payacctype != null && a.payacctype !='' )
        {
        var paytemp4=a.payacctype.metadata_value;
        }
    else
        {
        var paytemp4='';
        }
        if(a.ngbranchw != undefined && a.ngbranchw != null && a.ngbranchw !='' )
        {
        var paytemp3=a.ngbranchw.bankbranch_name;
        }
    else
        {
        var paytemp3='';
        }
        if(a.Paymode_name != undefined && a.Paymode_name != null && a.Paymode_name !='' )
        {
        var paytemp1=a.Paymode_name.Paymode_name;
        }
    else
        {
        var paytemp1='';
        }
        $scope.payment_alldetails = $filter('filter')($scope.payment_search , {
               "bankbranch_ifsccode": a.ngmifsc == null ||  a.ngmifsc == undefined ||  a.ngmifsc == '' ? '' :  a.ngmifsc,
               "payment_accnumber": a.accno == null ||  a.accno == undefined ||  a.accno == '' ? '' :  a.accno,
               "payment_benificiaryname": a.beneficiaryname == null || a.beneficiaryname == undefined || a.beneficiaryname == '' ? '' : a.beneficiaryname ,
               "Paymode_name": paytemp1 == null || paytemp1 == undefined || paytemp1 == '' ? '' : paytemp1 ,
               "bankbranch_name": paytemp3 == null || paytemp3 == undefined || paytemp3 == '' ? '' : paytemp3 ,
               "payment_acctype": paytemp4 == null || paytemp4 == undefined || paytemp4 == '' ? '' : paytemp4 ,
               "bank_name": $scope.paytemp21 == null || $scope.paytemp21 == undefined || $scope.paytemp21 == '' ? '' : $scope.paytemp21 ,

        });
    }

    function bankbranchnames(module) {
        var result = $filter('filter')($scope.branchdetails, {
            'bankbranch_name': module

        });
        return result;
    }
    $scope.ngbank = function(e) {

        if(e == undefined)
        {
       $scope.pay.bankbranch_paymodedata='';
        }
       $scope.bid = e.bank_gid;
       var paymode = {
           "Table_name": "gal_mst_tbankbranch",
           "Column_1": "bankbranch_gid,bankbranch_name",
           "Column_2": "",
           "Where_Common": "bankbranch",
           "Where_Primary": "bank_gid",
           "Primary_Value": $scope.bid,
           "Order_by": "name"
       }
       var paymodeval = {
           Action: "",
           Entity_Gid: $scope.entity_gid,
           data: paymode
       }
       $scope.partnerpaymodebranch = [];
       var getpymodebranchval = Servicedrctsale.getpaymodebranchdata(paymodeval)
       getpymodebranchval.then(function(result) {
           $scope.partnerpaymodebranch = result.data.DATA;
           if($scope.partnerpaymodebranch==undefined){
           alert("No Branch Details")
           }
           //alert(JSON.stringify($scope.partnerpaymodebranch))
       }, function(err) {
           alert('No data!.');
       }).finally();
   }

   bankbranchgid();
   function bankbranchgid(query) {
       var result = $filter('filter')($scope.partnerpaymodebranch, {
           'bankbranch_name': query
       });
       return result;
   }
   $scope.branch_name = bankbranchgid;

   $scope.payngbank = function(e) {
        $scope.bid = e.bank_gid;
        var data = {
            "Params": {
                "Type": "BranchGet",
                "bank_gid": $scope.bid,
            }
        }
        $scope.branchdetails=[];
        var getbranchdata = Servicedrctsale.getbranchdetails(data)
        getbranchdata.then(function(result) {
            $scope.branchdetails = result.data;
            //alert(JSON.stringify($scope.branchdetails))
        })
    }
    $scope.branchdetails=[];

    function gotopartneracctype(query) {
        var dat = {
            "Table_name": "gal_mst_tmetadata",
            "Column_1": "metadata_gid,metadata_value",
            "Column_2": "",
            "Where_Common": "metadata",
            "Where_Primary": "columnname",
            "Primary_Value": "payment_acctype",
            "Order_by": "value",
            "Limits": "0,30",
            "Search_Column": query,
        }
        var paymentaccount_type = {
            Action: "",
            Entity_Gid: $scope.entity_gid,
            data: dat
        }
        return $http.post(Appname + '/prodget/' , paymentaccount_type).then(function(result) {
        console.log(result.data.DATA);
            return result.data.DATA;
          });

    }


    $scope.payngpamodetype = function(e) {
    $scope.payid = e.paymode_gid;

     if(e == "CHEQUE" || e == "DD"){
    $scope.paymode_cheque = false;
    $scope.bid=0;
    $scope.bbranchgid=0;
    $scope.payment_acctype=0;
    $scope.pay.accnumber_paymodedata=0;
    }

    else if(e.Paymode_name == "CHEQUE"){
    $scope.bid=0;
    $scope.bbranchgid=0;
    $scope.payment_acctype=0;
    $scope.pay.accnumber_paymodedata=0;
    $scope.paymode_cheque = false;
    }
        else if(e.Paymode_name == "DD"){
    $scope.bid=0;
    $scope.bbranchgid=0;
    $scope.payment_acctype=0;
    $scope.pay.accnumber_paymodedata=0;
    $scope.paymode_cheque = false;
    }
    else if(e.Paymode_name != "CHEQUE"){
    $scope.paymode_cheque = true;
    }
    else if(e != "CHEQUE"){
    $scope.paymode_cheque = true;
    }
    else{
    $scope.paymode_cheque = false;
    }

<!--            $scope.paymode_name=e.Paymode_name;-->
<!--        $scope.payid = e.paymode_gid-->
<!--        if(e.Paymode_name=="CHEQUE"){-->
<!--        $scope.paymode_cheque=false;-->
<!--         $scope.bid=0;-->
<!--         $scope.bbranchgid=0;-->
<!--        }-->
<!--        if(e.Paymode_name != "CHEQUE"){-->
<!--        $scope.hidebank=false;-->
<!--        $scope.paymode_cheque=true;-->
<!--        }-->
    }

    $scope.payngbranch1 = function(e) {
        $scope.bbranchgid = e.bankbranch_gid
    }

<!--    ADDED A BANK BRANCH AND IFSC -->

$scope.canclbrnch = function(e){
    $scope.add.ifsccode_bankname= "";
    $scope.add.ifsccode_branchname= "";
    $scope.add.ifsc_code= "";
    $scope.add.micricode="";
    $scope.add.addline="";
    $scope.add.addline2="";
    $scope.add.addline3="";
    $scope.add.pincode1="";
    $scope.add.addselecteddistrict="";
    $scope.add.addselectedcity="";
    $scope.add.addselectedstate= "";
    modalhide('shwbankbrnch');
}


    $scope.addbank_branch = function(e)
    {
    $scope.add.ifsccode_bankname= "";
    $scope.add.ifsccode_branchname= "";
    $scope.add.ifsc_code= "";
    $scope.add.micricode="";
    $scope.add.addline="";
    $scope.add.addline2="";
    $scope.add.addline3="";
    $scope.add.pincode1="";
    $scope.add.addselecteddistrict="";
    $scope.add.addselectedcity="";
    $scope.add.addselectedstate= "";
    modalshow('shwbankbrnch');
    }

    $scope.checkifsc_fn=function(e){
        var data={
            "Params":{
                "Filter":{
                    "IFSC_Code":e,
                },
                "Group":"IFSC_GROUP",
            }
        }
        $scope.loading();
        var check_ifscv = Servicedrctsale.getifsc(data)
        check_ifscv.then(function(result) {
            $scope.add.ifsccode_bankname= result.data.Bank_Name;
            $scope.add.ifsccode_branchname = result.data.Branch_Name;
            if($scope.add.ifsccode_branchname==''){
            alert("Invalid IFSC Code");
            }
            //alert(JSON.stringify($scope.ifsccode_bankname))
        }).finally($scope.endloading)
    }

    $scope.addbankbranchdetails=function(e){
        var data={
            "Params":{
                "Filter":{
                    "Bank_Name":e.ifsccode_bankname,
                    "BankBranch_Name":e.ifsccode_branchname,
                    "BankBr_ifscCode":e.ifsc_code,
                    "BankBr_MicroCode":e.micricode,
                    "Address1":e.addline,
                    "Address2":e.addline2,
                    "Address3":e.addline3,
                    "Address_Ref_Code":"BANKBRANCH_ADDRESS",
                    "Address_Pincode":e.pincode1,
                    "Address_District_Gid":e.addselecteddistrict,
                    "Address_City_Gid":e.addselectedcity,
                    "Address_State_Gid":e.addselectedstate
                },
                "Classification": {"Entity_Gid": $scope.entity_gid},
                "Group":"BanckBranch_Set",
                "Type":"BANK_BRANCH",
                "SubType":"MAKING",
                "Action":"INSERT",
                "Create_by":$scope.create_by,
                }
        }
        var add_branch=Servicedrctsale.setbranchdata(data)
        add_branch.then(function(result){
            $scope.branchresult=result.data;
            if($scope.branchresult=='SUCCESS'){
                alert("SUCCESSFULLY INSERTED");
                modalhide('shwbankbrnch');
            }else{
                alert($scope.branchresult);
            }
        })
    }


    $scope.addpayment = function(r) {
$scope.payment_disabled=true;
    if(r.paymode_paymodedata.Paymode_name=="CHEQUE" || r.paymode_paymodedata.Paymode_name=="DD"){
    $scope.acc_paymode='0';
    $scope.pay_acc_num='0';
    $scope.bids=0;
    $scope.bbranchgids=0;
    }else{
     if(r.acctype_paymodedata == null || r.acctype_paymodedata == ""){
    alert("Please Enter Account Type");
    $scope.payment_disabled=false;
    return false;
    }
     $scope.acc_paymode=r.acctype_paymodedata.metadata_value;
     $scope.pay_acc_num=r.accnumber_paymodedata;
      $scope.bname_paymodedata=r.bname_paymodedata ;
     $scope.bid = r.bank_paymodedata ;
     $scope.bids = r.bank_paymodedata.bank_gid ;
     $scope.bbranchgid = r.bankbranch_paymodedata ;
     $scope.bbranchgids = r.bankbranch_paymodedata.bankbranch_gid;
    if(r.paymode_paymodedata==""){
    alert("Please select Paymode Name")
    $scope.payment_disabled=false;
    return false;
    }
    if($scope.bid=="" || $scope.bid === null){
    alert("Please select Bank Name")
    $scope.payment_disabled=false;
    return false;
    }
    if( $scope.bbranchgid=="" || $scope.bbranchgig === null){
    alert("Please select Branch Name")
    $scope.payment_disabled=false;
    return false;
    }

    if($scope.pay_acc_num=="" || $scope.pay_acc_num == undefined){
    alert("Please Enter Bank Account Number")
    $scope.payment_disabled=false;
    return false;
    }
    if ($scope.bname_paymodedata == "" || $scope.bname_paymodedata === undefined ) {
    alert("please Enter Beneficiary Name ")
    $scope.payment_disabled=false;
    return false;
    }
    }
    if(r.paymode_paymodedata.Paymode_name!="CHEQUE"){
    if(r.paymode_paymodedata.Paymode_name!="DD"){
    if($scope.bbranchgid==0){
    alert("Plese Select Bank Branch Name")
    $scope.payment_disabled=false;
    return false;
    }
    }
    }

        var data =
        {
            "Params": {
                    "Filter": {
                    "Payment_Partner_Gid": $scope.partner_gid,
                    "Payment_Paymodegid":r.paymode_paymodedata.paymode_gid,
                    "Payment_Partnerbranchgid":r.branch.partnerbranch_gid,
                    "Payment_Bankgid":$scope.bids,
                    "Payment_Bankbranchgid": $scope.bbranchgids,
                    "Payment_Acctype":$scope.acc_paymode,
                    "Payment_Accnumber":$scope.pay_acc_num,
                    "Payment_Benificiaryname":r.bname_paymodedata,
                    "Payment_Remarks":r.paymentremarks,
                    "Create_By": $scope.create_by
                     },
                     "Classification":{
                    "Entity_Gid": $scope.entity_gid
                     },
            "Group": "PAYMODESUMMARY",
            "Action": "INSERT",
                    }
        }
        $scope.loading();
        var get_data = Servicedrctsale.Paymentaddheader(data)
        get_data.then(function(result) {
        //alert(JSON.stringify(result.data));
            if (result.data == "SUCCESS") {
                alert("Inserted successfully!.");
                getpaymode();
                $scope.pngpaymode = "",
                $scope.pay.paymode_paymodedata ="",
                $scope.pay.bank_paymodedata = "",
                $scope.pay.bankbranch_paymodedata = "",
                $scope.pay.acctype_paymodedata = "",
                $scope.pay.accnumber_paymodedata = "",
                $scope.pay.bname_paymodedata = "",
                $scope.pay.paymentremarks = "",
                $scope.bid="",
                $scope.bbranchgid="",
                $scope.pay.branch="",
                modalhide('mdl_present');
            } else {
                alert(result.data);
            }

   }),
            function(err) {
                alert('no data');
            }.finally($scope.endloading());

}

    $scope.closedetail = function() {
        $scope.pngpaymode = "";
        $scope.pngbankw = "";
        $scope.pngbranchw = "";
        $scope.ppayacctype = "";
        $scope.ppayaccno = "";
        $scope.ppaybeneficiaryname = "";
        $scope.ppayremarks = "";
    }

    $rootScope.showview = function(ev) {
        $scope.loading();
        modalshow('atma_paymentview_page')
        $scope.paymodepop = ev.Paymode_name
        $scope.bankpop = ev.bank_name
        $scope.branchpop = ev.bankbranch_name
        $scope.ifscpop = ev.bankbranch_ifsccode
        $scope.acctpop = ev.payment_acctype
        $scope.accnpop = ev.payment_accnumber
        $scope.benipop = ev.payment_benificiaryname
        $scope.endloading();
    }
$scope.addpay = true;
$scope.pay=[];

    $scope.paymentedit_data=function(payment){

    $scope.paymode_cheque=false;
    $scope.tpay_true=true;
    $scope.tpay_true1=true;
    $scope.tpay_true2=true;
    $scope.tpay_true3=true;
    if(payment.Paymode_name=="CHEQUE" || payment.Paymode_name=="DD"){
    $scope.paymode_cheque=false;
    $scope.paymode_readonly=false;
   }

   else{
    $scope.paymode_cheque=true;
    $scope.paymode_readonly=false;
   }
    $scope.payeditid=payment.payment_gid,
    $scope.pay.paymode_paymodedata=payment.Paymode_name,
    $scope.pay.bank_paymodedata=payment.bank_name,
    $scope.pay.bankbranch_paymodedata=payment.bankbranch_name,
    $scope.pay.branch=payment.partnerbranch_name,
    $scope.pay.acctype_paymodedata=payment.payment_acctype,
    $scope.pay.accnumber_paymodedata=payment.payment_accnumber,
    $scope.pay.bname_paymodedata=payment.payment_benificiaryname,
    $scope.pay.paymentremarks=payment.payment_remarks,
    modalshow('mdl_present')
    $scope.addpay = false;
    $scope.editpay = true;
    $scope.inactivepay = true;
    }
    $scope.view_paymentdetails=function(payment){
    $scope.paymode_cheque=false;
    $scope.tpay_true=true;
    $scope.tpay_true1=true;
    $scope.tpay_true2=true;
    $scope.tpay_true3=true;
    if(payment.Paymode_name=="CHEQUE"){
    $scope.paymode_cheque=false;
   }
   if(payment.Paymode_name=="NEFT"){
    $scope.paymode_cheque=true;
   }
    $scope.payeditid=payment.payment_gid,
    $scope.pay.branch=payment.partnerbranch_name,
    $scope.pay.paymode_paymodedata=payment.Paymode_name,
    $scope.pay.bank_paymodedata=payment.bank_name,
    $scope.pay.bankbranch_paymodedata=payment.bankbranch_name,
    $scope.pay.acctype_paymodedata=payment.payment_acctype,
    $scope.pay.accnumber_paymodedata=payment.payment_accnumber,
    $scope.pay.bname_paymodedata=payment.payment_benificiaryname,
    $scope.pay.paymentremarks=payment.payment_remarks,
    modalshow('mdl_present')
    $scope.addpay = false;
    $scope.editpay = false;
    $scope.inactivepay = false;
    }

    $scope.updatepayment=function(e){


    alert(e.paymode_paymodedata);

    if(e.paymode_paymodedata == "CHEQUE"){
        $scope.payment_acctype='0';
        $scope.pay.accnumber_paymodedata ='0'
    }
    else if(e.paymode_paymodedata=="DD"){
      $scope.payment_acctype='0';
      $scope.pay.accnumber_paymodedata = '0';
    }
    else{
        $scope.payment_acctype=e.acctype_paymodedata.metadata_value;
    }
    if(e.bank_paymodedata==null){
    $scope.bkid=0;
    }else{
    $scope.bkid=$scope.bid;
    }
    if(e.bankbranch_paymodedata==null){
    $scope.bkbranchgid=0;
    }else{
    $scope.bkbranchgid=$scope.bbranchgid;
    }

    var data =
        {
            "Params": {
                    "Filter": {
                    "Payment_Gid": $scope.payeditid,
                    "Payment_Partner_Gid": $scope.partner_gid,
                    "Payment_Partnerbranchgid":e.branch.partnerbranch_gid,
                    "Payment_Paymodegid": $scope.payid,
                    "Payment_Bankgid": $scope.bkid,
                    "Payment_Bankbranchgid": $scope.bkbranchgid,
                    "Payment_Acctype":$scope.payment_acctype,
                    "Payment_Accnumber": $scope.pay.accnumber_paymodedata,
                    "Payment_Benificiaryname": $scope.pay.bname_paymodedata,
                    "Payment_Remarks": $scope.pay.paymentremarks,

                     },
                     "Classification":{
                    "Entity_Gid": $scope.create_by
                     },
            "Group": "UPDATEPAYMODESUMMARY",
            "Action": "UPDATE",
                    }
        }
        $scope.loading();
        var get_data = Servicedrctsale.Paymentaddheader(data)
        get_data.then(function(result) {

            if (result.data == "SUCCESS") {
                alert("SUCCESSFULLY UPDATED!.");
                getpaymode();
                    modalhide('mdl_present');
            } else {
                alert("Data not Update")
            }
   }),
            function(err) {
                alert('no data');
            }.finally($scope.endloading());
   }
   $scope.inactivepayment=function(e){
   if($scope.payment_alldetails.length == 1){
   alert("You Can't Inactive Atleast One Paymode Needed");
   return false;
   }
    var data =
        {
            "Params": {
                    "Filter": {
                    "Payment_Gid": $scope.payeditid,
                     },
                     "Classification":{
                    "Entity_Gid": $scope.create_by
                     },
            "Group": "UPDATEPAYMODESUMMARY",
            "Action": "INACTIVE",
                    }
        }
        $scope.loading();
        var get_data = Servicedrctsale.Paymentaddheader(data)
        get_data.then(function(result) {

            if (result.data == "SUCCESS") {
                alert("SUCCESSFULLY UPDATED!.");
                getpaymode();
                    modalhide('mdl_present');
            } else {
                alert("Data not Update")
            }
   }),
            function(err) {
                alert('no data');
            }.finally($scope.endloading());

}
    //PAYMENTEND

    //ATTACHMENTSTART


    $scope.dd_DocumentGroup = fn_DocumentGroup;
    function fn_DocumentGroup(query) {
       var dat = {
            "Table_name": "atma_mst_tdocgroup",
            "Column_1": "docgroup_gid,docgroup_name",
            "Column_2": "",
            "Where_Common": "docgroup",
            "Where_Primary": "isparent",
            "Primary_Value": "Y",
            "Order_by": "name",
            "Limits": "0,30",
            "Search_Column": query,
        }
        var pdoc = {
            Action: "",
            Entity_Gid: $scope.entity_gid,
            data: dat
        }
        return $http.post(Appname + '/prodget/' , pdoc).then(function(result) {
        console.log(result.data.DATA);
            return result.data.DATA;
          });
    }

    function gotodocname1(query) {
        var result = $filter('filter')($scope.docname, {
            'docgroup_name': query
        });
        return result;
    }

    $scope.addngdocgrop = function(e)
    {
    if(e == undefined)
        {

       $scope.Attachment.Document_Name='';
       $scope.Attachment.selectedItem_documentnamee='';
       $scope.Attachment.selectedItem_documentname='';
        }
        $scope.dgid = e.docgroup_gid;
        var dat = {
            "Table_name": "atma_mst_tdocgroup",
            "Column_1": "docgroup_gid,docgroup_name,docgroup_parentgid",
            "Column_2": "",
            "Where_Common": "docgroup",
            "Where_Primary": "parentgid",
            "Primary_Value": $scope.dgid,
            "Order_by": "name"
        }
        var pdocname = {
            Action: "",
            Entity_Gid: $scope.entity_gid,
            data: dat
        }
        $scope.docname = [];
        var getdocname = Servicedrctsale.getdocnamedata(pdocname)
        getdocname.then(function(result) {
            $scope.docname = result.data.DATA;
            //alert(JSON.stringify($scope.docname))
        }, function(err) {
            alert('No data!.');
        }).finally();
    }


$scope.searchdocumentname=function(e){

if(e.docgroup_gid != undefined && e.docgroup_gid != null && e.docgroup_gid !='' )
        {
        var attachtemp1=e.docgroup_gid;
        }
    else
        {
        var attachtemp1='';

        }
 $scope.getattachmentsummary=$filter('filter')($scope.searchgetattachmentsummary,{
    "docgroup_name":  attachtemp1 == null || attachtemp1 == undefined || attachtemp1 == '' ? '' : attachtemp1 ,
    "Document_Name":  $scope.atachs == null || $scope.atachs == undefined || $scope.atachs == '' ? '' : $scope.atachs ,

    })

}
 $scope.Attachment_search=[];
$scope.ngdocgrop1 = function(e)
    {

    if(e != undefined && e != null && e !='' )
        {
        var attachtemp=e.docgroup_name;
        $scope.atachs=e.docgroup_name;
        }
    else
        {
        var attachtemp='';
        $scope.searchTextDN1='';
        //$scope.Attachment_search.selectedItem_documentnamee='';
        }


    if(e == undefined)
        {

       $scope.Attachment_search.selectedItem_documentnamee='';

        }
        $scope.dgid = e.docgroup_gid;
        var dat = {
            "Table_name": "atma_mst_tdocgroup",
            "Column_1": "docgroup_gid,docgroup_name,docgroup_parentgid",
            "Column_2": "",
            "Where_Common": "docgroup",
            "Where_Primary": "parentgid",
            "Primary_Value": $scope.dgid,
            "Order_by": "name"
        }
        var pdocname = {
            Action: "",
            Entity_Gid: $scope.entity_gid,
            data: dat
        }
        $scope.search_docname = [];
        var getdocname = Servicedrctsale.getdocnamedata(pdocname)
        getdocname.then(function(result) {
            $scope.search_docname = result.data.DATA;
            //alert(JSON.stringify($scope.docname))
        }, function(err) {
            alert('No data!.');
        }).finally();}

    $scope.ngdocgrop = function(e)
    {
    debugger;
    if(e != undefined && e != null && e !='' )
        {
        var attachtemp=e.docgroup_name;
        $scope.atachs=e.docgroup_name;
        }
    else
        {
        var attachtemp='';
        $scope.atachs='';
        }


    if(e == undefined)
        {
       $scope.Attachment.Document_Name='';
       $scope.Attachment.selectedItem_documentnamee='';
       $scope.Attachment.selectedItem_documentname='';
        }
        $scope.dgid = e.docgroup_gid;
        var dat = {
            "Table_name": "atma_mst_tdocgroup",
            "Column_1": "docgroup_gid,docgroup_name,docgroup_parentgid",
            "Column_2": "",
            "Where_Common": "docgroup",
            "Where_Primary": "parentgid",
            "Primary_Value": $scope.dgid,
            "Order_by": "name"
        }
        var pdocname = {
            Action: "",
            Entity_Gid: $scope.entity_gid,
            data: dat
        }
        $scope.docname = [];
        var getdocname = Servicedrctsale.getdocnamedata(pdocname)
        getdocname.then(function(result) {
            $scope.docname = result.data.DATA;
            //alert(JSON.stringify($scope.docname))
        }, function(err) {
            alert('No data!.');
        }).finally();


        $scope.getattachmentsummary=$filter('filter')($scope.searchgetattachmentsummary,{
    "docgroup_name":  attachtemp == null || attachtemp == undefined || attachtemp == '' ? '' : attachtemp ,
     "Document_Name":  $scope.attachtemp121 == null || $scope.attachtemp121 == undefined || $scope.attachtemp121 == '' ? '' : $scope.attachtemp121 ,

    })
    }


    function reconname_attachment(item) {
        var fileExtension = '.' + item.split('.').pop();
        $scope.recon_name = "ATTACH_" + new Date().getTime() + fileExtension;
    };

    $scope.Attachmentsave = function(Attachment){

    $scope.Attachment_disabled=true;
    if($scope.Attachment.description == undefined){
    $scope.Attachment.descriptions="";
    }else{
    $scope.Attachment.descriptions=$scope.Attachment.description;
    }
        if ($scope.Attachment.file == undefined) {
            alert("Fill the File field!.");
            $scope.Attachment_disabled=false;
            return false;
        }
        $scope.attachmentfilename = $scope.Attachment.file.name;
        if ($scope.Attachment.selectedItem_documentname) {
            $scope.DocumentGid = $scope.Attachment.selectedItem_documentname.docgroup_gid;
        } else {
            $scope.DocumentGid = '';
        }
        if ($scope.Attachment.file !== undefined) {
            var excl = new FormData();
            reconname_attachment($scope.attachmentfilename);
            excl.append('file', $scope.Attachment.file);
            excl.append('name', $scope.recon_name);
            excl.append('Group', 'Document_Group');
            excl.append('Action','Insert');
            excl.append('Type', 'Document_Group');
            excl.append('Documents_Partnergid', $scope.partner_gid);
            excl.append('Documents_Docgroupgid', $scope.DocumentGid);
            excl.append('Documents_Period', 'one time');
            excl.append('Description', $scope.Attachment.descriptions);
            excl.append('File_Name', $scope.recon_name);
            excl.append('File_Path', "home/bala");
            excl.append('Entity_Gid', $scope.entity_gid);
            excl.append('Create_By', $scope.create_by);
            loadexclAttacment(excl);
        }
    }
    function loadexclAttacment(excl)
    {

        $scope.loading();
        var overalldtl = Servicedrctsale.setdocgrp(excl);
        overalldtl.then(function(res) {
            var hosmr = [];
            $scope.hosmr = res.data.MESSAGE;
            if($scope.hosmr=="SUCCESSFULLY INSERTED"){
            alert("SUCCESSFULLY INSERTED");
            $scope.Attachment.selectedItem_documentgroup="",
            $scope.Attachment.selectedItem_documentname="",
            $scope.Attachment.description="",
            $scope.Attachment.file="",
            fn_getattachmentsummary();
            modalhide('attachmentAddPopup');
            }
            else{
             alert(JSON.stringify($scope.hosmr));
              $scope.Attachment_disabled=false;
            }
        }).finally($scope.endloading);
    }
   $scope.Search_in_Attachment = function()
    {
        fn_getattachmentsummary();
    }

   fn_getattachmentsummary();

   function fn_getattachmentsummary()
   {


        if ($scope.Attachment.selectedItem_documentgroup) {
            $scope.DocgroupGid = $scope.Attachment.selectedItem_documentgroup.docgroup_gid;
        } else {
            $scope.DocgroupGid = '';
        }

        if ($scope.Attachment.selectedItem_documentname) {
            $scope.DocumentGid = $scope.Attachment.selectedItem_documentname.docgroup_gid;
        } else {
            $scope.DocumentGid = '';
        }

        var data = {
            "Params": {
                "Filter":   {
                    "Docgroup_Gid": $scope.DocgroupGid,
                    "Document_Gid": $scope.DocumentGid,
                    "Documents_Partnergid": $scope.partner_gid,
                    "Document_description":$scope.Attachment.description,
                    "Mst_Table": $scope.msttable,
                            },
                "Classification":   {
                    "Entity_Gid": $scope.entity_gid
                                    }
                    }
                    }
        var dtam = {
            Group: 'Document_Group',
            Type: 'Document_Get',
            data: data
        }

        var getattachmentsummary1 = Servicedrctsale.get_attachmentsummary(dtam)
        getattachmentsummary1.then(function(result)
        {
           $scope.getattachmentsummary = result.data.DATA;
           $scope.searchgetattachmentsummary = result.data.DATA;
           //alert(JSON.stringify( $scope.getattachmentsummary));
        }, function(err)
        {
           alert('No data!.');
        }).finally();
   }


$scope.shwpdf = false;
   //for pdf view
   $scope.showattachment = function(e){

   // modalshow('viewpdfpopup');
   $scope.shwpdf = true;
   $scope.pdfurl = e.file_path;
   $scope.pdf_filename = e.file_name;

   }
   //$scope.shwpdfs = false;
   $scope.show_tax_pdfview = function(d){

    //modalshow('tax_viewpdfpopup');
   //$scope.shwpdfs = true;
   $scope.pdfurls = d.file_path;
   $scope.pdf_filenames = d.file_name;

   }

   //attachment edit

   $scope.addbattchmentpopup=function(){
    $scope.Attachment_disabled=false;
   $scope.showattachmentsubmit=true;
   $scope.showattachmetupdate=false;
   modalshow('attachmentAddPopup');

   }
    $scope.edit_attachment=function(e)
    {

      $scope.showattachmentsubmit=false;
   $scope.showattachmetupdate=true;
        $scope.docgid=e.documents_gid
        $scope.attachfile=false;
        $scope.Attachment.docgroup_name=e.docgroup_name,
        $scope.Attachment.Document_Name=e.Document_Name,
        $scope.Attachment.file_name=e.file_name,
        $scope.Attachment.documents_remarks=e.documents_remarks,
        $scope.documnet_filepath=e.file_path,
        $scope.dgrpgid=e.docgroup_gid
    }
    $scope.attachfileupdate=function(){
        $scope.attachfile=true;
    }
    $scope.updateattachment=function(e){
    debugger;
        if(e.documents_remarks==undefined){
         $scope.Attachment.documents_remarke1="";
        }else{
         $scope.Attachment.documents_remarke1= $scope.Attachment.documents_remarks
        }
        if ($scope.Attachment.fileEdit !== undefined) {
            $scope.attachmentfilename = $scope.Attachment.fileEdit.name;
            var excl = new FormData();
            reconname_attachment($scope.attachmentfilename);
            excl.append('file', $scope.Attachment.fileEdit);
            excl.append('name', $scope.recon_name);
            excl.append('Group', 'Document_Update');
            excl.append('Action','UPDATE');
            excl.append('Type', 'Document_Group');
            excl.append('Documents_Gid', $scope.docgid);
            excl.append('Documents_Docgroupgid',$scope.dgrpgid);
            excl.append('Documents_Period', 'one time');
            excl.append('Description', $scope.Attachment.documents_remarke1);
            excl.append('File_Name', $scope.recon_name);
            excl.append('File_Path', $scope.documnet_filepath);
            Attachment_Update(excl);
        }else{
                var excl = new FormData();
                //$scope.attachmentfilename=$scope.Attachment.file_name;
                //reconname_attachment($scope.attachmentfilename);
                //excl.append('file','');
                //excl.append('name', '');
                excl.append('Group', 'Document_Updatenofile');
                excl.append('Action','UPDATE');
                excl.append('Type', 'Document_Group');
                excl.append('Documents_Gid', $scope.docgid);
                excl.append('Documents_Docgroupgid', $scope.dgrpgid);
                excl.append('Documents_Period', 'one time');
                excl.append('Description', $scope.Attachment.documents_remarke1);
                excl.append('File_Name', $scope.Attachment.file_name);
                excl.append('File_Path', $scope.documnet_filepath);
                Attachment_Update(excl);
        }

    }

	function Attachment_Update(excl) {
	 //modalhide('myModal')
			$scope.loading();
			var overalldtl = Servicedrctsale.updateattachmentdetails(excl);
			overalldtl.then(function(res) {
				var hosmr = [];
				$scope.hosmr = res.data;
				//alert(JSON.stringify( $scope.hosmr));
				if ($scope.hosmr == "SUCCESSFULLY UPDATED") {
					alert("SUCCESSFULLY UPDATED!.");
					fn_getattachmentsummary();
                      modalhide('myModal')
				} else {
					    alert($scope.hosmr);
                       // modalshow('myModal')
				}
			}).finally($scope.endloading);
		}

	$scope.ngdoc_name=function(e){


	}
	//ATTACHMENTEND

//TAXSTART
    function fn_taxpartnerbranchdetails(query) {
         var datan = {
            "Table_name": "atma_tmp_mst_tpartnerbranch",
            "Column_1": "partnerbranch_gid,partnerbranch_name,partnerbranch_code",
            "Column_2": "",
            "Where_Common": "partnerbranch",
            "Where_Primary": "partnergid",
            "Primary_Value": $scope.partner_gid,
            "Order_by": "name",
            "Limits": "0,30",
            "Search_Column": query,
                   }
        var trans = {Action: "",Entity_Gid: $scope.entity,data: datan}
            return $http.post(Appname + '/prodget/' , trans).then(function(result) {
            console.log(result.data.DATA);
                return result.data.DATA;
              });
    }


    $scope.view_pan=function(e){


    $scope.branchids=e.partnerbranch_gid;
    if($scope.branchids==undefined){
    $scope.branchids=0;
    return false;
    }
        var datan = {
            "Table_name": "atma_tmp_mst_tpartnerbranch",
            "Column_1": "partnerbranch_gid,partnerbranch_panno,partnerbranch_gstno",
            "Column_2": "",
            "Where_Common": "partnerbranch",
            "Where_Primary": "gid",
            "Primary_Value": $scope.branchids,
            "Order_by": "gid"
                   }

        var trans = {
            Action: "",
            Entity_Gid: $scope.entity,
            data: datan
                    }

        var gettaxpartnerbranchs = Servicedrctsale.getbranch_taxgst(trans)
        gettaxpartnerbranchs.then(function(result) {
        $scope.dsxf = result.data.DATA;
        $scope.add_tax.ngmtaxno = result.data.DATA[0].partnerbranch_panno;
        $scope.dsxf2 = result.data.DATA[0].partnerbranch_gstno;
        //alert(JSON.stringify( $scope.dsxf1));

    }, function(err) {
        alert('No data!.');
    }).finally();

    }

    $scope.updatetaxdetailsmode=function(e){

    $scope.ad=$scope.add_tax.fdate;
    $scope.ads=$scope.add_tax.tdate;
    if($scope.ad==null){
    $scope.updatetax_fromdate=null;
    }
    else{
    $scope.updatetax_fromdate = formatStringDate($scope.ad, 'yyyy-mm-dd');
    }
    if($scope.ads==null){
    $scope.updatetax_todate=null;
    }
    else{
    $scope.updatetax_todate = formatStringDate($scope.ads, 'yyyy-mm-dd');
    }
    if($scope.add_tax.ngisexcem.metadata_value){
        $scope.isexcem=$scope.add_tax.ngisexcem.metadata_value
    }else{
        $scope.isexcem=$scope.add_tax.ngisexcem
    }
    if($scope.hg == undefined){
        $scope.add_tax.ngpsMSME="";
    }
   if($scope.add_tax.ngpsMSME.metadata_value){
        $scope.add_tax.ngpsMSME = $scope.add_tax.ngpsMSME.metadata_value
   }
   else{
        $scope.add_tax.ngpsMSME = $scope.add_tax.ngpsMSME
   }
   if( $scope.trgid){
        $scope.ngistaxrategid=$scope.trgid;
   }else{
        $scope.ngistaxrategid=$scope.add_tax.ngistaxrategid;
   }
   if(  $scope.trat){
        $scope.ngistaxrate=  $scope.trat;
   }else{
        $scope.ngistaxrate=$scope.add_tax.ngistaxrate;
   }
   if( $scope.tgd){
        $scope.tax_gids= $scope.tgd;
    }else{
        $scope.tax_gids= $scope.tax_gid;
    }
  if( $scope.isexcem=="NO"){
        var excl = new FormData();
            $scope.name="";
            reconname($scope.name);
            excl.append('file',$scope.add_tax.file);
            excl.append('name', '');
            excl.append('Group', 'TAXINSERTSUMMARYEXEMPTEDUPDATENO');
            excl.append('Action','TAX_UPDATE');
            excl.append('Tax_Gid',     $scope.tax_gids);
            excl.append('TaxDetails_Gid',$scope.add_tax.taxgid);
            excl.append('TaxDetails_Partner_Gid',$scope.partner_gid);
            excl.append('TaxDetails_Partnerbranchcode',$scope.refbrach_code);
            excl.append('TaxDetails_Partner_Code',$scope.Partner.partnercode);
            excl.append('TaxDetails_Partner_Type','S');
            excl.append('TaxDetails_Is_MSME', $scope.add_tax.ngpsMSME);
            excl.append('TaxDetails_TaxNo', $scope.add_tax.ngmtaxno);
            excl.append('TaxSubDetails_TaxRate_Gid',$scope.trgid);
            excl.append('TaxSubDetails_TaxRate',$scope.trat);
            excl.append('TaxSubDetails_IsExcempted', $scope.idsd);
            excl.append('TaxSubDetails_ExcemFrom',  $scope.updatetax_fromdate);
            excl.append('TaxSubDetails_ExcemTo', $scope.updatetax_todate);
            excl.append('TaxSubDetails_ExcemthroSold', $scope.add_tax.ngthrosold);
            excl.append('TaxSubDetails_ExcemRate', "");
            excl.append('FileName', "");
            excl.append('Create_By', $scope.create_by);
            loadexcl_updatetax(excl);
  }
if( $scope.isexcem=="YES"){
        if ($scope.add_tax.file !== undefined) {
            $scope.name = $scope.add_tax.file.name;
            var excl = new FormData();
            reconname($scope.name);
            excl.append('file',$scope.add_tax.file);
            excl.append('name', $scope.recon_name);
            excl.append('Group', 'TAXINSERTSUMMARYEXEMPTEDUPDATEYES');
            excl.append('Action','TAX_UPDATE');
            excl.append('TaxDetails_Gid',$scope.add_tax.taxgid);
            excl.append('TaxDetails_Partner_Gid',$scope.partner_gid);
            excl.append('TaxDetails_Partnerbranchcode',$scope.refbrach_code);
            excl.append('TaxDetails_Partner_Code',$scope.Partner.partnercode);
            excl.append('TaxDetails_Partner_Type','S');
            excl.append('TaxDetails_Is_MSME', $scope.add_tax.ngpsMSME);
            excl.append('Tax_Gid',$scope.tax_gids);
            excl.append('TaxDetails_TaxNo', $scope.add_tax.ngmtaxno);
            excl.append('TaxSubDetails_TaxRate_Gid', $scope.ngistaxrategid);
            excl.append('TaxSubDetails_TaxRate', $scope.ngistaxrate);
            excl.append('TaxSubDetails_IsExcempted', $scope.idsd);
            excl.append('TaxSubDetails_ExcemFrom', $scope.updatetax_fromdate);
            excl.append('TaxSubDetails_ExcemTo',  $scope.updatetax_todate);
            excl.append('TaxSubDetails_ExcemthroSold',$scope.add_tax.ngthrosold);
            excl.append('TaxSubDetails_ExcemRate',  $scope.add_tax.ngmtaxExempted);

            excl.append('File_Name', $scope.recon_name);
            excl.append('Create_By', $scope.create_by);
            loadexcl_updatetax(excl);
        }
        else
        {
            var excl = new FormData();
            $scope.name="";
            reconname($scope.name);
            excl.append('Group', 'TAXINSERTSUMMARYEXEMPTEDUPDATEYESNOFILE');
            excl.append('Action','TAX_UPDATE');
            excl.append('TaxDetails_Gid',$scope.add_tax.taxgid);
            excl.append('TaxDetails_Partner_Gid',$scope.partner_gid);
            excl.append('TaxDetails_Partnerbranchcode',$scope.refbrach_code);
            excl.append('TaxDetails_Partner_Code',$scope.Partner.partnercode);
            excl.append('TaxDetails_Partner_Type','S');
            excl.append('name', $scope.recon_name);
            excl.append('TaxDetails_Is_MSME', $scope.add_tax.ngpsMSME);
            excl.append('Tax_Gid',$scope.tax_gids);
            excl.append('TaxDetails_TaxNo', $scope.add_tax.ngmtaxno);
            excl.append('TaxSubDetails_TaxRate_Gid', $scope.ngistaxrategid);
            excl.append('TaxSubDetails_TaxRate',$scope.ngistaxrate);
            excl.append('TaxSubDetails_IsExcempted', $scope.idsd);
            excl.append('TaxSubDetails_ExcemFrom', $scope.updatetax_fromdate);
            excl.append('TaxSubDetails_ExcemTo',  $scope.updatetax_todate);
            excl.append('TaxSubDetails_ExcemthroSold',$scope.add_tax.ngthrosold);
            excl.append('TaxSubDetails_ExcemRate',  $scope.add_tax.ngmtaxExempted);
            excl.append('File_Name',e.tax_filename);
            excl.append('FilePath',   $scope.add_tax.file_path);
            excl.append('Create_By', $scope.create_by);
            loadexcl_updatetax(excl);
        }
}
}
    function loadexcl_updatetax(excl) {
        var tax_update = Servicedrctsale.taxupdate_details(excl);
        tax_update.then(function(res) {
            var hosmr = [];
            $scope.hosmr = res.data;
            //alert(JSON.stringify($scope.hosmr));
            if($scope.hosmr == "SUCCESS"){
                    alert("SUCCESSFULLY UPDATED!")
                modalhide('taxdetailsmodal');
                gettaxdetails();
            }else {
                alert(JSON.stringify($scope.hosmr));
            }
        })
    }

    function gottaxratedetails(query) {

        var result = $filter('filter')($scope.taxrate, {
            'taxrate_rate': query
        });
        return result;
    }
    $scope.tax_exe=0;
        $scope.tax = [];
        function gottaxdetails(query) {
            debugger;
            if($scope.tax_exe==0 && query==""){
                var data = {"Params": {"Group": "GETTAXTYPE","Action": "TaxType_Get"}}
                $scope.tax = [];
                return $http.post(Appname + '/atma_gettaxdetails/' , data).then(function(result) {
                $scope.tax_exe=1;
                $scope.tax =result.data.DATA;
                console.log(result.data.DATA);

                    return result.data.DATA;
                  });
            }
            else{
                var result = $filter('filter')($scope.tax, {
                'tax_type': query
                });
                return result;
            }

    }


    $scope.ngctaxtype=function(e)
    {

        if(e == undefined){
        $scope.add_tax.ngistaxrate='';
        }
        $scope.tgd=e.tax_type_gid
        var a=e.tax_type_gid.split('-').pop();
        var b=e.tax_type.split('-');
        $scope.tax_showtype=b[0];
        if($scope.tax_showtype == "GST "){
        $scope.tax_show_data=false;
        $scope.showform=false;
        $scope.idsd='N';

        }else{
        $scope.tax_show_data=true;
        $scope.showform=true;

        }
        var dat = {
            "Table_name": "gal_mst_ttaxrate",
            "Column_1": "taxrate_gid,taxrate_rate,taxrate_subtax_gid",
            "Column_2": "",
            "Where_Common": "taxrate",
            "Where_Primary": "subtax_gid",
            "Primary_Value": a,
            "Order_by": "gid"
        }
        var ppartnertaxrate = {
            Action: "",
            Entity_Gid: $scope.entity_gid,
            data: dat
        }
        //$scope.taxrate=[];
        var getpartnertaxrate = Servicedrctsale.gettaxreateedata(ppartnertaxrate)
        getpartnertaxrate.then(function (result) {

            $scope.taxrate = (result.data.DATA);
           //alert(JSON.stringify( $scope.taxrate))
        },
        function (err) {
            alert('No data!.');
        }).finally();
    }

    function gotisexcempted(query){
    var result=$filter('filter')($scope.metaisexcempted,{
    'metadata_value':query
    });
    return result;
    }

    $scope.metaisexcempted=[];
    function gotisexcempted(query){
        var dat = {
            "Table_name": "gal_mst_tmetadata",
            "Column_1": "metadata_value",
            "Column_2": "",
            "Where_Common": "metadata",
            "Where_Primary": "columnname",
            "Primary_Value": "taxsubdetails_isexcempted",
            "Order_by": "value"
        }
        var ppartnerisexcempted = {
            Action: "",
            Entity_Gid: $scope.entity_gid,
            data: dat
        }

        return $http.post(Appname + '/prodget/' , ppartnerisexcempted).then(function(result) {
        console.log(result.data.DATA);
            return result.data.DATA;
          });

    }


    taxdisabled();

    function taxdisabled(){

    }
    $scope.ngcMSME=function(e){

    $scope.hg=e;
    $scope.ngpsMSME=e.metadata_value;

    }

    if($scope.ones=="YES"){
    $scope.taxexce=true;
    }

    $scope.ngcngtaxrate=function(e){

    $scope.trgid=e.taxrate_gid
    $scope.trat=e.taxrate_rate

    }

    $scope.ngcngtaxExempted=function(e){


    if(e == "NO" || e == undefined){
    $scope.showform = false;
    $scope.idsd="N"
    }
        else if(e.metadata_value == "YES"){
    $scope.showform = true;
    $scope.idsd="Y"
    }

    else if(e == "YES"){
    $scope.showform = true;
    $scope.idsd="Y"
    }

    else{
    $scope.showform = false;
     $scope.idsd="N";
    }
    }
function reconname(item) {
        var fileExtension = '.' + item.split('.').pop();
        $scope.recon_name = "TDS-TAXDETAILS" + new Date().getTime() + fileExtension;
    };

    $scope.addtaxdetailsmode=function(e){
       if (e.tds) {
                    $scope.tds_flag = "Y"
                } else {
                    $scope.tds_flag = "N"

                }

    $scope.tax_disabled=true;
    $scope.taxtbranch=e.branch.partnerbranch_code;
    if($scope.taxtbranch=='' || $scope.taxtbranch==undefined || $scope.taxtbranch==null){
    alert("Please select Branch Code");
    $scope.tax_disabled=false;
    return false;
    }
    if(e.ngstaxtype=='' || e.ngstaxtype==undefined || e.ngstaxtype==null){
    alert("Please select Tax Type");
    $scope.tax_disabled=false;
    return false;
    }
<!--    if(e.ngmtaxno=='' || e.ngmtaxno==undefined || e.ngmtaxno==null){-->
<!--    alert("Please select Tax Number");-->
<!--    $scope.tax_disabled=false;-->
<!--    return false;-->
<!--    }-->

    if($scope.tax_showtype=="TDS "){
    if(e.ngistaxrate==""){
    alert("Please select tax Rate");
    $scope.tax_disabled=false;
    return false;
    }
    if(e.ngisexcem==undefined || e.ngisexcem == ""){
    alert("Please select Exempted Type");
    $scope.tax_disabled=false;
    return false;
    }

    }
        if ($scope.add_tax.fdate) {
            $scope.fromdate = formatStringDate($scope.add_tax.fdate, 'yyyy-mm-dd');
        }
        else {
            $scope.fromdate = '';
        }
        if ($scope.add_tax.tdate) {
            $scope.todate = formatStringDate($scope.add_tax.tdate, 'yyyy-mm-dd');
        }
        else {
            $scope.todate = '';
        }
        if ($scope.add_tax.ngthrosold) {
            $scope.throsold = $scope.add_tax.ngthrosold;
        }
        else {
            $scope.throsold = '';
        }
        if ($scope.add_tax.ngmtaxExempted) {
            $scope.taxExempted = $scope.add_tax.ngmtaxExempted;
        }
        else {
            $scope.taxExempted = '';
        }

        if($scope.idsd=="Y"){
        if(e.ngmtaxExempted==""){
    alert("Please Enter Exempted Rate");
     $scope.tax_disabled=false;
    return false;
    }
    if(e.ngthrosold==""){
    alert("Please Enter Excemthrosold");
      $scope.tax_disabled=false;
    return false;
    }
        if ($scope.add_tax.file == undefined) {
            alert("Fill the tax File field!.");
              $scope.tax_disabled=false;
            return false;
        }

        $scope.name = $scope.add_tax.file.name;

        if ($scope.file !== undefined) {
            var excl = new FormData();
            reconname($scope.name);
            excl.append('file',$scope.add_tax.file);
            excl.append('name', $scope.recon_name);
            excl.append('Group', 'TAXINSERTSUMMARYEXEMPTEDYES');
            excl.append('Action','TAX_INSERT');
            excl.append('Tax_Gid', $scope.tgd);
            excl.append('TaxDetails_Partner_Gid',$scope.partner_gid);
            excl.append('TaxDetails_Partnerbranchcode',$scope.taxtbranch);
            excl.append('TaxDetails_Partner_Code',$scope.Partner.partnercode);
            excl.append('TaxDetails_Partner_Type','S');
            excl.append('TaxDetails_TaxNo', $scope.add_tax.ngmtaxno);
            excl.append('TaxDetails_Is_MSME',  $scope.ngpsMSME);
            excl.append('TaxSubDetails_TaxRate_Gid', $scope.trgid);
            excl.append('TaxSubDetails_TaxRate', $scope.trat);
            excl.append('TaxSubDetails_IsExcempted', $scope.idsd);
            excl.append('TaxSubDetails_ExcemFrom', $scope.fromdate);
            excl.append('TaxSubDetails_ExcemTo', $scope.todate);
            excl.append('TaxSubDetails_ExcemthroSold', $scope.throsold);
            excl.append('TaxSubDetails_ExcemRate', $scope.taxExempted);
            excl.append('FileName', $scope.recon_name);
            excl.append('Create_By', $scope.create_by);
            excl.append('Tds', $scope.tds_flag);
            loadexclTax(excl);
        }}else{
            var excl = new FormData();
            $scope.name="";
            reconname($scope.name);
            excl.append('file','');
            excl.append('name', '');
            excl.append('Group', 'TAXINSERTSUMMARYEXEMPTEDNO');
            excl.append('Action','TAX_INSERT');
            excl.append('Tax_Gid', $scope.tgd);
            excl.append('TaxDetails_Partner_Gid',$scope.partner_gid);
            excl.append('TaxDetails_Partnerbranchcode',$scope.taxtbranch);
            excl.append('TaxDetails_Partner_Code',$scope.Partner.partnercode);
            excl.append('TaxDetails_Partner_Type','S');
            excl.append('TaxDetails_TaxNo', $scope.add_tax.ngmtaxno);
            excl.append('TaxSubDetails_TaxRate_Gid', $scope.trgid);
            excl.append('TaxDetails_Is_MSME',  $scope.ngpsMSME);
            excl.append('TaxSubDetails_TaxRate', $scope.trat);
            excl.append('TaxSubDetails_IsExcempted', $scope.idsd);
            excl.append('TaxSubDetails_ExcemFrom',$scope.fromdate);
            excl.append('TaxSubDetails_ExcemTo', $scope.todate);
            excl.append('TaxSubDetails_ExcemthroSold', $scope.throsold);
            excl.append('TaxSubDetails_ExcemRate',$scope.taxExempted);
            excl.append('FileName', "");
            excl.append('Create_By', $scope.create_by);
            excl.append('Tds', $scope.tds_flag);
            loadexclTax(excl);

        }
     }
     function gottaxmsmedetails(query) {
        var result = $filter('filter')($scope.partnertaxdetails, {
            'metadata_value': query
        });
        return result;
    }
    function gottaxmsmedetails(query) {
        var taxdetailsmode = {
            "Table_name":"gal_mst_tmetadata",
            "Column_1":"metadata_gid,metadata_value",
            "Column_2":"",
            "Where_Common":"metadata",
            "Where_Primary":"columnname",
            "Primary_Value":"taxdetails_ismsme",
            "Order_by":"gid",
             "Limits": "0,30",
            "Search_Column": query,
        }
        var taxdetailsval = {
             Action: "",
             Entity_Gid: $scope.entity_gid,
             data: taxdetailsmode
        }
        $scope.partnertaxdetails = [];
        return $http.post(Appname + '/prodget/' , taxdetailsval).then(function(result) {
        console.log(result.data.DATA);
            return result.data.DATA;
          });

    }


    function loadexclTax(excl) {

        $scope.loading();

        var overalldtl = Servicedrctsale.taxinsert(excl);
        overalldtl.then(function(res) {
            var hosmr = [];
            $scope.hosmrw=res.data
            $scope.hosmr = res.data.MESSAGE;

            if ($scope.hosmr == "SUCCESSFULLY INSERTED") {
                alert("SUCCESSFULLY INSERTED!")
                $scope.add_tax.ngpsMSME='',
                $scope.add_tax.ngstaxtype='',
                $scope.add_tax.ngmtaxno='',
                $scope.add_tax.ngistaxrate='',
                $scope.add_tax.ngisexcem='',
                $scope.add_tax.fdate='',
                $scope.add_tax.tdate='',
                $scope.add_tax.ngmtaxExempted='',
                $scope.add_tax.ngthrosold='',
                $scope.file='',
                $scope.tgd='',
                $scope.taxtbranch='',
                modalhide('taxdetailsmodal');
                gettaxdetails();

            } else {
                alert(JSON.stringify($scope.hosmrw));

            }
        }).finally($scope.endloading);
    }
$scope.addtaxpagepopup = function()
    {
    $scope.tax_disabled=false;
     $scope.hidetds = false;
    $scope.tax_true=false;
    $scope.add_tax.tds = '';
    $scope.button_clr=true;
       $scope.add_tax.ngpsMSME="";
       $scope.add_tax.ngstaxtype="";
       $scope.add_tax.ngmtaxno="";
       $scope.add_tax.ngview_paymentdetailsistaxrate="";
       $scope.add_tax.ngisexcem="";
       $scope.add_tax.fdate="";
       $scope.add.tdate="";
       $scope.add_tax.ngmtaxExempted="";
       $scope.add_tax.ngthrosold="";
       $scope.file="";
       $scope.addtax=true;
       $scope.taxupdate=false;
       //tax_partnerbranchname();
       $scope.add_tax.branch="";
       modalshow('taxdetailsmodal');
	}

	$scope.edit_tax_file=function(){
	$scope.showforms=true;
	}

$scope.show_taxdetails=function(e){

    $scope.tax_true=true;
    $scope.button_clr=false;
   //alert(JSON.stringify($scope.showform));
   $scope.tax_gid=e.taxdetails_tax_gid +' '+ '-'+' '+e.taxdetails_subtax_gid;
   $scope.addtax=false;
   $scope.taxupdate=false;
   $scope.tdsview=e.tax_type.split("-");
   $scope.tdsview1=$scope.tdsview[0];
   if(e.taxsubdetails_isexcempted=="NO" && $scope.tdsview1=="TDS " ){
    $scope.tax_show_data=true;
    }
    else{
    $scope.tax_show_data=false;
    }

   if(e.taxsubdetails_isexcempted=="YES"){
   $scope.showform = true;
   $scope.tax_show_data=true;
   $scope.idsd="Y"
   }
   else{
   $scope.idsd="N";
   $scope.showform = false;
   //$scope.tax_show_data = false;
   }
   $scope.add_tax.taxgid=e.taxdetails_gid;
    $scope.add_tax.branch=e.partnerbranch_name,
   $scope.add_tax.ngpsMSME=e.taxdetails_ismsme;
   $scope.add_tax.ngstaxtype=e.tax_type;
   $scope.add_tax.file_path=e.file_path;
   $scope.add_tax.tax_filename=e.file_name;
   $scope.add_tax.ngmtaxno=e.taxdetails_taxno;
   $scope.add_tax.ngistaxrate=e.taxsubdetails_taxrate;
   $scope.add_tax.ngistaxrategid=e.taxsubdetails_taxrate_gid;
   $scope.add_tax.ngisexcem=e.taxsubdetails_isexcempted;
   if (e.taxsubdetails_excemfrom==null)  {
                $scope.add_tax.fdate=null;
            }else
            {
                $scope.add_tax.fdate=new Date(e.taxsubdetails_excemfrom);
            }
   if (e.taxsubdetails_excemto==null)  {
                $scope.add_tax.tdate=null;
            }else
            {
                $scope.add_tax.tdate=new Date(e.taxsubdetails_excemto);
            }
   //$scope.add_tax.fdate=new Date(e.taxsubdetails_excemfrom);
   //$scope.add_tax.tdate=new Date(e.taxsubdetails_excemto);
   $scope.add_tax.ngmtaxExempted=e.taxsubdetails_excemrate;
   $scope.add_tax.ngthrosold=e.taxsubdetails_excemthrosold;
   $scope.file=e.taxsubdetails_isexcempted;
   modalshow('taxdetailsmodal');
   }


$scope.edit_taxdata=function(e){
$scope.hidetds = true;
$scope.refbrach_code=e.taxdetails_reftablecode;
$scope.tax_true=true;
$scope.button_clr=false;
$scope.aa=e.tax_type.split(" - ");
$scope.aa1=$scope.aa[0];
if($scope.aa1 == "GST"){
$scope.tax_show_data=false;
}
if($scope.aa1 != "GST"){
$scope.tax_show_data=true;
}

$scope.tdsview11=e.tax_type.split("-");
   $scope.tdsview111=$scope.tdsview11[0];
   if(e.taxsubdetails_isexcempted=="NO" && $scope.tdsview111=="TDS " ){
    $scope.tax_show_data=true;

    }
    else{
    $scope.tax_show_data=false;
    }
    //alert(JSON.stringify($scope.showform));
   $scope.tax_gid=e.taxdetails_tax_gid +' '+ '-'+' '+e.taxdetails_subtax_gid;
   $scope.addtax=false;
   $scope.taxupdate=true;

   if(e.taxsubdetails_isexcempted=="YES"){
   $scope.showform = true;
   $scope.tax_show_data=true;
   $scope.idsd="Y"
   }
   else{
   $scope.idsd="N";
   $scope.showform = false;
   //$scope.tax_show_data=false;
   }

   $scope.add_tax.taxgid=e.taxdetails_gid;
   $scope.add_tax.branch=e.partnerbranch_name,
   $scope.add_tax.ngpsMSME=e.taxdetails_ismsme;
   $scope.add_tax.ngstaxtype=e.tax_type;
   $scope.add_tax.file_path=e.file_path;
   $scope.add_tax.tax_filename=e.file_name;
   $scope.add_tax.ngmtaxno=e.taxdetails_taxno;
   $scope.add_tax.ngistaxrate=e.taxsubdetails_taxrate;
   $scope.add_tax.ngistaxrategid=e.taxsubdetails_taxrate_gid;
   $scope.add_tax.ngisexcem=e.taxsubdetails_isexcempted;
  if (e.taxsubdetails_excemfrom==null)  {
                $scope.add_tax.fdate=null;
            }else
            {
                $scope.add_tax.fdate=new Date(e.taxsubdetails_excemfrom);
            }
   if (e.taxsubdetails_excemto==null)  {
                $scope.add_tax.tdate=null;
            }else
            {
                $scope.add_tax.tdate=new Date(e.taxsubdetails_excemto);
            }
   $scope.add_tax.ngmtaxExempted=e.taxsubdetails_excemrate;
   $scope.add_tax.ngthrosold=e.taxsubdetails_excemthrosold;
   $scope.file=e.taxsubdetails_isexcempted;
   modalshow('taxdetailsmodal');
   }
$scope.add_tax=[];
$scope.TaxsearchDetails=function(d){

    $scope.as=$scope.add_tax.ngmptaxno;
    gettaxdetails();
}

gettaxdetails();

function gettaxdetails()
    {

        if ($scope.add_tax.ngsstaxtype) {
            $scope.ttaxid = $scope.add_tax.ngsstaxtype.tax_type_gid;
        }
        else {
            $scope.ttaxid = '';
        }
        if ($scope.add_tax.ngmptaxno) {
            $scope.ttaxno = $scope.add_tax.ngmptaxno;
        }
        else {
             $scope.ttaxno = '';
        }

        var data = {
            "Params": {
                "Filter":{
                "TaxDetails_Partner_gid":($scope.partner_gid).toString(),
                "Mst_Table": $scope.msttable,
                },
                "Classification": {
                "Entity_Gid":  $scope.entity_gid
                },
                "Group": "ATMATAXSUMMARY",
                "Action": "Tax_Details_Get",

            }
        }

        var get_data = Servicedrctsale.get_atmataxdetails(data)
        get_data.then(function(result) {
            $scope.get_tax_details=result.data.DATA;
            $scope.searchtaxdetails=$scope.get_tax_details;
            //console.log($scope.alldetails)
           //alert(JSON.stringify($scope.get_tax_details))
        })

    }

    $scope.change_tax=function(e){

        if(e.ngsstaxtype != undefined && e.ngsstaxtype != null && e.ngsstaxtype !='' )
        {
        var temp= e.ngsstaxtype.tax_type;
        }
        else
        {
        var temp='';
        }
        $scope.get_tax_details = $filter('filter')($scope.searchtaxdetails , {
               "taxdetails_taxno": e.ngmptaxno == null || e.ngmptaxno == undefined || e.ngmptaxno == '' ? '' : e.ngmptaxno ,
               "tax_type": temp == null ||  temp == undefined  || temp == '' ? '' : temp
        });
}
    $rootScope.showvtaxdetails = function(ev) {
    $scope.loading();

    modalshow('atma_taxview_page');
    $scope.paymodepop=ev.taxdetails_ismsme
    $scope.bankpop=ev.tax_type
    $scope.branchpop=ev.taxdetails_taxno
    $scope.ifscpop=ev.taxsubdetails_taxrate
    $scope.acctpop=ev.taxsubdetails_isexcempted

    $scope.endloading();

    }

    //TAXEND

    //ACTIVITYSTART

    $scope.gotoactivity = gotoactivity;
    $scope.showpopup_Activity = function() {
    $scope.activity_disabled=false;
    $scope.acti_true=false;
    $scope.addactivityButton = true;
    $scope.editactivityButton = false;
        $scope.Activityadd.actgid="";
        $scope.Activityadd.branch="";
        $scope.Activityadd.activitycode="";
        $scope.Activityadd.activitytype="";
        $scope.Activityadd.activityname="";
        $scope.Activityadd.description="";
        $scope.Activityadd.activitystartdate="";
        $scope.Activityadd.activityenddate="";
        $scope.Activityadd.projectedcontract="";

        $scope.Activityadd.fidelityinsurance="";
        $scope.Activityadd.bidding="";
        $scope.Activityadd.reason="";
        $scope.Activityadd.ngactgrp="";
        $scope.add.prsnname="";
        $scope.add.dsgntn="";
        $scope.add.lndlne="";
        $scope.add.lndlne2="";
        $scope.add.mobno="";
        $scope.add.mobno2="";
        $scope.add.mailid="";
        $scope.add.dobb="";
        $scope.add.weddy="";
<!--        activity_branchname();-->
<!--        $scope.add.cntcttype="";-->
       modalshow('Activity_showpopup');
   }


    function gotoactivity(query) {
        var dat = {
            "Table_name": "gal_mst_tmetadata",
            "Column_1": "metadata_value",
            "Column_2": "",
            "Where_Common": "metadata",
            "Where_Primary": "columnname",
            "Primary_Value": "activity_status",
            "Order_by": "value",
            "Limits": "0,30",
            "Search_Column": query,
        }
        var pact = {
            Action: "",
            Entity_Gid: $scope.entity_gid,
            data: dat
        }

            return $http.post(Appname + '/prodget/' , pact).then(function(result) {
            console.log(result.data.DATA);
                return result.data.DATA;
        });

    }
    var custgrpddl = Servicedrctsale.getcustgrp()
    custgrpddl.then(function(result) {
        $scope.conttype = [];
        $scope.conttype = JSON.parse(result.data);
    }),
    function() {
        alert('No data!.');
    };

    function loaddata1() {
           $scope.designationdetails == [];
           var rolegrouplist = Servicedrctsale.getdesg();
           rolegrouplist.then(function(rolegrouplist) {
                   $scope.designationdetails = JSON.parse(rolegrouplist.data);
               }, function(err) {
                   alert('No data!.');
               })
               .finally();
   };
       loaddata1();

    loadActivityData();

   $scope.edit_activitydata=function(e){
    debugger;
   $scope.acti_true=true;
    if(e.activity_type == "Product"){
    $scope.activitytype1="P";

    }else{
    $scope.activitytype1="S";
    }
    if (e.Contact_DOB){
                $scope.Contact_DOBs =  formatStringDate( new Date(e.Contact_DOB), 'yyyy-mm-dd');
             }
             else
             {
                $scope.Contact_DOBs= null;
             }
     if (e.Contact_WD){
                $scope.Contact_WDs =  formatStringDate( new Date(e.Contact_WD), 'yyyy-mm-dd');
             }
             else
             {
                $scope.Contact_WDs= null;
             }

        $scope.Activityadd=[];
        $scope.addactivityButton = false;
        $scope.editactivityButton = true;
        modalshow('Activity_showpopup');
        $scope.Activityadd.actgid=e.activity_gid;
        $scope.Activityadd.activitycode=e.activity_code;
        $scope.Activityadd.activitytype=$scope.activitytype1;
        $scope.Activityadd.activityname=e.activity_name;
        $scope.Activityadd.description=e.activity_desc;
        $scope.Activityadd.branch=e.partnerbranch_name;
        $scope.Activityadd.activitystartdate=new Date(e.activity_startdate);
        $scope.Activityadd.activityenddate=new Date(e.activity_enddate);
        $scope.Activityadd.projectedcontract=e.activity_projectedspend;
        $scope.Activityadd.actrm=e.employee_name;
        $scope.Activityadd.fidelityinsurance=e.activity_fidiinsur;
        $scope.Activityadd.bidding=e.activity_bidding;
        $scope.Activityadd.reason=e.activity_reason;
        $scope.Activityadd.ngactgrp=e.activity_status;
        $scope.add.prsnname=e.Contact_personname;
        $scope.add.dsgntn=e.Contact_designation_gid;
        $scope.add.lndlne=e.Contact_landline;
        $scope.add.lndlne2=e.Contact_landline2;
        $scope.add.mobno=e.Contact_mobileno;
        $scope.add.mobno2=e.Contact_mobileno2;
        $scope.add.mailid=e.Contact_email;
        $scope.add.cntcttype=e.Contact_contacttype_gid;
        $scope.add.dobb=$scope.Contact_DOBs;
        $scope.add.weddy=$scope.Contact_WDs;
   }

$scope.show_activity=function(e){

    $scope.acti_true=true;
    if(e.activity_type == "Product"){
    $scope.activitytype1="P";

    }else{
    $scope.activitytype1="S";
    }
    if (e.Contact_DOB){
                $scope.Contact_DOBs =  formatStringDate( new Date(e.Contact_DOB), 'yyyy-mm-dd');
             }
             else
             {
                $scope.Contact_DOBs= null;
             }
     if (e.Contact_WD){
                $scope.Contact_WDs =  formatStringDate( new Date(e.Contact_WD), 'yyyy-mm-dd');
             }
             else
             {
                $scope.Contact_WDs= null;
             }

        $scope.Activityadd=[];
        $scope.addactivityButton = false;
        $scope.editactivityButton = false;

        $scope.Activityadd.actgid=e.activity_gid;
        $scope.Activityadd.activitycode=e.activity_code;
        $scope.Activityadd.activitytype=$scope.activitytype1;
        $scope.Activityadd.activityname=e.activity_name;
        $scope.Activityadd.description=e.activity_desc;
        $scope.Activityadd.activitystartdate=new Date(e.activity_startdate);
        $scope.Activityadd.activityenddate=new Date(e.activity_enddate);
        $scope.Activityadd.projectedcontract=e.activity_projectedspend;
        $scope.Activityadd.actrm=e.employee_name;
        $scope.Activityadd.fidelityinsurance=e.activity_fidiinsur;
        $scope.Activityadd.bidding=e.activity_bidding;
        $scope.Activityadd.reason=e.activity_reason;
        $scope.Activityadd.ngactgrp=e.activity_status;
        $scope.Activityadd.branch=e.partnerbranch_name;
        $scope.add.prsnname=e.Contact_personname;
        $scope.add.dsgntn=e.Contact_designation_gid;
        $scope.add.lndlne=e.Contact_landline;
        $scope.add.lndlne2=e.Contact_landline2;
        $scope.add.mobno=e.Contact_mobileno;
        $scope.add.mobno2=e.Contact_mobileno2;
        $scope.add.mailid=e.Contact_email;
        $scope.add.cntcttype=e.Contact_contacttype_gid;
        $scope.add.dobb=$scope.Contact_DOBs;
        $scope.add.weddy=$scope.Contact_WDs;
        modalshow('Activity_showpopup');

   }

    $scope.activitydetailshref=function(e){



<!--    sessionStorage.setItem('activity_details_gid', JSON.stringify(e));-->
<!--    $window.location.href="atma_activitydetails";-->
    //alert(e);
    }

    //to Save edited data
   $scope.activitysummaryedit=function(){

       var data = {
           "Params": {
               "Activity_Gid": $scope.Activityadd.actgid,
               "Activity_Partnergid":$scope.partner_gid,
               "Activity_PartnerCode":$scope.Partner.partnercode,
               "Activity_partnerbranchgid":$scope.Activityadd.branch.partnerbranch_gid,
               "Activity_Type": $scope.Activityadd.activitytype,
               "Activity_Name": $scope.Activityadd.activityname,
               "Activity_Desc": $scope.Activityadd.description,
               "Activity_Code":$scope.Activityadd.activitycode,
               "Activity_StartDate":formatStringDate($scope.Activityadd.activitystartdate, 'yyyy-mm-dd'),
               "Activity_EndDate":formatStringDate($scope.Activityadd.activityenddate, 'yyyy-mm-dd'),
               "Activity_ProjectedSpend": ($scope.Activityadd.projectedcontract).toString(),
               "Activity_rm":$scope.Activityadd.actrm.employee_gid,
               "Activity_FidiInsur":$scope.Activityadd.fidelityinsurance,
               "Activity_Bidding":$scope.Activityadd.bidding,
               "Activity_Reason":$scope.Activityadd.reason,
               "Activity_Status": $scope.Activityadd.ngactgrp,
               "Contact_ContactType_Gid": $scope.add.cntcttype,
               "Contact_PersonName": $scope.add.prsnname,
               "Contact_Designation_Gid":$scope.add.dsgntn,
               "Contact_LandLine":$scope.add.lndlne,
               "Contact_LandLine2":$scope.add.lndlne2,
               "Contact_MobileNo":$scope.add.mobno,
               "Contact_MobileNo2":$scope. add.mobno,
               "Contact_Email":$scope.add.mailid,
               "Contact_DOB":$scope. add.dobb,
               "Contact_WD":$scope.add.weddy
           },
           "Classification": {
               "Update_By": $scope.entity_gid,
           },
       }
       var details = {
           Group: 'Activity_UPDATE',
           Action: 'ACTIVITY_UPDATE',
           Type:'ACTIVITY_UPDATE',
           data: data,
       }
       $scope.loading();
       var update_actgrp = Servicedrctsale.updateactgrp(details)
       update_actgrp.then(function(result) {
               $scope.actupdate_group = result.data.MESSAGE;
               if($scope.actupdate_group=="SUCCESS"){
               alert($scope.actupdate_group);
                modalhide('Activity_showpopup');
                loadActivityData();
               }else{
               alert(JSON.stringify($scope.actupdate_group));
               }

           }),
           function(err) {
               alert('no data');
           }.finally($scope.endloading());
   }

$scope.searchActivitydata=function(){
    loadActivityData();
}

function loadActivityData() {
    var filter={};
       if ($scope.Activityadd.Search_activitytype) {
           filter['Activity_Type'] = $scope.Activityadd.Search_activitytype
       } else {
           filter['Activity_Type'] = '';
       }
       if ($scope.Activityadd.Search_activityname) {
           filter['Activity_Name'] = $scope.Activityadd.Search_activityname
       } else {
           filter['Activity_Name'] = '';
       }
       if ($scope.Activityadd.Search_description) {
           filter['Activity_Desc'] = $scope.Activityadd.Search_description
       } else {
           filter['Activity_Desc'] = '';
       }
       if ($scope.Activityadd.Searchselectedemp) {
           filter['Activity_Rm'] = $scope.Activityadd.Searchselectedemp.employee_gid
       } else {
          filter['Activity_Rm']= '';
       }
       filter['Activity_Partnergid']= $scope.partner_gid,
       filter['Mst_Table']= $scope.msttable

       var data = {
           "Params": {
               "Filter": filter,
               "Classification":
               {
                   "Entity_Gid": $scope.entity_gid
               }
           }
       }
       var dtam = {
           Group: 'Activity_Group',
           Type: 'Activity_Get',
           data: data
       }
       $scope.getActivitySummary = [];
       var getActivitySummary = Servicedrctsale.getdattam(dtam)
       getActivitySummary.then(function(result) {

            //alert(JSON.stringify(result.data));
           $scope.getActivitySummary = result.data.DATA;
           $scope.searchActivitySummary = $scope.getActivitySummary;
           $scope.pageLength1 = $scope.getActivitySummary.length
           //alert(JSON.stringify($scope.getActivitySummary))
           //$scope.load = $scope.getActivitySummary
           //$scope.pageLength = $scope.getActivitySummary.length;
       }, function(err) {
           alert('No data!.');
       }).finally();
   }

$scope.search_activity=function(a){

if(a.Searchselectedemp != undefined && a.Searchselectedemp != null && a.Searchselectedemp !='' )
        {
        var activitytemp=a.Searchselectedemp.employee_name;
        }
    else
        {
        var activitytemp='';
        }
        $scope.getActivitySummary = $filter('filter')($scope.searchActivitySummary , {
               "employee_name": activitytemp == null || activitytemp == undefined || activitytemp == '' ? '' : activitytemp,
                "activity_name": a.Search_activityname == null ||  a.Search_activityname == undefined ||  a.Search_activityname == '' ? '' :  a.Search_activityname,

        });

}


$scope.activitysummarysave = function(Activityadd) {
$scope.activity_disabled=true;
       var data = {
           "Params": {
               "Activity_Partnergid":$scope.partner_gid,
               "Activity_PartnerCode":$scope.Partner.partnercode,
               "Activity_partnerbranchgid":Activityadd.branch.partnerbranch_gid,
               "Activity_Type": Activityadd.activitytype,
               "Activity_Name": Activityadd.activityname,
               "Activity_Desc": Activityadd.description,
               "Activity_Code": Activityadd.activitycode,
               "Activity_StartDate": Activityadd.activitystartdate,
               "Activity_EndDate": Activityadd.activityenddate,
               "Activity_ProjectedSpend": Activityadd.projectedcontract,
               "Activity_rm": $scope.partner_rm_gid,
               "Activity_FidiInsur": Activityadd.fidelityinsurance,
               "Activity_Bidding": Activityadd.bidding,
               "Activity_Reason": Activityadd.reason,
               "Activity_Status": Activityadd.ngactgrp.metadata_value,
               "Create_By": $scope.create_by,
               "Contact_ContactType_Gid": $scope.add.cntcttype,
               "Contact_PersonName": $scope.add.prsnname,
               "Contact_Designation_Gid": $scope.add.dsgntn,
               "Contact_LandLine": $scope.add.lndlne,
               "Contact_LandLine2": $scope.add.lndlne2,
               "Contact_MobileNo": $scope.add.mobno,
               "Contact_MobileNo2": $scope.add.mobno2,
               "Contact_Email": $scope.add.mailid,
               "Contact_DOB": $scope.add.dobb,
               "Contact_WD": $scope.add.weddy
           },
           "Classification": {
               "Update_By":detail.employee_gid,
               "Entity_Gid": $scope.entity_gid,
           },
       }
       var details = {
           Group: 'Activity_ADD',
           Action: 'Activity_Insert',
           Type: 'Activity_Group',
           data: data,
       }
       $scope.loading();
       var set_actgrp = Servicedrctsale.ActivityaddService(details)
       set_actgrp.then(function(result) {
               $scope.actgroup = result.data.MESSAGE;
               //alert(JSON.stringify($scope.actgroup));
               if($scope.actgroup =="SUCCESSFULLY INSERTED"){
               alert(JSON.stringify($scope.actgroup));
                $scope.activity_disabled=false;
              // $scope.activityform.$setPristine();
               modalhide('Activity_showpopup');
               loadActivityData();
               }
               else{
               alert(JSON.stringify($scope.actgroup))
              $scope.activity_disabled=false;
               }
           }),
           function(err) {
               alert('no data');
           }.finally($scope.endloading());
   }

   $scope.values=true;
//ACTIVITYEND

//ClientDetails Start Page...!
$scope.addclient=[];
$scope.ClientDetailspopup=function(){
$scope.client_disabled=false;
  $scope.clientsubmit=true;
        $scope.clientupdate=false;
$scope.add.name="",
$scope.add.addline="",
$scope.add.addline2="",
$scope.add.addline3="",
$scope.add.addselectedstate="",
$scope.add.addselecteddistrict="",
$scope.add.addselectedcity="",
$scope.add.pincode1="",
modalshow('ClientAddPopup')

}
var eaddrsttddl = Servicedrctsale.getstateddl()
        eaddrsttddl.then(function(result) {
                $scope.stateddl = [];
                $scope.stateddl = JSON.parse(result.data);
            }),
            function() {
                alert('No data!.');
            };

$scope.state_clk = function(state_gid, type) {

            $scope.client_stategid=state_gid;
            var distddl = Servicedrctsale.getdistddl(state_gid)
            distddl.then(function(result) {
                        $scope.adistrictddl = JSON.parse(result.data);

                }),
                function() {
                    alert('No data!.');
                };
        };

 $scope.state_clk_partner = function(state_gid, type) {

            $scope.client_stategid=state_gid;
            var distddl = Servicedrctsale.getdistddl(state_gid)
            distddl.then(function(result) {
                        $scope.adistrictddl = JSON.parse(result.data);

                }),
                function() {
                    alert('No data!.');
                };
        };

        $scope.district_clk = function(district_gid, type) {

        if(type == "address"){
        $scope.client_districtgid=district_gid;
        }else{
         $scope.client_districtgid="";
        }
            var ctyddl = Servicedrctsale.getcityddl(district_gid)
            ctyddl.then(function(result) {
                    if (type == 'address') {
                        $scope.acity1 = [];
                        $scope.acity1 = JSON.parse(result.data);
                    } else {
                        $scope.city1 = [];
                        $scope.city1 = JSON.parse(result.data);
                    }
                }),
                function() {
                    alert('No data!.');
                };
        };


  $scope.district_clk_partner = function(district_gid, type) {

        if(type == "address"){
        $scope.client_districtgid=district_gid;
        }else{
         $scope.client_districtgid="";
        }
            var ctyddl = Servicedrctsale.getcityddl(district_gid)
            ctyddl.then(function(result) {
                    if (type == 'address') {
                        $scope.acity1 = [];
                        $scope.acity1 = JSON.parse(result.data);
                    } else {
                        $scope.city1 = [];
                        $scope.city1 = JSON.parse(result.data);
                    }
                }),
                function() {
                    alert('No data!.');
                };
        };
$scope.pinchange = function(pincode, type) {
if(pincode!=""){
            var pincd = Servicedrctsale.getpincodeall(pincode)
            pincd.then(function(result) {
                    if (type == 'address') {
                        var apincde = [];
                        apincde = JSON.parse(result.data);
                        $scope.add.addselectedstate = apincde[0].city_state_gid;
                        $scope.state_clk($scope.add.addselectedstate, 'address');
                        $scope.add.addselecteddistrict = apincde[0].pincode_district_gid;
                        $scope.district_clk($scope.add.addselecteddistrict, 'address');
                        $scope.add.addselectedcity = apincde[0].pincode_City_gid;
                        $scope.add.pincode1 = apincde[0].pincode_no;
                    }
                }),
                function() {
                    alert('No data!.');
                };
                }
        };
$scope.pinchange_partner = function(pincode, type) {

            var pincd = Servicedrctsale.getpincodeall(pincode)
            pincd.then(function(result) {
                    if (type == 'address') {
                        var apincde = [];
                        apincde = JSON.parse(result.data);
                        $scope.add.addselectedstate11 = apincde[0].city_state_gid;
                        $scope.state_clk($scope.add.addselectedstate11, 'address');
                        $scope.add.addselecteddistrict11 = apincde[0].pincode_district_gid;
                        $scope.district_clk($scope.add.addselecteddistrict11, 'address');
                        $scope.add.addselectedcity11 = apincde[0].pincode_City_gid;
                        $scope.add.pincode111 = apincde[0].pincode_no;
                    }
                }),
                function() {
                    alert('No data!.');
                };
        };


$scope.city_clk = function(city_gid, type) {

            $scope.client_citygid=city_gid;
            var pincd = Servicedrctsale.getpincode(city_gid)
            pincd.then(function(result) {
                    if (type == 'address') {
                        var apincde = [];
                        apincde = JSON.parse(result.data);
                        $scope.add.pincode1 = apincde[0].pincode_no;
                    } else {
                        var pincde = [];
                        pincde = JSON.parse(result.data);
                        $scope.pcode = pincde[0].pincode_no;
                    }
                }),
                function() {
                    alert('No data!.');
                };
        };

    $scope.city_clk_partner = function(city_gid, type) {

            $scope.client_citygid=city_gid;
            var pincd = Servicedrctsale.getpincode(city_gid)
            pincd.then(function(result) {
                    if (type == 'address') {
                        var apincde = [];
                        apincde = JSON.parse(result.data);
                        $scope.add.pincode111 = apincde[0].pincode_no;
                    } else {
                        var pincde = [];
                        pincde = JSON.parse(result.data);
                        $scope.pcode = pincde[0].pincode_no;
                    }
                }),
                function() {
                    alert('No data!.');
                };
        };

        $scope.addclientdetails=function(e){

$scope.client_disabled=true;
        if(e==undefined){
        $scope.client_addline="";
        $scope.client_addline2="";
        $scope.client_addline3="";
        }else{
         $scope.client_addline=e.addline;
        $scope.client_addline2=e.addline2;
        $scope.client_addline3=e.addline3;
        }
        if(e.name==''){
        alert("Please Enter Client Name");
        $scope.client_disabled=false;
        return false;
        }
        if(e.addselectedstate==''){
alert("Please Select State");
$scope.client_disabled=false;
return false;
}if(e.addselecteddistrict==''){
alert("Please Select District ");
$scope.client_disabled=false;
return false;
}if(e.addselectedcity==''){
alert("Please Select City");
$scope.client_disabled=false;
return false;
}if(e.pincode1==''){
alert("Please Enter Pincode");
$scope.client_disabled=false;
return false;
}
            var data = {
                "Params": {
                    "Partnerclient_Partnergid": $scope.partner_gid,
                    "Address_1":$scope.client_addline,
                    "Address_2": $scope.client_addline2,
                   "Address_3": $scope.client_addline3,
                   "Address_Pincode": e.pincode1,
                   "Address_District_gid":e.addselecteddistrict,
                   "Address_City_gid": e.addselectedcity,
                   "Address_State_gid": $scope.client_stategid,
                   "Partnerclient_Name": e.name,

                },
                "Classification": {
                    "Create_By":detail.employee_gid,
                    "Entity_Gid": $scope.entity_gid,
                },
            }
            var details = {
               Group: 'ClientDetails_ADD',
               Action: 'INSERT',
               Type:"",
               data: data,
            }
            $scope.loading();
                var set_clientdetails = Servicedrctsale.clientaddService(details)
                set_clientdetails.then(function(result) {
                    $scope.clientgroup = result.data.MESSAGE;
                    if( $scope.clientgroup=="SUCCESS"){
                    alert("SUCCESSFULLY INSERTED");
                    modalhide('ClientAddPopup');
                    $scope.add.name="",
                    $scope.add.addline="",
                    $scope.add.addline2="",
                    $scope.add.addline3="",
                    $scope.add.addselectedstate="",
                    $scope.add.addselecteddistrict="",
                    $scope.add.addselectedcity="",
                    $scope.add.pincode1="",
                    getclient_details();

                    }
                    else{
                    alert(JSON.stringify($scope.clientgroup));
                    $scope.client_disabled=false;
                     modalshow('ClientAddPopup')
                    }


                }),
            function(err) {
                alert('no data');
            }.finally($scope.endloading());
        }
        getclient_details();
        function getclient_details(){
        var data = {
                "Params": {
                    "Partnerclient_Partnergid":$scope.partner_gid,
                    "Mst_Table": $scope.msttable,
                },
                "Classification": {
                    "Entity_Gid": $scope.entity_gid,
                },
            }
            var details = {
               Group: 'ClientDetails_GET',
               Action: 'Partnerclient_Get',
               Type:"",
               data: data,
            }
                var get_clientdetails = Servicedrctsale.clientgetService(details)
                get_clientdetails.then(function(result) {
                    $scope.clientgetgroup = result.data.DATA;
                    $scope.clientgropename=$scope.clientgetgroup;

                }),
            function(err) {
                alert('no data');
            };

        }
     $scope.change_clientname=function(e){

        $scope.clientgetgroup = $filter('filter')($scope.clientgropename , {
               "partnerclient_name": e.name

        });
        }

        $scope.client_edit_data=function(e){
        modalshow('ClientAddPopup')
        $scope.clientsubmit=false;
        $scope.clientupdate=true;
            $scope.clientgid=e.partnerclient_gid,
            $scope.add.name=e.partnerclient_name,
            $scope.add.addline=e.address_1,
            $scope.add.addline2=e.address_2,
            $scope.add.addline3=e.address_3,
            $scope.add.addselectedstate=e.address_state_gid,
            $scope.state_clk(e.address_state_gid,'address');
            $scope.add.addselecteddistrict = e.address_district_gid;
            $scope.district_clk(e.address_district_gid,'address')
            $scope.add.addselectedcity=e.address_city_gid,
            $scope.add.pincode1=e.address_pincode
        }
        $scope.view_clientdetails=function(e){
        modalshow('ClientAddPopup')
        $scope.clientsubmit=false;
        $scope.clientupdate=false;



            $scope.clientgid=e.partnerclient_gid,
            $scope.add.name=e.partnerclient_name,
            $scope.add.addline=e.address_1,
            $scope.add.addline2=e.address_2,
            $scope.add.addline3=e.address_3,
            $scope.add.addselectedstate=e.address_state_gid,
            $scope.state_clk(e.address_state_gid,'address');
            $scope.add.addselecteddistrict = e.address_district_gid;
            $scope.district_clk(e.address_district_gid,'address')
            $scope.add.addselectedcity=e.address_city_gid,
            $scope.add.pincode1=e.address_pincode
        }
    $scope.updateclientdetails=function(e){

    if( $scope.client_stategid){
    $scope.update_stategid= $scope.client_stategid;
    }
    else{
      $scope.update_stategid=$scope.add.addselectedstate;
    }
    if( $scope.client_districtgid){
    $scope.update_districtgid= $scope.client_districtgid;
    }
    else{
       $scope.update_districtgid=$scope.add.addselecteddistrict
    }
    if($scope.client_citygid){
     $scope.update_citygid=  $scope.client_citygid
    }
    else{
    $scope.update_citygid=  $scope.add.addselectedcity
    }

        var data = {
                "Params": {
                    "Partnerclient_Gid":$scope.clientgid,
                    "Address_1":$scope.add.addline,
                    "Address_2":$scope.add.addline2,
                    "Address_3":$scope.add.addline3,
                    "Address_Pincode":$scope.add.pincode1,
                    "Address_District_gid":  $scope.update_districtgid,
                    "Address_City_gid":$scope.update_citygid,
                    "Address_State_gid": $scope.update_stategid,
                    "Partnerclient_Name":$scope.add.name
                },
                "Classification": {
                   "Update_By":$scope.create_by,
                },
        }
            var details = {
               Group: 'ClientDetails_Update',
               Action: 'UPDATE',
               Type:"",
               data: data,
            }
            $scope.loading();
                var update_clientdetails = Servicedrctsale.clientupdateService(details)
                update_clientdetails.then(function(result) {
                    $scope.clientgetgroup = result.data;
                    if($scope.clientgetgroup=="SUCCESS"){
                    alert("SUCCESSFULLY UPDATED");
                    getclient_details();
                    modalhide('ClientAddPopup')
                    }else{
                    alert(JSON.stringify($scope.clientgetgroup));
                    getclient_details();
                    modalshow('ClientAddPopup')
                    }
                }),
            function(err) {
                alert('no data');
            }.finally($scope.endloading());

    }

//ClientDetails End Page...!

//ContractDetails Start Page...!
$scope.addcontract=[];
$scope.addcontractpagepopup=function(){
$scope.contract_disabled=false;
$scope.addcontracts=true;
 $scope.editcontract=false;
 $scope.truefalse =false,
  $scope.addcontract.code="",
 $scope.addcontract.name="",
 $scope.addcontract.service="",
 $scope.addcontract.remarks="",
 modalshow('ContractAddPopup')

}
$scope.updatecontract=function(e){

    var data = {
        "Params": {
            "Partnercontractor_Gid":$scope.partnercontractgid,
             "Partnercontractor_Name":$scope.addcontract.name,
             "Partnercontractor_Service":$scope.addcontract.service,
            "Partnercontractor_Remarks":$scope.addcontract.remarks,

                },
                "Classification": {
                   "Update_By":$scope.create_by,
                },
        }
            var details = {
               Group: 'ContractDetails_Update',
               Action: 'UPDATE',
               Type:"",
               data: data,
            }
                var update_contractdetails = Servicedrctsale.contractupdateService(details)
                update_contractdetails.then(function(result) {
                    $scope.contractgroup = result.data;

                    if($scope.contractgroup=="SUCCESS"){
                    alert("SUCCESSFULLY UPDATED");
                    getcontractdetails();
                    modalhide('ContractAddPopup')
                    }else{
                    alert(JSON.stringify($scope.contractgroup));
                    modalshow('ContractAddPopup')
                    }



                }),
            function(err) {
                alert('no data');
            };

}

$scope.addpartnercontract=function(e){
$scope.contract_disabled=true;
        var data = {
                "Params": {
                    "Partnercontractor_Partnergid":$scope.partner_gid,
                    "Partnercontractor_Code":e.code,
                    "Partnercontractor_Name":e.name,
                    "Partnercontractor_Service":e.service,
                    "Partnercontractor_Remarks":e.remarks,

                },
                "Classification": {
                   "Create_By":$scope.create_by,
                    "Entity_Gid": $scope.entity_gid,
                },
        }
        var details = {
               Group: 'ContractDetails_SET',
               Action: 'INSERT',
               Type:"",
               data: data,
        }
        $scope.loading();
                var set_contractdetails = Servicedrctsale.contractsetService(details)
                set_contractdetails.then(function(result) {
                    $scope.clientgetgroup = result.data.MESSAGE;
                    if( $scope.clientgetgroup == "SUCCESS"){
                    alert("SUCCESSFULLY INSERTED");
                    $scope.contract_disabled=false;
                    $scope.addcontract.code="";
                    $scope.addcontract.name="";
                    $scope.addcontract.service="";
                    $scope.addcontract.remarks="";
                    modalhide('ContractAddPopup');
                    getcontractdetails();
                    }else{
                    alert(JSON.stringify($scope.clientgetgroup))
                    $scope.contract_disabled=false;
                         modalshow('ContractAddPopup')
                    }

                }),
            function(err) {
                alert('no data');
            }.finally($scope.endloading());

}
getcontractdetails();
function getcontractdetails(){

        var data = {
                "Params": {
                "Partnercontractor_Partnergid":$scope.partner_gid,
                "Mst_Table": $scope.msttable,
                },
                "Classification": {

                    "Entity_Gid": $scope.entity_gid,
                },
        }
        var details = {
               Group: 'ContractDetails_GET',
               Action: 'Partnercontractor_Get',
               Type:"",
               data: data,
        }
                var GET_contractdetails = Servicedrctsale.contractgetService(details)
                GET_contractdetails.then(function(result) {
                    $scope.contractgetgroup = result.data.DATA;
                    $scope.searchcontractdetails=$scope.contractgetgroup;
                    //alert(JSON.stringify($scope.contractgetgroup))


                }),
            function(err) {
                alert('no data');
            };

}

$scope.contractchange=function(e){

        $scope.contractgetgroup = $filter('filter')($scope.searchcontractdetails , {
               "partnercontractor_code": e.code,
               "partnercontractor_name": e.name,
               "partnercontractor_service": e.service,
               "partnercontractor_remarks": e.remarks

        });
        }

 $scope.contractedit_data=function(e){

 $scope.partnercontractgid=e.partnercontractor_gid;
 $scope.addcontracts=false;
 $scope.editcontract=true;
  $scope.truefalse = true;
 $scope.addcontract.code=e.partnercontractor_code;
 $scope.addcontract.name=e.partnercontractor_name;
 $scope.addcontract.service=e.partnercontractor_service;
 $scope.addcontract.remarks=e.partnercontractor_remarks;
 modalshow('ContractAddPopup')

 }


//ContractDetails End Page...!

//Branch Details Start Page...!
$scope.addbranchpagepopup=function(){
$scope.branch_disabled=false;
$scope.showbranchsubmit=true;
$scope.showbranchupdate=false;
 $scope.add.addline="";
                    $scope.add.addline2="";
                    $scope.add.pincode1="";
                    $scope.add.addline3="";
                    $scope.add.addselectedstate="";
                    $scope.add.addselecteddistrict="";
                    $scope.add.addselectedcity="";
                    $scope.add.cntcttype="";
                    $scope.add.prsnname="";
                    $scope.add.dsgntn="";
                    $scope.add.lndlne="";
                    $scope.add.lndlne2="";
                    $scope.add.mobno="";
                    $scope.add.mobno2="";
                    $scope.add.mailid="";
                    $scope.add.dobb="";
                    $scope.add.weddy="";
                    $scope.add.branchcode="";
                    $scope.add.branchname="";
                    $scope.add.branchremarks="";
                    $scope.add.creditlimitdays="";
                    $scope.add.creditterms="";
                    $scope.add.branc_gstno="";
                    $scope.add.branchpanno="";
modalshow('BranchAddPopup')
}

$scope.addbranchdetails=function(a){

$scope.branch_disabled=true;

    if($scope.add.branchname ==  undefined || $scope.add.branchname ==  '' ){
         alert('Please Enter Branch Name');
         $scope.branch_disabled=false;
            return false;
    }
    if($scope.add.creditlimitdays ==  undefined || $scope.add.creditlimitdays ==  '' ){
         alert('Please Enter CreditLimit Days');
         $scope.branch_disabled=false;
            return false;
    }
    if($scope.add.creditlimitdays >=120){
    alert('CreditLimit Days Should be lessthan 120 days');
    $scope.branch_disabled=false;
    return false;
    }
<!--var regularexp1=/[0-9]{2}[a-zA-Z]{5}[0-9]{4}[a-zA-Z]{1}[1-9A-Za-z]{1}[Z]{1}[0-9a-zA-Z]{1}/;-->
<!--if(regularexp1.test($scope.add.branc_gstno)== true){-->
<!--}else {-->
<!--alert("Please Enter Valid Gst Number");-->
<!--$scope.branch_disabled=false;-->
<!--   return false;-->
<!--}-->
<!--var regularexp=/^[A-Z]{5}[0-9]{4}[A-Z]{1}$/;-->
<!--if(regularexp.test($scope.add.branchpanno)== true){-->

<!--}else {-->
<!--alert("Please Enter Valid Pan Number");-->
<!--$scope.branch_disabled=false;-->
<!--   return false;-->
<!--}-->
if($scope.Partner.compositevendor != 'UnRegistered'){
var gst_num = $scope.add.branc_gstno;
var gst_num = gst_num.slice(2, 12);
if(gst_num != $scope.add.branchpanno){
alert('You Have entered PAN which is not registered with GST')
return false;
}
}

if(($scope.Partner.compositevendor == 'UnRegistered')&&($scope.add.branc_gstno!="")&&($scope.add.branchpanno!="")){
var gst_num = $scope.add.branc_gstno;
var gst_num = gst_num.slice(2, 12);
if(gst_num != $scope.add.branchpanno){
alert('You Have entered PAN which is not registered with GST')
return false;
}
}


if(($scope.Partner.compositevendor != 'UnRegistered')&&($scope.add.branchpanno=="")){
if(($scope.panvalidresult=="FAILD") ||($scope.panvalidresult== undefined)){
alert("Please Enter Valid Pan Number");
$scope.branch_disabled=false;
   return false;
}
}

if(($scope.Partner.compositevendor == 'UnRegistered')&&($scope.add.branchpanno!="")){
if($scope.panvalidresult=="FAILD"){
alert("Please Enter Valid Pan Number");
$scope.branch_disabled=false;
   return false;
}
}
if(($scope.Partner.compositevendor != 'UnRegistered')&&($scope.add.branc_gstno=="")){
if(($scope.gstvalidresult=="FAILD")|| ($scope.gstvalidresult==undefined)){
alert("Please Enter Valid Gst Number");
$scope.branch_disabled=false;
   return false;
}
}

if(($scope.Partner.compositevendor == 'UnRegistered')&&($scope.add.branc_gstno!="")){
if($scope.gstvalidresult=="FAILD"){
alert("Please Enter Valid Gst Number");
$scope.branch_disabled=false;
   return false;
}
}
if(a.addselectedstate==''){
alert("Please Select State");
$scope.branch_disabled=false;
return false;
}if(a.addselecteddistrict==''){
alert("Please Select District ");
$scope.branch_disabled=false;
return false;
}if(a.addselectedcity==''){
alert("Please Select City");
$scope.branch_disabled=false;
return false;
}if(a.pincode1==''){
alert("Please Enter Pincode");
$scope.branch_disabled=false;
return false;
}
 var data = {
                "Params": {
                    "PartnerBranch_Partner_Gid":$scope.partner_gid,
                    "Address_1":$scope.add.addline,
                    "Address_2":$scope.add.addline2,
                    "Address_Pincode":$scope.add.pincode1,
                    "Address_3":$scope.add.addline3,
                    "Address_State_Gid":$scope.client_stategid,
                    "Address_District_Gid":a.addselecteddistrict,
                    "Address_City_Gid": a.addselectedcity,
                    "Contact_ContactType_Gid": $scope.add.cntcttype,
                    "Contact_PersonName":$scope.add.prsnname,
                    "Contact_Designation_Gid":$scope.add.dsgntn,
                    "Contact_LandLine": $scope.add.lndlne,
                    "Contact_LandLine2":$scope.add.lndlne2,
                    "Contact_MobileNo": $scope.add.mobno,
                    "Contact_MobileNo2":$scope.add.mobno2,
                    "Contact_Email": $scope.add.mailid,
                    "Contact_DOB":$scope.add.dobb,
                    "Contact_WD":$scope.add.weddy,
                    "PartnerBranch_Code":$scope.add.branchcode,
                    "PartnerBranch_Name":$scope.add.branchname,
                    "PartnerBranch_Remarks":$scope.add.branchremarks,
                    "CreditLimit_Terms":$scope.add.creditterms,
                    "CreditLimit_Days":$scope.add.creditlimitdays,
                    "partnerbranch_gstno":$scope.add.branc_gstno,
                    "partnerbranch_panno":$scope.add.branchpanno,

                },
                "Classification": {
                   "Entity_Gid":$scope.entity_gid,
                   "Create_By":$scope.create_by,
                },
        }
            var details = {
               Group: 'BranchDetails_Set',
               Action: 'Atma_Branch_Insert',
               Type:"",
               data: data,
            }
                $scope.loading();
                var set_branchdetails = Servicedrctsale.branchsetService(details)
                set_branchdetails.then(function(result) {

                    $scope.branchgetgroup = result.data.MESSAGE;
                    if($scope.branchgetgroup=="SUCCESS"){
                    alert("SUCCESSFULLY INSERTED");
                    $scope.add.addline="";
                    $scope.add.addline2="";
                    $scope.add.pincode1="";
                    $scope.add.addline3="";
                    $scope.add.addselectedstate="";
                    $scope.add.addselecteddistrict="";
                    $scope.add.addselectedcity="";
                    $scope.add.cntcttype="";
                    $scope.add.prsnname="";
                    $scope.add.dsgntn="";
                    $scope.add.lndlne="";
                    $scope.add.lndlne2="";
                    $scope.add.mobno="";
                    $scope.add.mobno2="";
                    $scope.add.mailid="";
                    $scope.add.dobb="";
                    $scope.add.weddy="";
                    $scope.add.branchcode="";
                    $scope.add.branchname="";
                    $scope.add.branchremarks="";
                    $scope.add.creditlimitdays="";
                    $scope.add.creditterms="";
                    $scope.add.branc_gstno="";
                    $scope.add.partnerbranch_panno="";
                    modalhide('BranchAddPopup')
                    getbranchdetails();
                    }else{
                    alert($scope.branchgetgroup);
                    getbranchdetails();
                    $scope.branch_disabled=false;
                    modalshow('BranchAddPopup')
                    }
                }),
            function(err) {
                alert('no data');
            }.finally($scope.endloading());

}


getbranchdetails();
function getbranchdetails(){


        var data = {
                "Params": {
                    "Branch_PartnerGid":$scope.partner_gid,
                    "Mst_Table": $scope.msttable,
                },
                "Classification": {

                    "Entity_Gid": $scope.entity_gid,
                },
        }
        var details = {
               Group: 'BranchDetails_GET',
               Action: 'Atma_Branch_Get',
               Type:"",
               data: data,
        }
            $scope.branchgetgroup_get = {}

                var GET_branchdetails = Servicedrctsale.branchgetService(details)
                GET_branchdetails.then(function(result) {
                 $scope.branchgetgroup_get = []

                   if(result.data.DATA != undefined){
                       $scope.branchgetgroup_get =result.data.DATA;

                   }else{
                         $scope.branchgetgroup_get = []
                   }
                    //$scope.branchgetgroup_get1 = result.data.MESSAGE;
                    //$scope.d=JSON.stringify($scope.branchgetgroup_get1);
                    //alert($scope.d);
                    $scope.searchbranchdetails=$scope.branchgetgroup_get;
                    //alert(JSON.stringify($scope.branchgetgroup_get));
                    $scope.branchgetgroup_get1 =$scope.branchgetgroup_get.length;
                       //alert(JSON.stringify($scope.branchgetgroup_get1));



                }),
            function(err) {
                alert('no data');
            };

}

$scope.change_branch=function(e){

        $scope.branchgetgroup_get = $filter('filter')($scope.searchbranchdetails , {
               "partnerbranch_code": e.code,
               "partnerbranch_name": e.name

        });
}
$scope.branchtedit_data=function(e){
$scope.showbranchsubmit=false;
$scope.showbranchupdate=true;
        $scope.partnerbranch_Gid=e.partnerbranch_gid;
        $scope.add.addline=e.address_1;
        $scope.add.addline2=e.address_2;
        $scope.add.pincode1=e.address_pincode;
        $scope.add.addline3=e.address_3;
        $scope.add.addselectedstate=e.address_state_gid;
        $scope.add.addselectedstate=e.address_state_gid,
        $scope.state_clk(e.address_state_gid,'address');
        $scope.add.addselecteddistrict = e.address_district_gid;
        $scope.district_clk(e.address_district_gid,'address'),
         $scope.add.addselectedcity=e.address_city_gid,
        $scope.add.cntcttype=e.Contact_contacttype_gid;
        $scope.add.prsnname=e.Contact_personname;
        $scope.add.dsgntn=e.Contact_designation_gid;
        $scope.add.lndlne=e.Contact_landline;
        $scope.add.lndlne2=e.Contact_landline2;
        $scope.add.mobno=e.Contact_mobileno;
        $scope.add.mobno2=e.Contact_mobileno2;
        $scope.add.mailid=e.Contact_email;
        $scope.add.creditlimitdays=e.partnerbranch_creditperiod;
        $scope.add.creditterms=e.partnerbranch_paymentterms;
        $scope.add.branc_gstno=e.partnerbranch_gstno;
        $scope.add.branchpanno=e.partnerbranch_panno;
        if (e.Contact_DOB==null)  {
            $scope.add.dobb=null;
        }else
        {
            $scope.add.dobb=new Date(e.Contact_DOB);
        }
        if (e.Contact_WD==null)
        {
            $scope.add.weddy=null;
        }
        else
        {
            $scope.add.weddy=new Date(e.Contact_WD);
        }

        $scope.add.branchcode=e.partnerbranch_code;
        $scope.add.branchname=e.partnerbranch_name;
        $scope.add.branchremarks=e.partnerbranch_remarks;
        modalshow('BranchAddPopup')
}
$scope.view_branchdetails=function(e){

$scope.showbranchsubmit=false;
$scope.showbranchupdate=false;

        if (e.Contact_DOB){
                $scope.Contact_DOB1 =  formatStringDate( new Date(e.Contact_DOB), 'yyyy-mm-dd');
             }
             else
             {
                $scope.Contact_DOB1= null;
             }

         if (e.Contact_WD){
                $scope.Contact_WD1 =  formatStringDate( new Date(e.Contact_WD), 'yyyy-mm-dd');
             }
             else
             {
                $scope.Contact_WD1= null;
             }
        $scope.partnerbranch_Gid=e.partnerbranch_gid;
        $scope.add.addline=e.address_1;
        $scope.add.addline2=e.address_2;
        $scope.add.pincode1=e.address_pincode;
        $scope.add.addline3=e.address_3;
        $scope.add.addselectedstate=e.address_state_gid;
        $scope.add.addselectedstate=e.address_state_gid,
        $scope.state_clk(e.address_state_gid,'address');
        $scope.add.addselecteddistrict = e.address_district_gid;
        $scope.district_clk(e.address_district_gid,'address'),
         $scope.add.addselectedcity=e.address_city_gid,
        $scope.add.cntcttype=e.Contact_contacttype_gid;
        $scope.add.prsnname=e.Contact_personname;
        $scope.add.dsgntn=e.Contact_designation_gid;
        $scope.add.lndlne=e.Contact_landline;
        $scope.add.lndlne2=e.Contact_landline2;
        $scope.add.mobno=e.Contact_mobileno;
        $scope.add.mobno2=e.Contact_mobileno2;
        $scope.add.mailid=e.Contact_email;
        $scope.add.dobb=$scope.Contact_DOB1;
        $scope.add.weddy=$scope.Contact_WD1;
        $scope.add.branchcode=e.partnerbranch_code;
        $scope.add.branchname=e.partnerbranch_name;
        $scope.add.branchremarks=e.partnerbranch_remarks;
        $scope.add.creditlimitdays=e.partnerbranch_creditperiod;
        $scope.add.creditterms=e.partnerbranch_paymentterms;
        $scope.add.branc_gstno=e.partnerbranch_gstno;
        $scope.add.branchpanno=e.partnerbranch_panno;
        modalshow('BranchAddPopup')
}
$scope.updatebranchdetails=function(e){

<!--if($scope.Partner.classification!="One Time"){-->
<!--var regularexp=/^[A-Z]{5}[0-9]{4}[A-Z]{1}$/;-->
<!--if(regularexp.test($scope.add.branchpanno)== true){-->
<!--}else {-->
<!--alert("Please Enter Valid Pan Number");-->
<!--   return false;-->
<!--}-->
<!--}-->

if($scope.Partner.compositevendor != 'UnRegistered'){
var gst_num = $scope.add.branc_gstno;
var gst_num = gst_num.slice(2, 12);
if(gst_num != $scope.add.branchpanno){
alert('You Have entered PAN which is not registered with GST')
return false;
}
}

if(($scope.Partner.compositevendor == 'UnRegistered')&&($scope.add.branc_gstno!="")&&($scope.add.branchpanno!="")){
var gst_num = $scope.add.branc_gstno;
var gst_num = gst_num.slice(2, 12);
if(gst_num != $scope.add.branchpanno){
alert('You Have entered PAN which is not registered with GST')
return false;
}
}

if(($scope.Partner.compositevendor != 'UnRegistered')&&($scope.add.branchpanno=="")){
if(($scope.panvalidresult=="FAILD") ||($scope.panvalidresult== undefined)){
alert("Please Enter Valid Pan Number");
$scope.branch_disabled=false;
   return false;
}
}

if(($scope.Partner.compositevendor == 'UnRegistered')&&($scope.add.branchpanno!="")){
if($scope.panvalidresult=="FAILD"){
alert("Please Enter Valid Pan Number");
$scope.branch_disabled=false;
   return false;
}
}
if(($scope.Partner.compositevendor != 'UnRegistered')&&($scope.add.branc_gstno=="")){
if(($scope.gstvalidresult=="FAILD")|| ($scope.gstvalidresult==undefined)){
alert("Please Enter Valid Gst Number");
$scope.branch_disabled=false;
   return false;
}
}

if(($scope.Partner.compositevendor == 'UnRegistered')&&($scope.add.branc_gstno!="")){
if($scope.gstvalidresult=="FAILD"){
alert("Please Enter Valid Gst Number");
$scope.branch_disabled=false;
   return false;
}
}
if( $scope.client_stategid){
    $scope.update_branchstategid= $scope.client_stategid;
    }
    else{
      $scope.update_branchstategid=$scope.add.addselectedstate;
    }
    if( $scope.client_districtgid){
    $scope.update_branchdistrictgid= $scope.client_districtgid;
    }
    else{
       $scope.update_branchdistrictgid=$scope.add.addselecteddistrict
    }
    if($scope.client_citygid){
     $scope.update_branchcitygid=  $scope.client_citygid
    }
    else{
    $scope.update_branchcitygid=  $scope.add.addselectedcity
    }
    if ($scope.add.dobb){
     $scope.update_branchdobdate = formatStringDate( $scope.add.dobb, 'yyyy-mm-dd');
     }
     else
     {
     $scope.update_branchdobdate=null;
     }
     if ($scope.add.weddy){
     $scope.update_branch_wddate = formatStringDate( $scope.add.weddy, 'yyyy-mm-dd');
     }
     else
     {
     $scope.update_branch_wddate=null;
     }
var data = {
                "Params": {
                    "PartnerBranch_Gid":$scope.partnerbranch_Gid,
                    "Address_1":e.addline,
                    "Address_2":e.addline2,
                    "Address_PinCode":e.pincode1,
                    "Address_3":e.addline3,
                    "Address_State_Gid":$scope.update_branchstategid,
                    "Address_District_Gid":$scope.update_branchdistrictgid,
                    "Address_City_Gid": $scope.update_branchcitygid,
                    "PartnerBranch_Code":$scope.add.branchcode,
                    "PartnerBranch_Name":$scope.add.branchname,
                    "PartnerBranch_Remarks":$scope.add.branchremarks,
                    "Contact_ContactType_Gid": $scope.add.cntcttype,
                   "Contact_PersonName": $scope.add.prsnname,
                   "Contact_Designation_Gid": $scope.add.dsgntn,
                   "Contact_LandLine": $scope.add.lndlne,
                   "Contact_LandLine2": $scope.add.lndlne2,
                   "Contact_MobileNo": $scope.add.mobno,
                   "Contact_MobileNo2": $scope.add.mobno2,
                   "Contact_Email": $scope.add.mailid,
                   "Contact_DOB": $scope.update_branchdobdate,
                   "Contact_WD":$scope.update_branch_wddate,
                   "partnerbranch_gstno":$scope.add.branc_gstno,
                   "partnerbranch_panno":$scope.add.branchpanno,

                },
                "Classification": {
                   "Update_By":$scope.create_by,
                },
        }
            var details = {
               Group: 'BranchDetails_Update',
               Action: 'BRANCH_UPDATE',
               Type:"",
               data: data,
            }
            $scope.loading();
                var update_branchdetails = Servicedrctsale.branchupdateService(details)
                update_branchdetails.then(function(result) {
                    $scope.branchupdategroup = result.data;
                    if($scope.branchupdategroup=="SUCCESS"){
                    alert("SUCCESSFULLY UPDATED");
                    modalhide('BranchAddPopup')
                    getbranchdetails();
                    }else{
                    alert(JSON.stringify($scope.branchupdategroup));
                    getbranchdetails();
                    modalshow('BranchAddPopup')
                    }
                }),
            function(err) {
                alert('no data');
            }.finally($scope.endloading());


}

//Branch Details End Page...!
//Basic Profile Details Start Page...!
$scope.basicprofile=[];
$scope.change_basicprofile=function(e){

$scope.employeeparmanentcount=parseInt(e.partnerprofile_noofempper);
$scope.employeetemporarycount=parseInt(e.partnerprofile_noofemptmp);
$scope.basicprofile.partnerprofile_totemp=parseInt($scope.employeeparmanentcount) + parseInt($scope.employeetemporarycount);
}

$scope.addbasicprofile=function(e){
$scope.disbl_prof_bscsave = true;
if($scope.basicprofile.partnerprofile_awarddetails == undefined){
$scope.partnerprofile_awarddetails = "";
}
else{
$scope.partnerprofile_awarddetails = ($scope.basicprofile.partnerprofile_awarddetails).toString();
}

if($scope.basicprofile.partnerprofile_associateyears == undefined){
$scope.partnerprofile_associateyears = "";
}
else{
$scope.partnerprofile_associateyears = ($scope.basicprofile.partnerprofile_associateyears).toString();
}

if($scope.basicprofile.partnerprofile_noofempper == undefined){
$scope.partnerprofile_noofempper = "";
}
else{
$scope.partnerprofile_noofempper = ($scope.basicprofile.partnerprofile_noofempper).toString();
}

if($scope.basicprofile.partnerprofile_noofemptmp == undefined){
$scope.partnerprofile_noofemptmp = "";
}
else{
$scope.partnerprofile_noofemptmp = ($scope.basicprofile.partnerprofile_noofemptmp).toString();
}


if($scope.basicprofile.partnerprofile_totemp == undefined){
$scope.partnerprofile_totemp = "";
}
else{
$scope.partnerprofile_totemp = ($scope.basicprofile.partnerprofile_totemp).toString();
}

if($scope.basicprofile.partnerprofile_factorycount == undefined){
$scope.partnerprofile_factorycount = "";
}
else{
$scope.partnerprofile_factorycount = ($scope.basicprofile.partnerprofile_factorycount).toString();
}

if($scope.basicprofile.partnerprofile_totemp == undefined){
$scope.partnerprofile_totemp = "";
}
else{
$scope.partnerprofile_totemp = ($scope.basicprofile.partnerprofile_totemp).toString();
}
var f = $scope.basicprofile.partnerprofile_awarddetails;
if($scope.branchgetgroup_get.length >0){
if($scope.brach_count != undefined){
if($scope.brach_count > $scope.basicprofile.partnerprofile_branchcount){
alert("You Can't decrease a Branch Count ");
$scope.disbl_prof_bscsave = false;
 return false;
 }
}
}
if ($scope.basicprofile.partnerprofile_branchcount <=0 ||$scope.basicprofile.partnerprofile_branchcount == undefined  ){
         alert('Branch count should be greater than 0')
         $scope.disbl_prof_bscsave = false;
            return false;
        }

var data = {
                "Params": {
                    "Partnerprofile_Partnergid":$scope.partner_gid,
                    "Partnerprofile_Noofyears":($scope.basicprofile.partnerprofile_noofyears).toString(),
                    "Partnerprofile_Associateyears":$scope.partnerprofile_associateyears,
                    "Partnerprofile_Awarddetails":$scope.partnerprofile_awarddetails,
                    "Partnerprofile_Noofempper":$scope.partnerprofile_noofempper,
                    "Partnerprofile_Noofemptmp":$scope.partnerprofile_noofemptmp,
                    "Partnerprofile_Totemp": $scope.partnerprofile_totemp,
                    "Partnerprofile_Branchcount": ($scope.basicprofile.partnerprofile_branchcount).toString(),
                    "Partnerprofile_Factorycount": $scope.partnerprofile_factorycount,
                    "Partnerprofile_Remarks":$scope.partnerprofile_remarks,


                },
                "Classification": {
                   "Entity_Gid":$scope.entity_gid,
                   "Create_By":$scope.create_by,
                },
        }
            var details = {
               Group: 'BasicProfile_Set',
               Action: '',
               Type:"",
               data: data,
            }

                var set_basicprofiledetails = Servicedrctsale.basicprofilesetService(details)
                set_basicprofiledetails.then(function(result) {
                    $scope.basicprofilesetgroup = result.data.MESSAGE;
                    $scope.brach_count=$scope.basicprofile.partnerprofile_branchcount;
                    //alert($scope.brach_count +"cfg")
                    //alert(JSON.stringify($scope.basicprofilesetgroup))
                    if($scope.basicprofilesetgroup=="SUCCESSFULLY UPDATED"){
                    alert("SUCCESSFULLY UPDATED");
                    getbasicprofiledetails();
                    $scope.disbl_prof_bscsave = false;
                    }
                    if($scope.basicprofilesetgroup=="SUCCESS"){
                    alert("SUCCESSFULLY INSERTED");
                    getbasicprofiledetails();
                    $scope.disbl_prof_bscsave = false;
                    }
                }),
            function(err) {
                alert('no data');
                $scope.disbl_prof_bscsave = false;
            }.finally();

}
getbasicprofiledetails();
function getbasicprofiledetails(){

var data = {
                "Params": {
                    "Partnerprofile_Partnergid":$scope.partner_gid,
                    "Mst_Table": $scope.msttable,
                },
                "Classification": {
                   "Entity_Gid":$scope.entity_gid,
                },
        }
            var details = {
               Group: 'Partnerprofile_Get',
               Action: 'Partnerprofile_Get',
               Type:"",
               data: data,
            }
                var get_basicprofiledetails = Servicedrctsale.basicprofilegetService(details)
                get_basicprofiledetails.then(function(result) {
                //alert(result.data.DATA[0].partnerprofile_gid)
                    $scope.basicprofile = result.data.DATA[0];
                    $scope.brach_count=$scope.basicprofile.partnerprofile_branchcount;
                    //alert($scope.brach_count+"dfg");
                    $scope.basicprofiles = result.data.MESSAGE;
                    //alert( $scope.basicprofile.partnerprofile_gid)
                    //alert(JSON.stringify($scope.basicprofiles))
                    if($scope.basicprofiles=="NOT_FOUND"){
                    // $scope.brach_count=1;
                    //alert($scope.brach_count);
                    }else{
                    $scope.basicprofile = result.data.DATA[0];
                    }
                    if($scope.basicprofile.partnerprofile_branchcount >= 0){
                    //$scope.brach_count=$scope.basicprofile.partnerprofile_branchcount + 1;
                    //alert($scope.brach_count);
                    }
                    //alert(JSON.stringify($scope.basicprofile.partnerprofile_branchcount))
                }),
            function(err) {
                alert('no data');
            };

}

    $scope.partnerproduct = [];
    function searchpartnerproduct(searchText) {
                debugger;
             var dat = {
            "Table_name": "gal_mst_tmetadata",
            "Column_1": "metadata_gid,metadata_value",
            "Column_2": "",
            "Where_Common": "metadata",
            "Where_Primary": "columnname",
            "Primary_Value": "partnerproduct_type",
            "Limits": "0,30",
            "Search_Column": searchText,
            "Order_by": "value"
        }
        var partnergroup = {
            Action: "",
            Entity_Gid: $scope.entity_gid,
            data: dat
        }
        return $http.post(Appname + '/prodget/' , partnergroup).then(function(result) {
            console.log(result.data.DATA);
                return result.data.DATA;
        });
    };


$scope.showbranchadd=true;
<!--$scope.brach_count=1;-->
//Basic Profile Details End Page...!
//PARTNERPRODUCT START PAGE
$scope.profileproduct = [];
$rootScope.partnerprofilepopup_add = function() {

$scope.product_disabled=false;
            $scope.btnProfileProduct_Save = true;
            $scope.btnProfileProduct_Update = false;
            $scope.profileproduct.producttype = "";
            $scope.profileproduct.name = "";
            $scope.profileproduct.personname1 = "";
            $scope.profileproduct.personname2 = "";
            $scope.profileproduct.personname3 = "";
            $scope.profileproduct.personname4 = "";
            $scope.profileproduct.contacttype1 = "";
            $scope.profileproduct.designation1 = "";
            $scope.profileproduct.landline1 = "";
            $scope.profileproduct.landline2_1 = "";
            $scope.profileproduct.mobilenumber1 = "";
            $scope.profileproduct.mobilenumber2_1 = "";
            $scope.profileproduct.emailid1 = "";
            $scope.profileproduct.dobb1 = "";
            $scope.profileproduct.weddy1 = "";
            $scope.profileproduct.contacttype2 = "";
            $scope.profileproduct.designation2 = "";
            $scope.profileproduct.landline2 = "";
            $scope.profileproduct.landline2_2 = "";
            $scope.profileproduct.mobilenumber2 = "";
            $scope.profileproduct.mobilenumber2_2 = "";
            $scope.profileproduct.emailid2 = "";
            $scope.profileproduct.dobb2 = "";
            $scope.profileproduct.weddy2 = "";
            $scope.profileproduct.contacttype3 = "";
            $scope.profileproduct.designation3 = "";
            $scope.profileproduct.landline3 = "";
            $scope.profileproduct.landline2_3 = "";
            $scope.profileproduct.mobilenumber3 = "";
            $scope.profileproduct.mobilenumber2_3 = "";
            $scope.profileproduct.emailid3 = "";
            $scope.profileproduct.dobb3 = "";
            $scope.profileproduct.weddy3 = "";
            $scope.profileproduct.contacttype4 = "";
            $scope.profileproduct.designation4 = "";
            $scope.profileproduct.landline4 = "";
            $scope.profileproduct.landline2_4 = "";
            $scope.profileproduct.mobilenumber4 = "";
            $scope.profileproduct.mobilenumber2_4 = "";
            $scope.profileproduct.emailid4 = "";
            $scope.profileproduct.weddy4 = "";
            $scope.profileproduct.age = "";
            modalshow('popup_product');
        }
        var datan = {
            "Table_name": "gal_mst_tmetadata",
            "Column_1": "metadata_value,metadata_gid",
            "Column_2": "",
            "Where_Common": "metadata",
            "Where_Primary": "columnname",
            "Primary_Value": "partnerproduct_type",
            "Order_by": "value"
        }
        var partnerprod = {
            Action: "",
            Entity_Gid: $scope.entity,
            data: datan
        }

        var data = {
            "Table_name": "gal_mst_tcontacttype",
            "Column_1": "contacttype_gid,contacttype_Name",
            "Column_2": "",
            "Where_Common": "contacttype",
            "Where_Primary": "contacttype_gid",
            "Primary_Value": "",
            "Order_by": "gid"
        }
        var pcont = {
            Action: "",
            Entity_Gid: $scope.entity_gid,
            data: data
        }
        $scope.contacttype = [];
        var getcont = Servicedrctsale.getcontdata(pcont)
        getcont.then(function(result) {
            $scope.contacttype = result.data.DATA;
        }, function(err) {
            alert('No data!.');
        }).finally();
        $scope.auto_addproduct1=function(d,u){

        if(d==true){
        $scope.profileproduct.contacttype2=u.contacttype1,
        $scope.profileproduct.personname2=u.personname1,
        $scope.profileproduct.designation2=u.designation1,
        $scope.profileproduct.landline2=u.landline1,
        $scope.profileproduct.landline2_2=u.landline2_1,
        $scope.profileproduct.mobilenumber2=u.mobilenumber1,
        $scope.profileproduct.mobilenumber2_2=u.mobilenumber2_1,
        $scope.profileproduct.emailid2=u.emailid1,
        $scope.profileproduct.dobb112=new Date(u.dobb1)
        if(u.dobb1!=""){
        $scope.profileproduct.dobb2=new Date(u.dobb1)
        }else{
        $scope.profileproduct.dobb2=""
        }
        if(u.weddy1!=""){
        $scope.profileproduct.weddy2=new Date(u.weddy1)
        }else{
        $scope.profileproduct.weddy2=""
        }
        //$scope.profileproduct.weddy2=new Date(u.weddy1)
        }else{
         $scope.profileproduct.contacttype2="",
        $scope.profileproduct.personname2="",
        $scope.profileproduct.designation2="",
        $scope.profileproduct.landline2="",
        $scope.profileproduct.landline2_2="",
        $scope.profileproduct.mobilenumber2="",
        $scope.profileproduct.mobilenumber2_2="",
        $scope.profileproduct.emailid2="",
        $scope.profileproduct.dobb2="",
        $scope.profileproduct.weddy2=""
        }
        }
        $scope.auto_addproduct2=function(d,u){

        if(d==true){
        $scope.profileproduct.contacttype4=u.contacttype3,
        $scope.profileproduct.personname4=u.personname3,
        $scope.profileproduct.designation4=u.designation3,
        $scope.profileproduct.landline4=u.landline3,
        $scope.profileproduct.landline2_4=u.landline2_3,
        $scope.profileproduct.mobilenumber4=u.mobilenumber3,
        $scope.profileproduct.mobilenumber2_4=u.mobilenumber2_3,
        $scope.profileproduct.emailid4=u.emailid3
        if(u.dobb3!=""){
        $scope.profileproduct.dobb4=new Date(u.dobb1)
        }else{
        $scope.profileproduct.dobb4=""
        }
        if(u.weddy3!=""){
        $scope.profileproduct.weddy4=new Date(u.weddy3)
        }else{
        $scope.profileproduct.weddy4=""
        }
        //$scope.profileproduct.weddy2=new Date(u.weddy1)
        }else{
         $scope.profileproduct.contacttype4="",
        $scope.profileproduct.personname4="",
        $scope.profileproduct.designation4="",
        $scope.profileproduct.landline4="",
        $scope.profileproduct.landline2_4="",
        $scope.profileproduct.mobilenumber4="",
        $scope.profileproduct.mobilenumber2_4="",
        $scope.profileproduct.emailid4="",
        $scope.profileproduct.dobb4="",
        $scope.profileproduct.weddy4=""
        }
        }
        $scope.saveproduct = function(profileproduct) {
        debugger;
         $scope.product_disabled=true;
        if($scope.profileproduct.producttype ==  undefined || $scope.profileproduct.producttype ==  '' ){
         alert('Please Select Product Type');
         $scope.product_disabled=false;
            return false;
        }
        if($scope.profileproduct.name ==  undefined || $scope.profileproduct.name ==  '' ){
         alert('Please Enter Product Name');
         $scope.product_disabled=false;
            return false;
        }
        //contact 1
        if($scope.profileproduct.contacttype1 ==  undefined || $scope.profileproduct.contacttype1 ==  '' ){
            alert('Please Select Client Contact 1- Contact Type');
            $scope.product_disabled=false;
            return false;
        }
        if($scope.profileproduct.contacttype1 ==  undefined || $scope.profileproduct.contacttype1 ==  '' ){
            alert('Please Select Client Contact 1 - Contact Type');
            $scope.product_disabled=false;
            return false;
        }
        if($scope.profileproduct.personname1 ==  undefined || $scope.profileproduct.personname1 ==  '' ){
            alert('Please Enter Client Contact 1 - Person Name ');
            $scope.product_disabled=false;
            return false;
        }
        if($scope.profileproduct.designation1 ==  undefined || $scope.profileproduct.designation1 ==  '' ){
            alert('Please Select Client Contact 1 - Designation Name ');
            $scope.product_disabled=false;
            return false;
        }
        if($scope.profileproduct.mobilenumber1 ==  undefined || $scope.profileproduct.mobilenumber1 ==  '' ){
            alert('Please Enter Client Contact 1 - Mobile Number ');
            $scope.product_disabled=false;
            return false;
        }
        //contact 1
        if($scope.profileproduct.contacttype1 ==  undefined || $scope.profileproduct.contacttype1 ==  '' ){
            alert('Please Select Client Contact 2- Contact Type');
            $scope.product_disabled=false;
            return false;
        }
        if($scope.profileproduct.contacttype1 ==  undefined || $scope.profileproduct.contacttype1 ==  '' ){
            alert('Please Select Client Contact 2 - Contact Type');
            $scope.product_disabled=false;
            return false;
        }
        if($scope.profileproduct.personname1 ==  undefined || $scope.profileproduct.personname1 ==  '' ){
            alert('Please Enter Client Contact 2 - Person Name ');
            $scope.product_disabled=false;
            return false;
        }
        if($scope.profileproduct.designation1 ==  undefined || $scope.profileproduct.designation1 ==  '' ){
            alert('Please Select Client Contact 2 - Designation Name ');
            $scope.product_disabled=false;
            return false;
        }
        if($scope.profileproduct.mobilenumber1 ==  undefined || $scope.profileproduct.mobilenumber1 ==  '' ){
            alert('Please Enter Client Contact 2 - Mobile Number ');
            $scope.product_disabled=false;
            return false;
        }


            var data = {
                "Params": {
                    "PartnerProduct_Partner_Gid": $scope.partner_gid,
                    "Client_Contact_ContactType_Gid": profileproduct.contacttype1,
                    "Client_Contact_PersonName": profileproduct.personname1,
                    "Client_Contact_Designation_Gid": profileproduct.designation1,
                    "Client_Contact_LandLine": profileproduct.landline1,
                    "Client_Contact_LandLine2": profileproduct.landline2_1,
                    "Client_Contact_MobileNo": profileproduct.mobilenumber1,
                    "Client_Contact_MobileNo2": profileproduct.mobilenumber2_1,
                    "Client_Contact_Email": profileproduct.emailid1,
                    "Client_Contact_DOB":profileproduct.dobb1,
                    "Client_Contact_WD": profileproduct.weddy1,
                    "Client_Contact_ContactType_Gid_2": profileproduct.contacttype2,
                    "Client_Contact_PersonName_2": profileproduct.personname2,
                    "Client_Contact_Designation_Gid_2": profileproduct.designation2,
                    "Client_Contact_LandLine_2": profileproduct.landline2,
                    "Client_Contact_LandLine2_2": profileproduct.landline2_2,
                    "Client_Contact_MobileNo_2": profileproduct.mobilenumber2,
                    "Client_Contact_MobileNo2_2": profileproduct.mobilenumber2_2,
                    "Client_Contact_Email_2": profileproduct.emailid2,
                    "Client_Contact_DOB_2": profileproduct.dobb2,
                    "Client_Contact_WD_2": profileproduct.weddy2,
                    "Customer_Contact_ContactType_Gid": profileproduct.contacttype3,
                    "Customer_Contact_PersonName": profileproduct.personname3,
                    "Customer_Contact_Designation_Gid": profileproduct.designation3,
                    "Customer_Contact_LandLine": profileproduct.landline3,
                    "Customer_Contact_LandLine2": profileproduct.landline2_3,
                    "Customer_Contact_MobileNo": profileproduct.mobilenumber3,
                    "Customer_Contact_MobileNo2": profileproduct.mobilenumber2_3,
                    "Customer_Contact_Email": profileproduct.emailid3,
                    "Customer_Contact_DOB": profileproduct.dobb3,
                    "Customer_Contact_WD": profileproduct.weddy3,
                    "Customer_Contact_ContactType_Gid_2": profileproduct.contacttype4,
                    "Customer_Contact_PersonName_2": profileproduct.personname4,
                    "Customer_Contact_Designation_Gid_2": profileproduct.designation4,
                    "Customer_Contact_LandLine_2": profileproduct.landline4,
                    "Customer_Contact_LandLine2_2": profileproduct.landline2_4,
                    "Customer_Contact_MobileNo_2": profileproduct.mobilenumber4,
                    "Customer_Contact_MobileNo2_2": profileproduct.mobilenumber2_4,
                    "Customer_Contact_Email_2": profileproduct.emailid4,
                    "Customer_Contact_DOB_2": profileproduct.dobb4,
                    "Customer_Contact_WD_2": profileproduct.weddy4,
                    "PartnerProduct_Type": profileproduct.producttype.metadata_gid,
                    "PartnerProduct_Name": profileproduct.name,
                    "PartnerProduct_Age": profileproduct.age,
                },
                "Classification": {
                    "Create_By": $scope.create_by,
                    "Entity_Gid": $scope.entity_gid,
                },
            }
            var total = {
                Group: 'Partner Product',
                Action: 'Atma_Product_Insert',
                Type: 'Partner Product',
                data: data
            }
            $scope.partnerprofile = [];
            $scope.loading();
            var set_partnerprofile = Servicedrctsale.PartnerProductSet(total)
            set_partnerprofile.then(function(result) {

                    $scope.partnerprofile = result.data.MESSAGE;
                    if($scope.partnerprofile == "SUCCESS"){
                    alert("SUCCESSFULLY INSERTED ");
                    modalhide('popup_product');
                    loadData_PartnerProfileProduct();
                    }else{
                    alert(JSON.stringify(result.data.MESSAGE));
                     $scope.product_disabled=false;
                    }
                }),
                function(err) {
                    alert('no data');
                }.finally($scope.endloading());
        }
        $scope.showviewprof = function(prof) {
        debugger;
            $scope.profileproduct.producttype = prof.partnerproduct_type;
            $scope.profileproduct.name = prof.partnerproduct_name;
            $scope.profileproduct.personname1 = prof.Contact_personname;
            $scope.profileproduct.personname2 = prof.Contact_personname_2;
            $scope.profileproduct.personname3 = prof.Contact_personname_3;
            $scope.profileproduct.personname4 = prof.Contact_personname_4;
            modalshow('partnerprofile_view_page');
        }
        $scope.edit_partnerprofileproduct = function(prof) {
            debugger;
             $scope.disabeld_pproduct=false;
            $scope.btnProfileProduct_Save = false;
            $scope.btnProfileProduct_Update = true;
            $scope.profileproduct.partnerproduct_gid=prof.partnerproduct_gid;
            $scope.profileproduct.contacttype1 = prof.Contact_contacttype_gid;
            $scope.profileproduct.contacttype2 = prof.Contact_contacttype_gid_2;
            $scope.profileproduct.contacttype3 = prof.Contact_contacttype_gid_3;
            $scope.profileproduct.contacttype4 = prof.Contact_contacttype_gid_4;
            $scope.profileproduct.producttype = prof.metadata_value;
            $scope.profileproduct.name = prof.partnerproduct_name;
            $scope.profileproduct.personname1 = prof.Contact_personname;
            $scope.profileproduct.personname2 = prof.Contact_personname_2;
            $scope.profileproduct.personname3 = prof.Contact_personname_3;
            $scope.profileproduct.personname4 = prof.Contact_personname_4;
            $scope.profileproduct.designation1 = prof.Contact_designation_gid;
            $scope.profileproduct.designation2 = prof.Contact_designation_gid_2;
            $scope.profileproduct.designation3 = prof.Contact_designation_gid_3;
            $scope.profileproduct.designation4 = prof.Contact_designation_gid_4;
            $scope.profileproduct.emailid1 = prof.Contact_email;
            $scope.profileproduct.emailid2 = prof.Contact_email_2;
            $scope.profileproduct.emailid3 = prof.Contact_email_3;
            $scope.profileproduct.emailid4 = prof.Contact_email_4;
            $scope.profileproduct.mobilenumber1 = prof.Contact_mobileno;
            $scope.profileproduct.mobilenumber2_1 = prof.Contact_mobileno2;
            $scope.profileproduct.mobilenumber2 = prof.Contact_mobileno_2;
            $scope.profileproduct.mobilenumber2_2 = prof.Contact_mobileno2_2;
            $scope.profileproduct.mobilenumber3 = prof.Contact_mobileno_3;
            $scope.profileproduct.mobilenumber2_3 = prof.Contact_mobileno2_3;
            $scope.profileproduct.mobilenumber4 = prof.Contact_mobileno_4;
            $scope.profileproduct.mobilenumber2_4 = prof.Contact_mobileno2_4;
            $scope.profileproduct.landline1 = prof.Contact_landline;
            $scope.profileproduct.landline2_1 = prof.Contact_landline2;
            $scope.profileproduct.landline2 = prof.Contact_landline_2;
            $scope.profileproduct.landline2_2 = prof.Contact_landline2_2;
            $scope.profileproduct.landline3 = prof.Contact_landline_3;
            $scope.profileproduct.landline2_3 = prof.Contact_landline2_3;
            $scope.profileproduct.landline4 = prof.Contact_landline_4;
            $scope.profileproduct.landline2_4 = prof.Contact_landline2_4;

            if (prof.Contact_DOB==null)  {
                $scope.profileproduct.dobb1=null;
            }else
            {
                $scope.profileproduct.dobb1=new Date(prof.Contact_DOB);
            }
            if (prof.Contact_WD==null)  {
                $scope.profileproduct.weddy1=null;
            }else
            {
                $scope.profileproduct.weddy1=new Date(prof.Contact_WD);
            }

            if (prof.Contact_DOB_2==null)  {
                $scope.profileproduct.dobb2=null;
            }else
            {
                $scope.profileproduct.dobb2=new Date(prof.Contact_DOB_2);
            }
            if (prof.Contact_WD_2==null)  {
                $scope.profileproduct.weddy2=null;
            }else
            {
                $scope.profileproduct.weddy2=new Date(prof.Contact_WD_2);
            }

            if (prof.Contact_DOB_3==null)  {
                $scope.profileproduct.dobb3=null;
            }else
            {
                $scope.profileproduct.dobb3=new Date(prof.Contact_DOB_3);
            }
            if (prof.Contact_WD_3==null)  {
                $scope.profileproduct.weddy3=null;
            }else
            {
                $scope.profileproduct.weddy3=new Date(prof.Contact_WD_3);
            }

            if (prof.Contact_DOB_4==null)  {
                $scope.profileproduct.dobb4=null;
            }else
            {
                $scope.profileproduct.dobb4=new Date(prof.Contact_DOB_4);
            }
            if (prof.Contact_WD_4==null)  {
                $scope.profileproduct.weddy4=null;
            }else
            {
                $scope.profileproduct.weddy4=new Date(prof.Contact_WD_4);
            }

            $scope.profileproduct.Contact_ref_gid = prof.Contact_ref_gid_2;
            $scope.profileproduct.Contact_ref_gid_3 = prof.Contact_ref_gid_2;
            $scope.profileproduct.Contact_ref_gid = prof.Contact_ref_gid_3;
            $scope.profileproduct.Contact_reftable_gid = prof.Contact_ref_gid_4;
            $scope.profileproduct.Contact_reftable_gid_2 = prof.Contact_reftable_gid;
            $scope.profileproduct.Contact_reftable_gid_3 = prof.Contact_reftable_gid_2;
            $scope.profileproduct.Contact_reftable_gid_4 = prof.Contact_reftable_gid_3;
            $scope.profileproduct.Contact_reftable_gid = prof.Contact_reftable_gid_4;
            $scope.profileproduct.contact_reftablecode = prof.contact_reftablecode;
            $scope.profileproduct.contact_reftable_2 = prof.contact_reftablecode_2;
            $scope.profileproduct.contact_reftablecode_3 = prof.contact_reftablecode_3;
            $scope.profileproduct.contact_reftablecode_4 = prof.contact_reftablecode_4;
            $scope.profileproduct.age = prof.partnerproduct_age;
            $scope.profileproduct.partnerproduct_clientcontactgid1 = prof.partnerproduct_clientcontactgid1;
            $scope.profileproduct.partnerproduct_clientcontactgid2 = prof.partnerproduct_clientcontactgid2;
            $scope.profileproduct.partnerproduct_customercontactgid1 = prof.partnerproduct_customercontactgid1;
            $scope.profileproduct.partnerproduct_customercontactgid2 = prof.partnerproduct_customercontactgid2;
            modalshow('popup_product');
        }
        $scope.showview_pproduct = function(prof) {
            $scope.disabeld_pproduct=false;
            $scope.btnProfileProduct_Save = false;
            $scope.btnProfileProduct_Update = false;
            $scope.profileproduct.partnerproduct_gid=prof.partnerproduct_gid;
            $scope.profileproduct.contacttype1 = prof.Contact_contacttype_gid;
            $scope.profileproduct.contacttype2 = prof.Contact_contacttype_gid_2;
            $scope.profileproduct.contacttype3 = prof.Contact_contacttype_gid_3;
            $scope.profileproduct.contacttype4 = prof.Contact_contacttype_gid_4;
            $scope.profileproduct.producttype = prof.partnerproduct_type;
            $scope.profileproduct.name = prof.partnerproduct_name;
            $scope.profileproduct.personname1 = prof.Contact_personname;
            $scope.profileproduct.personname2 = prof.Contact_personname_2;
            $scope.profileproduct.personname3 = prof.Contact_personname_3;
            $scope.profileproduct.personname4 = prof.Contact_personname_4;
            $scope.profileproduct.designation1 = prof.Contact_designation_gid;
            $scope.profileproduct.designation2 = prof.Contact_designation_gid_2;
            $scope.profileproduct.designation3 = prof.Contact_designation_gid_3;
            $scope.profileproduct.designation4 = prof.Contact_designation_gid_4;
            $scope.profileproduct.emailid1 = prof.Contact_email;
            $scope.profileproduct.emailid2 = prof.Contact_email_2;
            $scope.profileproduct.emailid3 = prof.Contact_email_3;
            $scope.profileproduct.emailid4 = prof.Contact_email_4;
            $scope.profileproduct.mobilenumber1 = prof.Contact_mobileno;
            $scope.profileproduct.mobilenumber2_1 = prof.Contact_mobileno2;
            $scope.profileproduct.mobilenumber2 = prof.Contact_mobileno_2;
            $scope.profileproduct.mobilenumber2_2 = prof.Contact_mobileno2_2;
            $scope.profileproduct.mobilenumber3 = prof.Contact_mobileno_3;
            $scope.profileproduct.mobilenumber2_3 = prof.Contact_mobileno2_3;
            $scope.profileproduct.mobilenumber4 = prof.Contact_mobileno_4;
            $scope.profileproduct.mobilenumber2_4 = prof.Contact_mobileno2_4;
            $scope.profileproduct.landline1 = prof.Contact_landline;
            $scope.profileproduct.landline2_1 = prof.Contact_landline2;
            $scope.profileproduct.landline2 = prof.Contact_landline_2;
            $scope.profileproduct.landline2_2 = prof.Contact_landline2_2;
            $scope.profileproduct.landline3 = prof.Contact_landline_3;
            $scope.profileproduct.landline2_3 = prof.Contact_landline2_3;
            $scope.profileproduct.landline4 = prof.Contact_landline_4;
            $scope.profileproduct.landline2_4 = prof.Contact_landline2_4;
            $scope.profileproduct.dobb1 = $filter('date')(prof.Contact_DOB, "yyyy-MM-dd");
            $scope.profileproduct.weddy1 = $filter('date')(prof.Contact_WD, "yyyy-MM-dd");
            $scope.profileproduct.dobb2 = $filter('date')(prof.Contact_DOB_2, "yyyy-MM-dd");
            $scope.profileproduct.weddy2 = $filter('date')(prof.Contact_WD_2, "yyyy-MM-dd");
            $scope.profileproduct.dobb3 = $filter('date')(prof.Contact_DOB_3, "yyyy-MM-dd");
            $scope.profileproduct.weddy3 = $filter('date')(prof.Contact_WD_3, "yyyy-MM-dd");
            $scope.profileproduct.dobb4 = $filter('date')(prof.Contact_DOB_4, "yyyy-MM-dd");
            $scope.profileproduct.weddy4 = $filter('date')(prof.Contact_WD_4, "yyyy-MM-dd");
            $scope.profileproduct.Contact_ref_gid = prof.Contact_ref_gid_2;
            $scope.profileproduct.Contact_ref_gid_3 = prof.Contact_ref_gid_2;
            $scope.profileproduct.Contact_ref_gid = prof.Contact_ref_gid_3;
            $scope.profileproduct.Contact_reftable_gid = prof.Contact_ref_gid_4;
            $scope.profileproduct.Contact_reftable_gid_2 = prof.Contact_reftable_gid;
            $scope.profileproduct.Contact_reftable_gid_3 = prof.Contact_reftable_gid_2;
            $scope.profileproduct.Contact_reftable_gid_4 = prof.Contact_reftable_gid_3;
            $scope.profileproduct.Contact_reftable_gid = prof.Contact_reftable_gid_4;
            $scope.profileproduct.contact_reftablecode = prof.contact_reftablecode;
            $scope.profileproduct.contact_reftable_2 = prof.contact_reftablecode_2;
            $scope.profileproduct.contact_reftablecode_3 = prof.contact_reftablecode_3;
            $scope.profileproduct.contact_reftablecode_4 = prof.contact_reftablecode_4;
            $scope.profileproduct.age = prof.partnerproduct_age;
            $scope.profileproduct.partnerproduct_clientcontactgid1 = prof.partnerproduct_clientcontactgid1;
            $scope.profileproduct.partnerproduct_clientcontactgid2 = prof.partnerproduct_clientcontactgid2;
            $scope.profileproduct.partnerproduct_customercontactgid1 = prof.partnerproduct_customercontactgid1;
            $scope.profileproduct.partnerproduct_customercontactgid2 = prof.partnerproduct_customercontactgid2;
            modalshow('popup_product');
        }
        $scope.updatePartnerProfileProduct = function(profileproduct) {

            if (profileproduct.dobb1){
                $scope.update_profileproductdobb1 =  formatStringDate( profileproduct.dobb1, 'yyyy-mm-dd');
             }
             else
             {
                $scope.update_profileproductdobb1= null;
             }
            if (profileproduct.weddy1){
                $scope.update_profileproductweddy1= formatStringDate( profileproduct.weddy1, 'yyyy-mm-dd');
             }
             else
             {
                $scope.update_profileproductweddy1= null;
             }
             if (profileproduct.dobb2){
                $scope.update_profileproductdobb2 =  formatStringDate( profileproduct.dobb2, 'yyyy-mm-dd');
             }
             else
             {
                $scope.update_profileproductdobb2= null;
             }
            if (profileproduct.weddy2){
                $scope.update_profileproductweddy2= formatStringDate( profileproduct.weddy2, 'yyyy-mm-dd');
             }
             else
             {
                $scope.update_profileproductweddy2= null;
             }
             if (profileproduct.dobb3){
                $scope.update_profileproductdobb3 =  formatStringDate( profileproduct.dobb3, 'yyyy-mm-dd');
             }
             else
             {
                $scope.update_profileproductdobb3= null;
             }
            if (profileproduct.weddy3){
                $scope.update_profileproductweddy3= formatStringDate( profileproduct.weddy3, 'yyyy-mm-dd');
             }
             else
             {
                $scope.update_profileproductweddy3= null;
             }
             if (profileproduct.dobb4){
                $scope.update_profileproductdobb4 =  formatStringDate( profileproduct.dobb4, 'yyyy-mm-dd');
             }
             else
             {
                $scope.update_profileproductdobb4 = null;
             }
            if (profileproduct.weddy4){
                $scope.update_profileproductweddy4= formatStringDate( profileproduct.weddy4, 'yyyy-mm-dd');
             }
             else
             {
                $scope.update_profileproductweddy4= null;
             }
            var data = {
                "Params": {
                    "PartnerProduct_Gid": $scope.profileproduct.partnerproduct_gid,
                    "Client_Contact_ContactType_Gid": profileproduct.contacttype1,
                    "Client_Contact_PersonName": profileproduct.personname1,
                    "Client_Contact_Designation_Gid": profileproduct.designation1,
                    "Client_Contact_LandLine": profileproduct.landline1,
                    "Client_Contact_LandLine2": profileproduct.landline2_1,
                    "Client_Contact_MobileNo": profileproduct.mobilenumber1,
                    "Client_Contact_MobileNo2": profileproduct.mobilenumber2_1,
                    "Client_Contact_Email": profileproduct.emailid1,
                    "Client_Contact_DOB":$scope.update_profileproductdobb1,
                    "Client_Contact_WD":$scope.update_profileproductweddy1,
                    "Client_Contact_ContactType_Gid_2": profileproduct.contacttype2,
                    "Client_Contact_PersonName_2": profileproduct.personname2,
                    "Client_Contact_Designation_Gid_2": profileproduct.designation2,
                    "Client_Contact_LandLine_2": profileproduct.landline2,
                    "Client_Contact_LandLine2_2": profileproduct.landline2_2,
                    "Client_Contact_MobileNo_2": profileproduct.mobilenumber2,
                    "Client_Contact_MobileNo2_2": profileproduct.mobilenumber2_2,
                    "Client_Contact_Email_2": profileproduct.emailid2,
                    "Client_Contact_DOB_2": $scope.update_profileproductdobb2,
                    "Client_Contact_WD_2": $scope.update_profileproductweddy2,
                    "Customer_Contact_ContactType_Gid": profileproduct.contacttype3,
                    "Customer_Contact_PersonName": profileproduct.personname3,
                    "Customer_Contact_Designation_Gid": profileproduct.designation3,
                    "Customer_Contact_LandLine": profileproduct.landline3,
                    "Customer_Contact_LandLine2": profileproduct.landline2_3,
                    "Customer_Contact_MobileNo": profileproduct.mobilenumber3,
                    "Customer_Contact_MobileNo2": profileproduct.mobilenumber2_3,
                    "Customer_Contact_Email": profileproduct.emailid3,
                    "Customer_Contact_DOB": $scope.update_profileproductdobb3,
                    "Customer_Contact_WD": $scope.update_profileproductweddy3,
                    "Customer_Contact_ContactType_Gid_2": profileproduct.contacttype4,
                    "Customer_Contact_PersonName_2": profileproduct.personname4,
                    "Customer_Contact_Designation_Gid_2": profileproduct.designation4,
                    "Customer_Contact_LandLine_2": profileproduct.landline4,
                    "Customer_Contact_LandLine2_2": profileproduct.landline2_4,
                    "Customer_Contact_MobileNo_2": profileproduct.mobilenumber4,
                    "Customer_Contact_MobileNo2_2": profileproduct.mobilenumber2_4,
                    "Customer_Contact_Email_2": profileproduct.emailid4,
                    "Customer_Contact_DOB_2": $scope.update_profileproductdobb4,
                    "Customer_Contact_WD_2": $scope.update_profileproductweddy4,
                    "PartnerProduct_Type": profileproduct.producttype.metadata_gid,
                    "PartnerProduct_Name": profileproduct.name
                },
                "Classification": {
                    "Update_By": $scope.create_by,
                },
            }
            var total = {
                Group: 'Partner Product',
                Action: 'Product_Update',
                Type: 'Partner Product',
                data: data
            }
            $scope.partnerprofile = [];
            $scope.loading();
            var set_partnerprofile = Servicedrctsale.PartnerProductSet(total)
            set_partnerprofile.then(function(result) {
                    alert(JSON.stringify(result.data));
                    $scope.partnerprofile = result.data.Data;
                    loadData_PartnerProfileProduct();
                    modalhide('popup_product');
                }),
                function(err) {
                    alert('no data');
                }.finally($scope.endloading());
        }
         loadData_PartnerProfileProduct();
        function loadData_PartnerProfileProduct() {
            var data = {
                "Params": {
                    "Filter": {
                    "PartnerProduct_Gid":$scope.partner_gid,
                    "Mst_Table": $scope.msttable,
                    },
                    "Classification": {
                        "Entity_Gid": $scope.entity_gid
                    }
                }
            }
            var dpart = {
                Group: 'Partner Product',
                Type: 'Atma_Product_Get',
                data: data
            }
            $scope.getprofileproduct = [];
            var getprofileproduct = Servicedrctsale.get_profileproduct(dpart)
            getprofileproduct.then(function(result) {
                //alert(JSON.stringify(result.data));
                //alert('12')
                $scope.getprofileproduct = result.data.DATA;
                //alert(JSON.stringify($scope.getprofileproduct));
                $scope.searchproductprofile = $scope.getprofileproduct;
                $scope.pageLength = $scope.getprofileproduct.length;
            }, function(err) {
                alert('No data!.');
            }).finally();
        }

        $scope.profileproductname = function(e) {
        if(e.metadata_value != undefined && e.metadata_value != null && e.metadata_value !='' )
        {
        var taxtemp= e.metadata_value;
        }
        else
        {
        var taxtemp='';
        }
            $scope.getprofileproduct = $filter('filter')($scope.searchproductprofile, {
                "partnerproduct_name":e.name1 == null || e.name1 == undefined || e.name1 == '' ? '' : e.name1,
                "partnerproduct_type": taxtemp == null ||  taxtemp == undefined  || taxtemp == '' ? '' : taxtemp
            });
        }

//alert(JSON.stringify($scope.basicprofile.partnerprofile_branchcount);
//PARTNERPRODUCT END PAGE

$scope.close_fun=function(e){

var r = confirm("Press Ok to Close This Window");
            if(e=="client"){
                if (r == true) {
                    modalhide('ClientAddPopup');
                }else{
                 modalshow('ClientAddPopup');
                }
             }
             if(e=="catalog_deta"){
                if (r == true) {
                    modalhide('addcatalogdetailspopup');
                }else{
                 modalshow('addcatalogdetailspopup');
                }
             }
             if(e=="pdf_popup"){
                if (r == true) {
                    modalhide('viewpdfpopup');
                }else{
                 modalshow('viewpdfpopup');
                }
             }
             if(e=="pdf_tax_popup"){
                if (r == true) {
                    modalhide('tax_viewpdfpopup');
                }else{
                 modalshow('tax_viewpdfpopup');
                }
             }
            if(e=="branch"){
                if (r == true) {
                    modalhide('BranchAddPopup');
                }else{
                 modalshow('BranchAddPopup');
                }
            }
            if(e=="product"){
                if (r == true) {
                    modalhide('popup_product');
                }else{
                 modalshow('popup_product');
                }
            }
            if(e=="contract"){
                if (r == true) {
                    modalhide('ContractAddPopup');
                }else{
                 modalshow('ContractAddPopup');
                }
            }
            if(e=="tax"){
                if (r == true) {
                    modalhide('taxdetailsmodal');
                }else{
                 modalshow('taxdetailsmodal');
                }
            }
            if(e=="paymode"){
                if (r == true) {
                    modalhide('mdl_present');
                }else{
                 modalshow('mdl_present');
                }
            }
            if(e=="activity"){
                if (r == true) {
                    modalhide('Activity_showpopup');
                }else{
                 modalshow('Activity_showpopup');
                }
            }
            if(e=="Act_details"){
                if (r == true) {
                    modalhide('addactivitydetailspopup');
                }else{
                 modalshow('addactivitydetailspopup');
                }
            }
    }
    $scope.branch_gst_blur =function(e) {

$scope.branch_gst_msg = "Please Enter Valid GST number";
if(e==undefined){
return false;
}
var data={
    "Params":{
        "Gst_number":e,
        "Group":"CheckGst_details",
    }}
    var checkpan=Servicedrctsale.check_gstdetails(data)
    checkpan.then(function(result){
    $scope.gstvalidresult=result.data;
    //alert(JSON.stringify(result.data));
    })
}
$scope.branch_gst_focus =function() {
$scope.branch_gst_msg = ""
}
$scope.branch_pan_blur =function(e) {

$scope.branch_pan_msg = "Please Enter Valid pan number";
if(e==undefined){
return false;
}
var data={
    "Params":{
        "Pan_number":e,
        "Group":"Checkpan_details",
    }}
    var checkpan=Servicedrctsale.check_pandetails(data)
    checkpan.then(function(result){
    $scope.panvalidresult=result.data;
    //alert(JSON.stringify(result.data));
    })
}
$scope.branch_pan_focus =function() {
$scope.branch_pan_msg = ""
}


$scope.getemployee_srch= function(searchText) {
                debugger;
             var dat = {
            "Table_name": "gal_mst_tmetadata",
            "Column_1": "metadata_gid,metadata_value",
            "Column_2": "",
            "Where_Common": "metadata",
            "Where_Primary": "columnname",
            "Primary_Value": "partner_compositevendor",
            "Limits": "0,30",
            "Search_Column": searchText,
            "Order_by": "value"
        }
        var partnergroup = {
            Action: "",
            Entity_Gid: $scope.entity_gid,
            data: dat
        }
        $scope.partnervendor = [];
            return $http.post(Appname + '/prodget/' , partnergroup).then(function(result) {
            console.log(result.data.DATA);
                return result.data.DATA;
              });
          };

<!--          customer_category-->
$scope.getcustomercategory_srch= function(searchText) {

             var dat = {
            "Table_name": "gal_mst_tcustcategory",
            "Column_1": "custcategory_gid,custcategory_name",
            "Column_2": "",
            "Where_Common": "custcategory",
            "Where_Primary": "custcategory_gid",
            "Primary_Value": "",
            "Limits": "0,30",
            "Search_Column": searchText,
            "Order_by": "name"
        }
        var partnergroup = {
            Action: "",
            Entity_Gid: $scope.entity_gid,
            data: dat
        }
        $scope.partnervendor = [];
            return $http.post(Appname + '/prodget/' , partnergroup).then(function(result) {
            console.log(result.data.DATA);
                return result.data.DATA;
              });
          };


<!--          suppliergroup-->
          $scope.getsuppliergroup_srch= function(searchText) {
                debugger;
             var dat = {
            "Table_name": "gal_mst_tmetadata",
            "Column_1": "metadata_gid,metadata_value",
            "Column_2": "",
            "Where_Common": "metadata",
            "Where_Primary": "columnname",
            "Primary_Value": "partner_group",
            "Limits": "0,30",
            "Search_Column": searchText,
            "Order_by": "value"
        }
        var partnergroup = {
            Action: "",
            Entity_Gid: $scope.entity_gid,
            data: dat
        }
        $scope.partnervendor = [];
            return $http.post(Appname + '/prodget/' , partnergroup).then(function(result) {
            console.log(result.data.DATA);
                return result.data.DATA;
              });
          };

<!--          supplierclasification-->
          $scope.getsupplierclasification_srch= function(searchText) {
                debugger;
             var dat = {
            "Table_name": "gal_mst_tmetadata",
            "Column_1": "metadata_gid,metadata_value",
            "Column_2": "",
            "Where_Common": "metadata",
            "Where_Primary": "columnname",
            "Primary_Value": "partner_Classification",
            "Limits": "0,30",
            "Search_Column": searchText,
            "Order_by": "value"
        }
        var partnergroup = {
            Action: "",
            Entity_Gid: $scope.entity_gid,
            data: dat
        }
        $scope.partnervendor = [];
            return $http.post(Appname + '/prodget/' , partnergroup).then(function(result) {
            console.log(result.data.DATA);
                return result.data.DATA;
              });
          };

<!--supplier type-->
$scope.getsuppliertype_srch= function(searchText) {
                debugger;
             var dat = {
            "Table_name": "gal_mst_tmetadata",
            "Column_1": "metadata_gid,metadata_value",
            "Column_2": "",
            "Where_Common": "metadata",
            "Where_Primary": "columnname",
            "Primary_Value": "partner_type",
            "Limits": "0,30",
            "Search_Column": searchText,
            "Order_by": "value"
        }
        var partnergroup = {
            Action: "",
            Entity_Gid: $scope.entity_gid,
            data: dat
        }
        $scope.partnervendor = [];
            return $http.post(Appname + '/prodget/' , partnergroup).then(function(result) {
            console.log(result.data.DATA);
                return result.data.DATA;
              });
          };

<!--          orgtype-->
$scope.getorganizationtype_srch= function(searchText) {
                debugger;
             var dat = {
            "Table_name": "gal_mst_tmetadata",
            "Column_1": "metadata_gid,metadata_value",
            "Column_2": "",
            "Where_Common": "metadata",
            "Where_Primary": "columnname",
            "Primary_Value": "partner_orgtype",
            "Limits": "0,30",
            "Search_Column": searchText,
            "Order_by": "value"
        }
        var partnergroup = {
            Action: "",
            Entity_Gid: $scope.entity_gid,
            data: dat
        }
        $scope.partnervendor = [];
            return $http.post(Appname + '/prodget/' , partnergroup).then(function(result) {
            console.log(result.data.DATA);
                return result.data.DATA;
              });
          };

<!--          partner rm-->

$scope.getpartnerrm_srch= function(searchText) {
                debugger;
             var dat = {
            "Table_name": "gal_mst_temployee",
            "Column_1": "employee_gid,employee_name,employee_code",
            "Column_2": "",
            "Where_Common": "employee",
            "Where_Primary": "employee_gid",
            "Primary_Value": "",
            "Limits": "0,30",
            "Search_Column": searchText,
            "Order_by": "name"
        }
        var partnergroup = {
            Action: "",
            Entity_Gid: $scope.entity_gid,
            data: dat
        }
        $scope.partnervendor = [];
            return $http.post(Appname + '/prodget/' , partnergroup).then(function(result) {
            console.log(result.data.DATA);
                return result.data.DATA;
              });
          };

    var datan = {
            "Table_name": "gal_mst_tdesignation",
            "Column_1": "designation_gid,designation_name",
            "Column_2": "",
            "Where_Common": "designation",
            "Where_Primary": "designation_gid",
            "Primary_Value": "",
            "Order_by": "code"
        }
        var pdesig = {
            Action: "",
            Entity_Gid: $scope.entity_gid,
            data: datan
        }
        $scope.product_desig = [];
        var getdesig = Servicedrctsale.getdesigdata(pdesig)
        getdesig.then(function(result) {
            $scope.product_desig = result.data.DATA;
        }, function(err) {
            alert('No data!.');
        }).finally();

});


//SERVICESTART

app_review.service("Servicedrctsale", function($http) {

//PARTNERPRODUCT SERVICE START

this.getpartnerprodtact = function(partnerprod) {
        var respons = $http.post(Appname + "/prodget/", partnerprod);
        return respons;
    }
    this.getdesigdata = function(pdesig) {
        var respons = $http.post(Appname + "/prodget/", pdesig);
        return respons;
    }
    this.getcontdata = function(pcont) {
        var respons = $http.post(Appname + "/prodget/", pcont);
        return respons;
    }
    this.PartnerProductSet = function(total) {
        var response = $http.post(Appname + "/atma_profileproduct_set/", total);
        return response;
    }
    this.get_profileproduct = function(dpart) {
        var respons = $http.post(Appname + "/atma_profileproduct_get/", dpart);
        return respons;
    }

//PARTNERPRODUCT SERVICE END

//ActivityServiceStart

this.getactdata = function(pact) {
        var respons = $http.post(Appname + "/prodget/", pact);
        return respons;
    }


    this.getcustgrp = function(d) {
            var response = $http.get(Appname + "/get_contctgroup/");
            return response;
        }
    this.getdesg = function() {
            var response = $http.get(Appname + "/desgjson/");
            return response;
        }
    this.getdattam = function(dtam) {
        var respons = $http.post(Appname + "/atma_activity_get/", dtam);
        return respons;
    }

    this.get_ProductCatSubCat_service = function(data1) {
        var respons = $http.post(Appname + "/atma_ProductCatSubCat_get/", data1);
        return respons;
    }

    this.ActivityaddService = function(details) {
       var response = $http.post(Appname + "/atma_activityaddedit/", details);
       return response;
   }
   this.updateactgrp = function(details) {
       var response = $http.post(Appname + "/atma_activityaddedit/", details);
       return response;
   }
//ActivityServiceEnd

//AttachmentServiceStart
    this.getdocnamedata = function(pdocname) {
        var respons = $http.post(Appname + "/prodget/", pdocname);
        return respons;
    }

    this.setdocgrp = function(details) {
        var response = $http.post(Appname + "/atma_attachmentupload/", details, {
            transformRequest: angular.identity,
            headers: {
                'Content-Type': undefined
            }
        });
        return response;
    }
    this.get_attachmentsummary = function(dtam) {
        var respons = $http.post(Appname + "/atma_doc_get/", dtam);
        return respons;
    }
    this.updateattachmentdetails = function(custid) {
			var respons = $http.post(Appname + "/atma_updateattacment_details/",
				custid, {
					transformRequest: angular.identity,

					headers: {
						'Content-Type': undefined
					}
				}
			);
			return respons;
	}
//AttachmentServiceEnd



    this.get_director= function(get_data) {
        var response = $http.post(Appname + "/atma_getdirectordata/", get_data);
        return response;
    }
    this.getprodt = function(trans) {
        var respons = $http.post(Appname + "/prodget/", trans);
        return respons;
    }
    this.partnerheader_set = function(total) {
        var response = $http.post(Appname + "/atmaPartnerPayment_Set/", total);
        return response;
    }
    this.atma_fileupload = function(custid) {
        var respons = $http.post(Appname + "/atma_fileuploadurl/",
            custid, {
                transformRequest: angular.identity,
                headers: {
                    'Content-Type': undefined
                }
            }
        );
        return respons;
    }

    //Pament service start

    this.getbranch_paymentpartner = function(pbranch) {

        var respons = $http.post(Appname + "/prodget/", pbranch);
        return respons;
    }
    this.getbranchdata = function(data) {
        var respons = $http.post(Appname + "/prodget/", data);
        return respons;
    }
    this.getpaymodebranchdata = function(data) {
			var respons = $http.post(Appname + "/prodget/", data);
			return respons;
		}
    this.get_atmapayment = function(data) {
        var respons = $http.post(Appname + "/atma_getdata/", data);
        return respons;
    }
    this.getbranchdetails = function(data) {
        var respons = $http.post(Appname + "/atma_branchdetailsdropdown/", data);
        return respons;
    }

    this.Paymentaddheader = function(total) {
        var response = $http.post(Appname + "/atmaPartnerPayment_Set/", total);
        return response;
    }
    //Pamentserviceend

    //tax services start

        this.gettaxreateedata = function (data) {
            var respons = $http.post(Appname + "/prodget/", data);
            return respons;
        }

        this.getbranch_taxgst = function(taxbranch) {
        var respons = $http.post(Appname + "/prodget/", taxbranch);
        return respons;
    }

        this.taxinsert = function(details) {
        var response = $http.post(Appname + "/atma_taxdetailsfileupload/", details, {
            transformRequest: angular.identity,
            headers: {
                'Content-Type': undefined
            }
        });
        return response;
        }
        this.taxupdate_details = function(details) {
        var response = $http.post(Appname + "/atma_taxdetailsfileupload/", details, {
            transformRequest: angular.identity,
            headers: {
                'Content-Type': undefined
            }
        });
        return response;
        }
        this.get_atmataxdetails = function (data) {
        var respons = $http.post(Appname + "/atma_gettaxdetails/", data);
        return respons;
        }
        //taxservicesend

        //ClientDetailsStart

          this.getstateddl = function(d) {
            var response = $http.get(Appname + "/stateddl/");
            return response;
        }
        this.getpincodeall = function(pincode) {
            var response = $http.get(Appname + "/allpinget/", {
                params: {
                    "pincode": pincode
                }
            });
            return response;
        }

        this.getpincode = function(city_gid) {
            var response = $http.get(Appname + "/pincode/", {
                params: {
                    "city_gid": city_gid
                }
            });
            return response;
        }
        this.getdistddl = function(state_gid) {
            var response = $http.get(Appname + "/districtddl/", {
                params: {
                    "state_gid": state_gid
                }
            });
            return response;
        }
        this.getcityddl = function(district_gid) {
            var response = $http.get(Appname + "/cityddl/", {
                params: {
                    "district_gid": district_gid
                }
            });
            return response;
        }

        this.clientaddService = function(data) {
        var respons = $http.post(Appname + "/atma_SetClientdetails/", data);
        return respons;
    }
    this.clientgetService = function(data) {
        var respons = $http.post(Appname + "/atma_SetClientdetails/", data);
        return respons;
    }
    this.clientupdateService = function(data) {
        var respons = $http.post(Appname + "/atma_SetClientdetails/", data);
        return respons;
    }
        //Client Details End
        //contract Details Srart

    this.contractsetService = function(data) {
        var respons = $http.post(Appname + "/atma_SetContractdetails/", data);
        return respons;
    }
    this.contractgetService = function(data) {
        var respons = $http.post(Appname + "/atma_SetContractdetails/", data);
        return respons;
    }
    this.contractupdateService = function(data) {
        var respons = $http.post(Appname + "/atma_SetContractdetails/", data);
        return respons;
    }
        //contract Details end

        //branch Details start page...!
    this.branchsetService = function(data) {
        var respons = $http.post(Appname + "/atma_SetBranchdetails/", data);
        return respons;
    }
    this.branchgetService = function(data) {
        var respons = $http.post(Appname + "/atma_SetBranchdetails/", data);
        return respons;
    }
    this.branchupdateService = function(data) {
        var respons = $http.post(Appname + "/atma_SetBranchdetails/", data);
        return respons;
    }

        //branch Details end page...!
        //basic profile Details Start page...!
    this.basicprofilesetService = function(data) {
        var respons = $http.post(Appname + "/atma_Setbasicprofildedetails/", data);
        return respons;
    }
    this.basicprofilegetService = function(data) {
        var respons = $http.post(Appname + "/atma_Setbasicprofildedetails/", data);
        return respons;
    }

        //basic profile Details End page...!

     this.getdattamactivity = function (dtamactivity) {
            var respons = $http.post(Appname + "/atma_activitydetailsget/", dtamactivity);
            return respons;
        }
     this.setactdetails = function (details) {
            var response = $http.post(Appname + "/atma_activitydetailsset/", details);
            return response;
        }
        this.updateactdetails = function (dtamactivity) {
            var respons = $http.post(Appname + "/atma_activitydetailsset/", dtamactivity);
            return respons;
        }
        //start catalog
        this.getdattams = function (dtam) {
            var respons = $http.post(Appname + "/atmacatalog_get/", dtam);
            return respons;
        }
        this.pcatalog = function (total) {
            var response = $http.post(Appname + "/atmacatalogset/", total);
            return response;
        }
        this.updatecatalogservice = function (dtam) {
            var respons = $http.post(Appname + "/atmacatalogset/", dtam);
            return respons;
        }
         this.checkergetService = function(get_data) {
        var response = $http.post(Appname + "/atma_CheckerDetails/", get_data);
        return response;
    }
    this.assigncatalogService = function(get_data) {
        var response = $http.post(Appname + "/atmacatalogset/", get_data);
        return response;
    }
    this.check_pandetails = function(get_data) {
        var response = $http.post(Appname + "/atma_ApprovedPartner_Get/", get_data);
        return response;
    }
    this.check_gstdetails = function(get_data) {
        var response = $http.post(Appname + "/atma_ApprovedPartner_Get/", get_data);
        return response;
    }
    this.setbranchdata = function(partnergroup) {
        var respons = $http.post(Appname + "/Bankbranch_setdetails/", partnergroup);
        return respons;
    }
    this.getifsc = function(partnergroup) {
        var respons = $http.post(Appname + "/atma_ApprovedPartner_Get/", partnergroup);
        return respons;
    }
});


</script>
{% endblock %}